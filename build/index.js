var $Q=Object.defineProperty;var u=(Q,K)=>{for(var $ in K)$Q(Q,$,{get:K[$],enumerable:!0,configurable:!0,set:(J)=>K[$]=()=>J})};class g{disposables;own(Q){if(!this.disposables)this.disposables=new Set;return this.disposables.add(Q),Q}addOnDestroy(Q){this.disposables?.add({destroy:Q})}destroy(){this.disposables?.forEach((Q)=>Q.destroy())}}var JQ=function(Q,K,$){function J(B,F){function M(E){return E===Q?.VERTEX_SHADER?"vertex":E===Q?.FRAGMENT_SHADER?"fragment":void 0}if(F!==Q.VERTEX_SHADER&&F!==Q.FRAGMENT_SHADER)throw new Error(`Shader error in ${M(F)}`);const H=Q.createShader(F);if(!H)throw new Error(`Unable to generate ${M(F)} shader.`);if(Q.shaderSource(H,B),Q.compileShader(H),!Q.getShaderParameter(H,Q.COMPILE_STATUS))console.error(`Shader compile error in ${M(F)}:`+Q.getShaderInfoLog(H));return H}const C=Q.createProgram();if(!C)throw new Error("Unable to create program.");const Z=J(K,Q.VERTEX_SHADER),V=J($,Q.FRAGMENT_SHADER),Y=Q.getShaderInfoLog(Z),N=Q.getShaderInfoLog(V);if(Y)console.log("VERTEX",Y);if(N)console.log("FRAGMENT",N);Q.attachShader(C,Z),Q.attachShader(C,V),Q.linkProgram(C);const W=Q.getProgramInfoLog(C);if(W)console.log("PROGRAM",W);if(Q.detachShader(C,Z),Q.detachShader(C,V),Q.deleteShader(Z),Q.deleteShader(V),Q.validateProgram(C),Object.entries(WebGL2RenderingContext).forEach(([B,F])=>{if(F&&Q.getError()===F)console.log(`gl.${B}`)}),!Q.getProgramParameter(C,Q.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+Q.getProgramInfoLog(C));return C},CQ=function(Q,K){Q.deleteProgram(K)};class o extends g{gl;program;constructor(Q,K,$){super();this.gl=Q,this.program=JQ(Q,K.trim(),$.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),CQ(this.gl,this.program)}}class t extends g{activeProgramId="";gl;programs={};constructor(Q){super();this.gl=Q}addProgram(Q,K,$){if(this.programs[Q])this.removeProgram(Q);this.programs[Q]=this.own(new o(this.gl,K,$))}useProgram(Q){if(this.activeProgramId!==Q)this.activeProgramId=Q,this.programs[Q].use()}removeProgram(Q){this.programs[Q].destroy(),delete this.programs[Q]}getProgram(Q){return this.programs[Q??this.activeProgramId]?.program}}class a extends g{gl;triangleArray;constructor(Q){super();this.gl=Q,this.triangleArray=Q.createVertexArray(),Q.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class Q0 extends g{bufferRecord={};lastBoundBuffer;gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getAttributeLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getAttribLocation($,Q)??-1:-1}createBuffer(Q){this.deleteBuffer(Q);const K=this.gl?.createBuffer();if(!K)throw new Error(`Unable to create buffer "${Q}"`);const $={buffer:K,location:this.getAttributeLocation(Q)};return this.bufferRecord[Q]=$,$}deleteBuffer(Q){if(this.bufferRecord[Q])this.gl.deleteBuffer(this.bufferRecord[Q].buffer),delete this.bufferRecord[Q]}getAttributeBuffer(Q,K){const $=this.bufferRecord[Q];if(!$){if(K)return this.createBuffer(Q);throw new Error(`Attribute "${Q}" not created. Make sure "createBuffer" is called.`)}return $}bufferData(Q,K,$,J,C){const Z=this.getAttributeBuffer(K);if($)this.gl.bufferData(Q,$,C);else this.gl.bufferData(Q,J,C);Z.bufferSize=J||$?.length,Z.bufferArray=$??new Float32Array(Z.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),Z.usage=C,Z.target=Q}bufferSubData(Q,K,$,J,C){if(J)this.gl.bufferSubData(Q,$,K,J,C);else this.gl.bufferSubData(Q,$,K)}bindBuffer(Q,K){if(this.lastBoundBuffer!==K)this.lastBoundBuffer=K,this.gl.bindBuffer(Q,K.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((Q)=>this.deleteBuffer(Q))}}class K0 extends g{gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getUniformLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getUniformLocation($,Q)??void 0:void 0}}var U=WebGL2RenderingContext,$0="position",P0="index",H0="transform",M0="tex",X0="cam";var j=0.000001,S=typeof Float32Array!=="undefined"?Float32Array:Array,z=Math.random,_$=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var Q=0,K=arguments.length;while(K--)Q+=arguments[K]*arguments[K];return Math.sqrt(Q)};function E0(){var Q=new S(9);if(S!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[5]=0,Q[6]=0,Q[7]=0;return Q[0]=1,Q[4]=1,Q[8]=1,Q}var R={};u(R,{transpose:()=>{{return FQ}},translate:()=>{{return XQ}},targetTo:()=>{{return yQ}},subtract:()=>{{return R0}},sub:()=>{{return bQ}},str:()=>{{return iQ}},set:()=>{{return BQ}},scale:()=>{{return EQ}},rotateZ:()=>{{return hQ}},rotateY:()=>{{return AQ}},rotateX:()=>{{return UQ}},rotate:()=>{{return DQ}},perspectiveZO:()=>{{return gQ}},perspectiveNO:()=>{{return O0}},perspectiveFromFieldOfView:()=>{{return nQ}},perspective:()=>{{return vQ}},orthoZO:()=>{{return fQ}},orthoNO:()=>{{return k0}},ortho:()=>{{return zQ}},multiplyScalarAndAdd:()=>{{return mQ}},multiplyScalar:()=>{{return cQ}},multiply:()=>{{return U0}},mul:()=>{{return eQ}},lookAt:()=>{{return dQ}},invert:()=>{{return PQ}},identity:()=>{{return D0}},getTranslation:()=>{{return GQ}},getScaling:()=>{{return h0}},getRotation:()=>{{return LQ}},frustum:()=>{{return pQ}},fromZRotation:()=>{{return _Q}},fromYRotation:()=>{{return TQ}},fromXRotation:()=>{{return jQ}},fromValues:()=>{{return WQ}},fromTranslation:()=>{{return OQ}},fromScaling:()=>{{return kQ}},fromRotationTranslationScaleOrigin:()=>{{return IQ}},fromRotationTranslationScale:()=>{{return qQ}},fromRotationTranslation:()=>{{return A0}},fromRotation:()=>{{return RQ}},fromQuat2:()=>{{return SQ}},fromQuat:()=>{{return wQ}},frob:()=>{{return lQ}},exactEquals:()=>{{return sQ}},equals:()=>{{return rQ}},determinant:()=>{{return MQ}},create:()=>{{return VQ}},copy:()=>{{return NQ}},clone:()=>{{return YQ}},adjoint:()=>{{return HQ}},add:()=>{{return xQ}}});function VQ(){var Q=new S(16);if(S!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0;return Q[0]=1,Q[5]=1,Q[10]=1,Q[15]=1,Q}function YQ(Q){var K=new S(16);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function NQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function WQ(Q,K,$,J,C,Z,V,Y,N,W,B,F,M,H,E,X){var P=new S(16);return P[0]=Q,P[1]=K,P[2]=$,P[3]=J,P[4]=C,P[5]=Z,P[6]=V,P[7]=Y,P[8]=N,P[9]=W,P[10]=B,P[11]=F,P[12]=M,P[13]=H,P[14]=E,P[15]=X,P}function BQ(Q,K,$,J,C,Z,V,Y,N,W,B,F,M,H,E,X,P){return Q[0]=K,Q[1]=$,Q[2]=J,Q[3]=C,Q[4]=Z,Q[5]=V,Q[6]=Y,Q[7]=N,Q[8]=W,Q[9]=B,Q[10]=F,Q[11]=M,Q[12]=H,Q[13]=E,Q[14]=X,Q[15]=P,Q}function D0(Q){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function FQ(Q,K){if(Q===K){var $=K[1],J=K[2],C=K[3],Z=K[6],V=K[7],Y=K[11];Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=$,Q[6]=K[9],Q[7]=K[13],Q[8]=J,Q[9]=Z,Q[11]=K[14],Q[12]=C,Q[13]=V,Q[14]=Y}else Q[0]=K[0],Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=K[1],Q[5]=K[5],Q[6]=K[9],Q[7]=K[13],Q[8]=K[2],Q[9]=K[6],Q[10]=K[10],Q[11]=K[14],Q[12]=K[3],Q[13]=K[7],Q[14]=K[11],Q[15]=K[15];return Q}function PQ(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=K[4],Y=K[5],N=K[6],W=K[7],B=K[8],F=K[9],M=K[10],H=K[11],E=K[12],X=K[13],P=K[14],D=K[15],T=$*Y-J*V,k=$*N-C*V,O=$*W-Z*V,A=J*N-C*Y,h=J*W-Z*Y,I=C*W-Z*N,G=B*X-F*E,L=B*P-M*E,q=B*D-H*E,w=F*P-M*X,p=F*D-H*X,v=M*D-H*P,_=T*v-k*p+O*w+A*q-h*L+I*G;if(!_)return null;return _=1/_,Q[0]=(Y*v-N*p+W*w)*_,Q[1]=(C*p-J*v-Z*w)*_,Q[2]=(X*I-P*h+D*A)*_,Q[3]=(M*h-F*I-H*A)*_,Q[4]=(N*q-V*v-W*L)*_,Q[5]=($*v-C*q+Z*L)*_,Q[6]=(P*O-E*I-D*k)*_,Q[7]=(B*I-M*O+H*k)*_,Q[8]=(V*p-Y*q+W*G)*_,Q[9]=(J*q-$*p-Z*G)*_,Q[10]=(E*h-X*O+D*T)*_,Q[11]=(F*O-B*h-H*T)*_,Q[12]=(Y*L-V*w-N*G)*_,Q[13]=($*w-J*L+C*G)*_,Q[14]=(X*k-E*A-P*T)*_,Q[15]=(B*A-F*k+M*T)*_,Q}function HQ(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=K[4],Y=K[5],N=K[6],W=K[7],B=K[8],F=K[9],M=K[10],H=K[11],E=K[12],X=K[13],P=K[14],D=K[15];return Q[0]=Y*(M*D-H*P)-F*(N*D-W*P)+X*(N*H-W*M),Q[1]=-(J*(M*D-H*P)-F*(C*D-Z*P)+X*(C*H-Z*M)),Q[2]=J*(N*D-W*P)-Y*(C*D-Z*P)+X*(C*W-Z*N),Q[3]=-(J*(N*H-W*M)-Y*(C*H-Z*M)+F*(C*W-Z*N)),Q[4]=-(V*(M*D-H*P)-B*(N*D-W*P)+E*(N*H-W*M)),Q[5]=$*(M*D-H*P)-B*(C*D-Z*P)+E*(C*H-Z*M),Q[6]=-($*(N*D-W*P)-V*(C*D-Z*P)+E*(C*W-Z*N)),Q[7]=$*(N*H-W*M)-V*(C*H-Z*M)+B*(C*W-Z*N),Q[8]=V*(F*D-H*X)-B*(Y*D-W*X)+E*(Y*H-W*F),Q[9]=-($*(F*D-H*X)-B*(J*D-Z*X)+E*(J*H-Z*F)),Q[10]=$*(Y*D-W*X)-V*(J*D-Z*X)+E*(J*W-Z*Y),Q[11]=-($*(Y*H-W*F)-V*(J*H-Z*F)+B*(J*W-Z*Y)),Q[12]=-(V*(F*P-M*X)-B*(Y*P-N*X)+E*(Y*M-N*F)),Q[13]=$*(F*P-M*X)-B*(J*P-C*X)+E*(J*M-C*F),Q[14]=-($*(Y*P-N*X)-V*(J*P-C*X)+E*(J*N-C*Y)),Q[15]=$*(Y*M-N*F)-V*(J*M-C*F)+B*(J*N-C*Y),Q}function MQ(Q){var K=Q[0],$=Q[1],J=Q[2],C=Q[3],Z=Q[4],V=Q[5],Y=Q[6],N=Q[7],W=Q[8],B=Q[9],F=Q[10],M=Q[11],H=Q[12],E=Q[13],X=Q[14],P=Q[15],D=K*V-$*Z,T=K*Y-J*Z,k=K*N-C*Z,O=$*Y-J*V,A=$*N-C*V,h=J*N-C*Y,I=W*E-B*H,G=W*X-F*H,L=W*P-M*H,q=B*X-F*E,w=B*P-M*E,p=F*P-M*X;return D*p-T*w+k*q+O*L-A*G+h*I}function U0(Q,K,$){var J=K[0],C=K[1],Z=K[2],V=K[3],Y=K[4],N=K[5],W=K[6],B=K[7],F=K[8],M=K[9],H=K[10],E=K[11],X=K[12],P=K[13],D=K[14],T=K[15],k=$[0],O=$[1],A=$[2],h=$[3];return Q[0]=k*J+O*Y+A*F+h*X,Q[1]=k*C+O*N+A*M+h*P,Q[2]=k*Z+O*W+A*H+h*D,Q[3]=k*V+O*B+A*E+h*T,k=$[4],O=$[5],A=$[6],h=$[7],Q[4]=k*J+O*Y+A*F+h*X,Q[5]=k*C+O*N+A*M+h*P,Q[6]=k*Z+O*W+A*H+h*D,Q[7]=k*V+O*B+A*E+h*T,k=$[8],O=$[9],A=$[10],h=$[11],Q[8]=k*J+O*Y+A*F+h*X,Q[9]=k*C+O*N+A*M+h*P,Q[10]=k*Z+O*W+A*H+h*D,Q[11]=k*V+O*B+A*E+h*T,k=$[12],O=$[13],A=$[14],h=$[15],Q[12]=k*J+O*Y+A*F+h*X,Q[13]=k*C+O*N+A*M+h*P,Q[14]=k*Z+O*W+A*H+h*D,Q[15]=k*V+O*B+A*E+h*T,Q}function XQ(Q,K,$){var J=$[0],C=$[1],Z=$[2],V,Y,N,W,B,F,M,H,E,X,P,D;if(K===Q)Q[12]=K[0]*J+K[4]*C+K[8]*Z+K[12],Q[13]=K[1]*J+K[5]*C+K[9]*Z+K[13],Q[14]=K[2]*J+K[6]*C+K[10]*Z+K[14],Q[15]=K[3]*J+K[7]*C+K[11]*Z+K[15];else V=K[0],Y=K[1],N=K[2],W=K[3],B=K[4],F=K[5],M=K[6],H=K[7],E=K[8],X=K[9],P=K[10],D=K[11],Q[0]=V,Q[1]=Y,Q[2]=N,Q[3]=W,Q[4]=B,Q[5]=F,Q[6]=M,Q[7]=H,Q[8]=E,Q[9]=X,Q[10]=P,Q[11]=D,Q[12]=V*J+B*C+E*Z+K[12],Q[13]=Y*J+F*C+X*Z+K[13],Q[14]=N*J+M*C+P*Z+K[14],Q[15]=W*J+H*C+D*Z+K[15];return Q}function EQ(Q,K,$){var J=$[0],C=$[1],Z=$[2];return Q[0]=K[0]*J,Q[1]=K[1]*J,Q[2]=K[2]*J,Q[3]=K[3]*J,Q[4]=K[4]*C,Q[5]=K[5]*C,Q[6]=K[6]*C,Q[7]=K[7]*C,Q[8]=K[8]*Z,Q[9]=K[9]*Z,Q[10]=K[10]*Z,Q[11]=K[11]*Z,Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function DQ(Q,K,$,J){var C=J[0],Z=J[1],V=J[2],Y=Math.hypot(C,Z,V),N,W,B,F,M,H,E,X,P,D,T,k,O,A,h,I,G,L,q,w,p,v,_,n;if(Y<j)return null;if(Y=1/Y,C*=Y,Z*=Y,V*=Y,N=Math.sin($),W=Math.cos($),B=1-W,F=K[0],M=K[1],H=K[2],E=K[3],X=K[4],P=K[5],D=K[6],T=K[7],k=K[8],O=K[9],A=K[10],h=K[11],I=C*C*B+W,G=Z*C*B+V*N,L=V*C*B-Z*N,q=C*Z*B-V*N,w=Z*Z*B+W,p=V*Z*B+C*N,v=C*V*B+Z*N,_=Z*V*B-C*N,n=V*V*B+W,Q[0]=F*I+X*G+k*L,Q[1]=M*I+P*G+O*L,Q[2]=H*I+D*G+A*L,Q[3]=E*I+T*G+h*L,Q[4]=F*q+X*w+k*p,Q[5]=M*q+P*w+O*p,Q[6]=H*q+D*w+A*p,Q[7]=E*q+T*w+h*p,Q[8]=F*v+X*_+k*n,Q[9]=M*v+P*_+O*n,Q[10]=H*v+D*_+A*n,Q[11]=E*v+T*_+h*n,K!==Q)Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q}function UQ(Q,K,$){var J=Math.sin($),C=Math.cos($),Z=K[4],V=K[5],Y=K[6],N=K[7],W=K[8],B=K[9],F=K[10],M=K[11];if(K!==Q)Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[4]=Z*C+W*J,Q[5]=V*C+B*J,Q[6]=Y*C+F*J,Q[7]=N*C+M*J,Q[8]=W*C-Z*J,Q[9]=B*C-V*J,Q[10]=F*C-Y*J,Q[11]=M*C-N*J,Q}function AQ(Q,K,$){var J=Math.sin($),C=Math.cos($),Z=K[0],V=K[1],Y=K[2],N=K[3],W=K[8],B=K[9],F=K[10],M=K[11];if(K!==Q)Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=Z*C-W*J,Q[1]=V*C-B*J,Q[2]=Y*C-F*J,Q[3]=N*C-M*J,Q[8]=Z*J+W*C,Q[9]=V*J+B*C,Q[10]=Y*J+F*C,Q[11]=N*J+M*C,Q}function hQ(Q,K,$){var J=Math.sin($),C=Math.cos($),Z=K[0],V=K[1],Y=K[2],N=K[3],W=K[4],B=K[5],F=K[6],M=K[7];if(K!==Q)Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=Z*C+W*J,Q[1]=V*C+B*J,Q[2]=Y*C+F*J,Q[3]=N*C+M*J,Q[4]=W*C-Z*J,Q[5]=B*C-V*J,Q[6]=F*C-Y*J,Q[7]=M*C-N*J,Q}function OQ(Q,K){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=K[0],Q[13]=K[1],Q[14]=K[2],Q[15]=1,Q}function kQ(Q,K){return Q[0]=K[0],Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=K[1],Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=K[2],Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function RQ(Q,K,$){var J=$[0],C=$[1],Z=$[2],V=Math.hypot(J,C,Z),Y,N,W;if(V<j)return null;return V=1/V,J*=V,C*=V,Z*=V,Y=Math.sin(K),N=Math.cos(K),W=1-N,Q[0]=J*J*W+N,Q[1]=C*J*W+Z*Y,Q[2]=Z*J*W-C*Y,Q[3]=0,Q[4]=J*C*W-Z*Y,Q[5]=C*C*W+N,Q[6]=Z*C*W+J*Y,Q[7]=0,Q[8]=J*Z*W+C*Y,Q[9]=C*Z*W-J*Y,Q[10]=Z*Z*W+N,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function jQ(Q,K){var $=Math.sin(K),J=Math.cos(K);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=J,Q[6]=$,Q[7]=0,Q[8]=0,Q[9]=-$,Q[10]=J,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function TQ(Q,K){var $=Math.sin(K),J=Math.cos(K);return Q[0]=J,Q[1]=0,Q[2]=-$,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=$,Q[9]=0,Q[10]=J,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function _Q(Q,K){var $=Math.sin(K),J=Math.cos(K);return Q[0]=J,Q[1]=$,Q[2]=0,Q[3]=0,Q[4]=-$,Q[5]=J,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function A0(Q,K,$){var J=K[0],C=K[1],Z=K[2],V=K[3],Y=J+J,N=C+C,W=Z+Z,B=J*Y,F=J*N,M=J*W,H=C*N,E=C*W,X=Z*W,P=V*Y,D=V*N,T=V*W;return Q[0]=1-(H+X),Q[1]=F+T,Q[2]=M-D,Q[3]=0,Q[4]=F-T,Q[5]=1-(B+X),Q[6]=E+P,Q[7]=0,Q[8]=M+D,Q[9]=E-P,Q[10]=1-(B+H),Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function SQ(Q,K){var $=new S(3),J=-K[0],C=-K[1],Z=-K[2],V=K[3],Y=K[4],N=K[5],W=K[6],B=K[7],F=J*J+C*C+Z*Z+V*V;if(F>0)$[0]=(Y*V+B*J+N*Z-W*C)*2/F,$[1]=(N*V+B*C+W*J-Y*Z)*2/F,$[2]=(W*V+B*Z+Y*C-N*J)*2/F;else $[0]=(Y*V+B*J+N*Z-W*C)*2,$[1]=(N*V+B*C+W*J-Y*Z)*2,$[2]=(W*V+B*Z+Y*C-N*J)*2;return A0(Q,K,$),Q}function GQ(Q,K){return Q[0]=K[12],Q[1]=K[13],Q[2]=K[14],Q}function h0(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[4],V=K[5],Y=K[6],N=K[8],W=K[9],B=K[10];return Q[0]=Math.hypot($,J,C),Q[1]=Math.hypot(Z,V,Y),Q[2]=Math.hypot(N,W,B),Q}function LQ(Q,K){var $=new S(3);h0($,K);var J=1/$[0],C=1/$[1],Z=1/$[2],V=K[0]*J,Y=K[1]*C,N=K[2]*Z,W=K[4]*J,B=K[5]*C,F=K[6]*Z,M=K[8]*J,H=K[9]*C,E=K[10]*Z,X=V+B+E,P=0;if(X>0)P=Math.sqrt(X+1)*2,Q[3]=0.25*P,Q[0]=(F-H)/P,Q[1]=(M-N)/P,Q[2]=(Y-W)/P;else if(V>B&&V>E)P=Math.sqrt(1+V-B-E)*2,Q[3]=(F-H)/P,Q[0]=0.25*P,Q[1]=(Y+W)/P,Q[2]=(M+N)/P;else if(B>E)P=Math.sqrt(1+B-V-E)*2,Q[3]=(M-N)/P,Q[0]=(Y+W)/P,Q[1]=0.25*P,Q[2]=(F+H)/P;else P=Math.sqrt(1+E-V-B)*2,Q[3]=(Y-W)/P,Q[0]=(M+N)/P,Q[1]=(F+H)/P,Q[2]=0.25*P;return Q}function qQ(Q,K,$,J){var C=K[0],Z=K[1],V=K[2],Y=K[3],N=C+C,W=Z+Z,B=V+V,F=C*N,M=C*W,H=C*B,E=Z*W,X=Z*B,P=V*B,D=Y*N,T=Y*W,k=Y*B,O=J[0],A=J[1],h=J[2];return Q[0]=(1-(E+P))*O,Q[1]=(M+k)*O,Q[2]=(H-T)*O,Q[3]=0,Q[4]=(M-k)*A,Q[5]=(1-(F+P))*A,Q[6]=(X+D)*A,Q[7]=0,Q[8]=(H+T)*h,Q[9]=(X-D)*h,Q[10]=(1-(F+E))*h,Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function IQ(Q,K,$,J,C){var Z=K[0],V=K[1],Y=K[2],N=K[3],W=Z+Z,B=V+V,F=Y+Y,M=Z*W,H=Z*B,E=Z*F,X=V*B,P=V*F,D=Y*F,T=N*W,k=N*B,O=N*F,A=J[0],h=J[1],I=J[2],G=C[0],L=C[1],q=C[2],w=(1-(X+D))*A,p=(H+O)*A,v=(E-k)*A,_=(H-O)*h,n=(1-(M+D))*h,y=(P+T)*h,i=(E+k)*I,B0=(P-T)*I,F0=(1-(M+X))*I;return Q[0]=w,Q[1]=p,Q[2]=v,Q[3]=0,Q[4]=_,Q[5]=n,Q[6]=y,Q[7]=0,Q[8]=i,Q[9]=B0,Q[10]=F0,Q[11]=0,Q[12]=$[0]+G-(w*G+_*L+i*q),Q[13]=$[1]+L-(p*G+n*L+B0*q),Q[14]=$[2]+q-(v*G+y*L+F0*q),Q[15]=1,Q}function wQ(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=$+$,Y=J+J,N=C+C,W=$*V,B=J*V,F=J*Y,M=C*V,H=C*Y,E=C*N,X=Z*V,P=Z*Y,D=Z*N;return Q[0]=1-F-E,Q[1]=B+D,Q[2]=M-P,Q[3]=0,Q[4]=B-D,Q[5]=1-W-E,Q[6]=H+X,Q[7]=0,Q[8]=M+P,Q[9]=H-X,Q[10]=1-W-F,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function pQ(Q,K,$,J,C,Z,V){var Y=1/($-K),N=1/(C-J),W=1/(Z-V);return Q[0]=Z*2*Y,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z*2*N,Q[6]=0,Q[7]=0,Q[8]=($+K)*Y,Q[9]=(C+J)*N,Q[10]=(V+Z)*W,Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=V*Z*2*W,Q[15]=0,Q}function O0(Q,K,$,J,C){var Z=1/Math.tan(K/2),V;if(Q[0]=Z/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,C!=null&&C!==Infinity)V=1/(J-C),Q[10]=(C+J)*V,Q[14]=2*C*J*V;else Q[10]=-1,Q[14]=-2*J;return Q}function gQ(Q,K,$,J,C){var Z=1/Math.tan(K/2),V;if(Q[0]=Z/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,C!=null&&C!==Infinity)V=1/(J-C),Q[10]=C*V,Q[14]=C*J*V;else Q[10]=-1,Q[14]=-J;return Q}function nQ(Q,K,$,J){var C=Math.tan(K.upDegrees*Math.PI/180),Z=Math.tan(K.downDegrees*Math.PI/180),V=Math.tan(K.leftDegrees*Math.PI/180),Y=Math.tan(K.rightDegrees*Math.PI/180),N=2/(V+Y),W=2/(C+Z);return Q[0]=N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=W,Q[6]=0,Q[7]=0,Q[8]=-((V-Y)*N*0.5),Q[9]=(C-Z)*W*0.5,Q[10]=J/($-J),Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=J*$/($-J),Q[15]=0,Q}function k0(Q,K,$,J,C,Z,V){var Y=1/(K-$),N=1/(J-C),W=1/(Z-V);return Q[0]=-2*Y,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*N,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=2*W,Q[11]=0,Q[12]=(K+$)*Y,Q[13]=(C+J)*N,Q[14]=(V+Z)*W,Q[15]=1,Q}function fQ(Q,K,$,J,C,Z,V){var Y=1/(K-$),N=1/(J-C),W=1/(Z-V);return Q[0]=-2*Y,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*N,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=W,Q[11]=0,Q[12]=(K+$)*Y,Q[13]=(C+J)*N,Q[14]=Z*W,Q[15]=1,Q}function dQ(Q,K,$,J){var C,Z,V,Y,N,W,B,F,M,H,E=K[0],X=K[1],P=K[2],D=J[0],T=J[1],k=J[2],O=$[0],A=$[1],h=$[2];if(Math.abs(E-O)<j&&Math.abs(X-A)<j&&Math.abs(P-h)<j)return D0(Q);if(B=E-O,F=X-A,M=P-h,H=1/Math.hypot(B,F,M),B*=H,F*=H,M*=H,C=T*M-k*F,Z=k*B-D*M,V=D*F-T*B,H=Math.hypot(C,Z,V),!H)C=0,Z=0,V=0;else H=1/H,C*=H,Z*=H,V*=H;if(Y=F*V-M*Z,N=M*C-B*V,W=B*Z-F*C,H=Math.hypot(Y,N,W),!H)Y=0,N=0,W=0;else H=1/H,Y*=H,N*=H,W*=H;return Q[0]=C,Q[1]=Y,Q[2]=B,Q[3]=0,Q[4]=Z,Q[5]=N,Q[6]=F,Q[7]=0,Q[8]=V,Q[9]=W,Q[10]=M,Q[11]=0,Q[12]=-(C*E+Z*X+V*P),Q[13]=-(Y*E+N*X+W*P),Q[14]=-(B*E+F*X+M*P),Q[15]=1,Q}function yQ(Q,K,$,J){var C=K[0],Z=K[1],V=K[2],Y=J[0],N=J[1],W=J[2],B=C-$[0],F=Z-$[1],M=V-$[2],H=B*B+F*F+M*M;if(H>0)H=1/Math.sqrt(H),B*=H,F*=H,M*=H;var E=N*M-W*F,X=W*B-Y*M,P=Y*F-N*B;if(H=E*E+X*X+P*P,H>0)H=1/Math.sqrt(H),E*=H,X*=H,P*=H;return Q[0]=E,Q[1]=X,Q[2]=P,Q[3]=0,Q[4]=F*P-M*X,Q[5]=M*E-B*P,Q[6]=B*X-F*E,Q[7]=0,Q[8]=B,Q[9]=F,Q[10]=M,Q[11]=0,Q[12]=C,Q[13]=Z,Q[14]=V,Q[15]=1,Q}function iQ(Q){return"mat4("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+", "+Q[4]+", "+Q[5]+", "+Q[6]+", "+Q[7]+", "+Q[8]+", "+Q[9]+", "+Q[10]+", "+Q[11]+", "+Q[12]+", "+Q[13]+", "+Q[14]+", "+Q[15]+")"}function lQ(Q){return Math.hypot(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7],Q[8],Q[9],Q[10],Q[11],Q[12],Q[13],Q[14],Q[15])}function xQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q[4]=K[4]+$[4],Q[5]=K[5]+$[5],Q[6]=K[6]+$[6],Q[7]=K[7]+$[7],Q[8]=K[8]+$[8],Q[9]=K[9]+$[9],Q[10]=K[10]+$[10],Q[11]=K[11]+$[11],Q[12]=K[12]+$[12],Q[13]=K[13]+$[13],Q[14]=K[14]+$[14],Q[15]=K[15]+$[15],Q}function R0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q[3]=K[3]-$[3],Q[4]=K[4]-$[4],Q[5]=K[5]-$[5],Q[6]=K[6]-$[6],Q[7]=K[7]-$[7],Q[8]=K[8]-$[8],Q[9]=K[9]-$[9],Q[10]=K[10]-$[10],Q[11]=K[11]-$[11],Q[12]=K[12]-$[12],Q[13]=K[13]-$[13],Q[14]=K[14]-$[14],Q[15]=K[15]-$[15],Q}function cQ(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q[4]=K[4]*$,Q[5]=K[5]*$,Q[6]=K[6]*$,Q[7]=K[7]*$,Q[8]=K[8]*$,Q[9]=K[9]*$,Q[10]=K[10]*$,Q[11]=K[11]*$,Q[12]=K[12]*$,Q[13]=K[13]*$,Q[14]=K[14]*$,Q[15]=K[15]*$,Q}function mQ(Q,K,$,J){return Q[0]=K[0]+$[0]*J,Q[1]=K[1]+$[1]*J,Q[2]=K[2]+$[2]*J,Q[3]=K[3]+$[3]*J,Q[4]=K[4]+$[4]*J,Q[5]=K[5]+$[5]*J,Q[6]=K[6]+$[6]*J,Q[7]=K[7]+$[7]*J,Q[8]=K[8]+$[8]*J,Q[9]=K[9]+$[9]*J,Q[10]=K[10]+$[10]*J,Q[11]=K[11]+$[11]*J,Q[12]=K[12]+$[12]*J,Q[13]=K[13]+$[13]*J,Q[14]=K[14]+$[14]*J,Q[15]=K[15]+$[15]*J,Q}function sQ(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]&&Q[4]===K[4]&&Q[5]===K[5]&&Q[6]===K[6]&&Q[7]===K[7]&&Q[8]===K[8]&&Q[9]===K[9]&&Q[10]===K[10]&&Q[11]===K[11]&&Q[12]===K[12]&&Q[13]===K[13]&&Q[14]===K[14]&&Q[15]===K[15]}function rQ(Q,K){var $=Q[0],J=Q[1],C=Q[2],Z=Q[3],V=Q[4],Y=Q[5],N=Q[6],W=Q[7],B=Q[8],F=Q[9],M=Q[10],H=Q[11],E=Q[12],X=Q[13],P=Q[14],D=Q[15],T=K[0],k=K[1],O=K[2],A=K[3],h=K[4],I=K[5],G=K[6],L=K[7],q=K[8],w=K[9],p=K[10],v=K[11],_=K[12],n=K[13],y=K[14],i=K[15];return Math.abs($-T)<=j*Math.max(1,Math.abs($),Math.abs(T))&&Math.abs(J-k)<=j*Math.max(1,Math.abs(J),Math.abs(k))&&Math.abs(C-O)<=j*Math.max(1,Math.abs(C),Math.abs(O))&&Math.abs(Z-A)<=j*Math.max(1,Math.abs(Z),Math.abs(A))&&Math.abs(V-h)<=j*Math.max(1,Math.abs(V),Math.abs(h))&&Math.abs(Y-I)<=j*Math.max(1,Math.abs(Y),Math.abs(I))&&Math.abs(N-G)<=j*Math.max(1,Math.abs(N),Math.abs(G))&&Math.abs(W-L)<=j*Math.max(1,Math.abs(W),Math.abs(L))&&Math.abs(B-q)<=j*Math.max(1,Math.abs(B),Math.abs(q))&&Math.abs(F-w)<=j*Math.max(1,Math.abs(F),Math.abs(w))&&Math.abs(M-p)<=j*Math.max(1,Math.abs(M),Math.abs(p))&&Math.abs(H-v)<=j*Math.max(1,Math.abs(H),Math.abs(v))&&Math.abs(E-_)<=j*Math.max(1,Math.abs(E),Math.abs(_))&&Math.abs(X-n)<=j*Math.max(1,Math.abs(X),Math.abs(n))&&Math.abs(P-y)<=j*Math.max(1,Math.abs(P),Math.abs(y))&&Math.abs(D-i)<=j*Math.max(1,Math.abs(D),Math.abs(i))}var vQ=O0,zQ=k0,eQ=U0,bQ=R0;var c={};u(c,{str:()=>{{return mK}},squaredLength:()=>{{return t0}},sqrLen:()=>{{return Q$}},sqlerp:()=>{{return C$}},slerp:()=>{{return e}},setAxisAngle:()=>{{return c0}},setAxes:()=>{{return Z$}},set:()=>{{return bK}},scale:()=>{{return b0}},rotationTo:()=>{{return J$}},rotateZ:()=>{{return fK}},rotateY:()=>{{return zK}},rotateX:()=>{{return nK}},random:()=>{{return iK}},pow:()=>{{return yK}},normalize:()=>{{return V0}},multiply:()=>{{return m0}},mul:()=>{{return oK}},ln:()=>{{return r0}},lerp:()=>{{return tK}},length:()=>{{return o0}},len:()=>{{return aK}},invert:()=>{{return lK}},identity:()=>{{return pK}},getAxisAngle:()=>{{return vK}},getAngle:()=>{{return gK}},fromValues:()=>{{return rK}},fromMat3:()=>{{return e0}},fromEuler:()=>{{return cK}},exp:()=>{{return s0}},exactEquals:()=>{{return K$}},equals:()=>{{return $$}},dot:()=>{{return u0}},create:()=>{{return Z0}},copy:()=>{{return eK}},conjugate:()=>{{return xK}},clone:()=>{{return sK}},calculateW:()=>{{return dK}},add:()=>{{return uK}}});var d={};u(d,{zero:()=>{{return hK}},transformQuat:()=>{{return XK}},transformMat4:()=>{{return HK}},transformMat3:()=>{{return MK}},subtract:()=>{{return T0}},sub:()=>{{return jK}},str:()=>{{return OK}},squaredLength:()=>{{return q0}},squaredDistance:()=>{{return L0}},sqrLen:()=>{{return LK}},sqrDist:()=>{{return GK}},set:()=>{{return tQ}},scaleAndAdd:()=>{{return VK}},scale:()=>{{return ZK}},round:()=>{{return CK}},rotateZ:()=>{{return UK}},rotateY:()=>{{return DK}},rotateX:()=>{{return EK}},random:()=>{{return PK}},normalize:()=>{{return J0}},negate:()=>{{return YK}},multiply:()=>{{return _0}},mul:()=>{{return TK}},min:()=>{{return $K}},max:()=>{{return JK}},lerp:()=>{{return WK}},length:()=>{{return j0}},len:()=>{{return C0}},inverse:()=>{{return NK}},hermite:()=>{{return BK}},fromValues:()=>{{return s}},forEach:()=>{{return qK}},floor:()=>{{return KK}},exactEquals:()=>{{return kK}},equals:()=>{{return RK}},dot:()=>{{return r}},divide:()=>{{return S0}},div:()=>{{return _K}},distance:()=>{{return G0}},dist:()=>{{return SK}},cross:()=>{{return x}},create:()=>{{return m}},copy:()=>{{return oQ}},clone:()=>{{return uQ}},ceil:()=>{{return QK}},bezier:()=>{{return FK}},angle:()=>{{return AK}},add:()=>{{return aQ}}});function m(){var Q=new S(3);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q}function uQ(Q){var K=new S(3);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K}function j0(Q){var K=Q[0],$=Q[1],J=Q[2];return Math.hypot(K,$,J)}function s(Q,K,$){var J=new S(3);return J[0]=Q,J[1]=K,J[2]=$,J}function oQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q}function tQ(Q,K,$,J){return Q[0]=K,Q[1]=$,Q[2]=J,Q}function aQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q}function T0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q}function _0(Q,K,$){return Q[0]=K[0]*$[0],Q[1]=K[1]*$[1],Q[2]=K[2]*$[2],Q}function S0(Q,K,$){return Q[0]=K[0]/$[0],Q[1]=K[1]/$[1],Q[2]=K[2]/$[2],Q}function QK(Q,K){return Q[0]=Math.ceil(K[0]),Q[1]=Math.ceil(K[1]),Q[2]=Math.ceil(K[2]),Q}function KK(Q,K){return Q[0]=Math.floor(K[0]),Q[1]=Math.floor(K[1]),Q[2]=Math.floor(K[2]),Q}function $K(Q,K,$){return Q[0]=Math.min(K[0],$[0]),Q[1]=Math.min(K[1],$[1]),Q[2]=Math.min(K[2],$[2]),Q}function JK(Q,K,$){return Q[0]=Math.max(K[0],$[0]),Q[1]=Math.max(K[1],$[1]),Q[2]=Math.max(K[2],$[2]),Q}function CK(Q,K){return Q[0]=Math.round(K[0]),Q[1]=Math.round(K[1]),Q[2]=Math.round(K[2]),Q}function ZK(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q}function VK(Q,K,$,J){return Q[0]=K[0]+$[0]*J,Q[1]=K[1]+$[1]*J,Q[2]=K[2]+$[2]*J,Q}function G0(Q,K){var $=K[0]-Q[0],J=K[1]-Q[1],C=K[2]-Q[2];return Math.hypot($,J,C)}function L0(Q,K){var $=K[0]-Q[0],J=K[1]-Q[1],C=K[2]-Q[2];return $*$+J*J+C*C}function q0(Q){var K=Q[0],$=Q[1],J=Q[2];return K*K+$*$+J*J}function YK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q}function NK(Q,K){return Q[0]=1/K[0],Q[1]=1/K[1],Q[2]=1/K[2],Q}function J0(Q,K){var $=K[0],J=K[1],C=K[2],Z=$*$+J*J+C*C;if(Z>0)Z=1/Math.sqrt(Z);return Q[0]=K[0]*Z,Q[1]=K[1]*Z,Q[2]=K[2]*Z,Q}function r(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]}function x(Q,K,$){var J=K[0],C=K[1],Z=K[2],V=$[0],Y=$[1],N=$[2];return Q[0]=C*N-Z*Y,Q[1]=Z*V-J*N,Q[2]=J*Y-C*V,Q}function WK(Q,K,$,J){var C=K[0],Z=K[1],V=K[2];return Q[0]=C+J*($[0]-C),Q[1]=Z+J*($[1]-Z),Q[2]=V+J*($[2]-V),Q}function BK(Q,K,$,J,C,Z){var V=Z*Z,Y=V*(2*Z-3)+1,N=V*(Z-2)+Z,W=V*(Z-1),B=V*(3-2*Z);return Q[0]=K[0]*Y+$[0]*N+J[0]*W+C[0]*B,Q[1]=K[1]*Y+$[1]*N+J[1]*W+C[1]*B,Q[2]=K[2]*Y+$[2]*N+J[2]*W+C[2]*B,Q}function FK(Q,K,$,J,C,Z){var V=1-Z,Y=V*V,N=Z*Z,W=Y*V,B=3*Z*Y,F=3*N*V,M=N*Z;return Q[0]=K[0]*W+$[0]*B+J[0]*F+C[0]*M,Q[1]=K[1]*W+$[1]*B+J[1]*F+C[1]*M,Q[2]=K[2]*W+$[2]*B+J[2]*F+C[2]*M,Q}function PK(Q,K){K=K||1;var $=z()*2*Math.PI,J=z()*2-1,C=Math.sqrt(1-J*J)*K;return Q[0]=Math.cos($)*C,Q[1]=Math.sin($)*C,Q[2]=J*K,Q}function HK(Q,K,$){var J=K[0],C=K[1],Z=K[2],V=$[3]*J+$[7]*C+$[11]*Z+$[15];return V=V||1,Q[0]=($[0]*J+$[4]*C+$[8]*Z+$[12])/V,Q[1]=($[1]*J+$[5]*C+$[9]*Z+$[13])/V,Q[2]=($[2]*J+$[6]*C+$[10]*Z+$[14])/V,Q}function MK(Q,K,$){var J=K[0],C=K[1],Z=K[2];return Q[0]=J*$[0]+C*$[3]+Z*$[6],Q[1]=J*$[1]+C*$[4]+Z*$[7],Q[2]=J*$[2]+C*$[5]+Z*$[8],Q}function XK(Q,K,$){var J=$[0],C=$[1],Z=$[2],V=$[3],Y=K[0],N=K[1],W=K[2],B=C*W-Z*N,F=Z*Y-J*W,M=J*N-C*Y,H=C*M-Z*F,E=Z*B-J*M,X=J*F-C*B,P=V*2;return B*=P,F*=P,M*=P,H*=2,E*=2,X*=2,Q[0]=Y+B+H,Q[1]=N+F+E,Q[2]=W+M+X,Q}function EK(Q,K,$,J){var C=[],Z=[];return C[0]=K[0]-$[0],C[1]=K[1]-$[1],C[2]=K[2]-$[2],Z[0]=C[0],Z[1]=C[1]*Math.cos(J)-C[2]*Math.sin(J),Z[2]=C[1]*Math.sin(J)+C[2]*Math.cos(J),Q[0]=Z[0]+$[0],Q[1]=Z[1]+$[1],Q[2]=Z[2]+$[2],Q}function DK(Q,K,$,J){var C=[],Z=[];return C[0]=K[0]-$[0],C[1]=K[1]-$[1],C[2]=K[2]-$[2],Z[0]=C[2]*Math.sin(J)+C[0]*Math.cos(J),Z[1]=C[1],Z[2]=C[2]*Math.cos(J)-C[0]*Math.sin(J),Q[0]=Z[0]+$[0],Q[1]=Z[1]+$[1],Q[2]=Z[2]+$[2],Q}function UK(Q,K,$,J){var C=[],Z=[];return C[0]=K[0]-$[0],C[1]=K[1]-$[1],C[2]=K[2]-$[2],Z[0]=C[0]*Math.cos(J)-C[1]*Math.sin(J),Z[1]=C[0]*Math.sin(J)+C[1]*Math.cos(J),Z[2]=C[2],Q[0]=Z[0]+$[0],Q[1]=Z[1]+$[1],Q[2]=Z[2]+$[2],Q}function AK(Q,K){var $=Q[0],J=Q[1],C=Q[2],Z=K[0],V=K[1],Y=K[2],N=Math.sqrt($*$+J*J+C*C),W=Math.sqrt(Z*Z+V*V+Y*Y),B=N*W,F=B&&r(Q,K)/B;return Math.acos(Math.min(Math.max(F,-1),1))}function hK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q}function OK(Q){return"vec3("+Q[0]+", "+Q[1]+", "+Q[2]+")"}function kK(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]}function RK(Q,K){var $=Q[0],J=Q[1],C=Q[2],Z=K[0],V=K[1],Y=K[2];return Math.abs($-Z)<=j*Math.max(1,Math.abs($),Math.abs(Z))&&Math.abs(J-V)<=j*Math.max(1,Math.abs(J),Math.abs(V))&&Math.abs(C-Y)<=j*Math.max(1,Math.abs(C),Math.abs(Y))}var jK=T0,TK=_0,_K=S0,SK=G0,GK=L0,C0=j0,LK=q0,qK=function(){var Q=m();return function(K,$,J,C,Z,V){var Y,N;if(!$)$=3;if(!J)J=0;if(C)N=Math.min(C*$+J,K.length);else N=K.length;for(Y=J;Y<N;Y+=$)Q[0]=K[Y],Q[1]=K[Y+1],Q[2]=K[Y+2],Z(Q,Q,V),K[Y]=Q[0],K[Y+1]=Q[1],K[Y+2]=Q[2];return K}}();function IK(){var Q=new S(4);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=0;return Q}function I0(Q){var K=new S(4);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K}function w0(Q,K,$,J){var C=new S(4);return C[0]=Q,C[1]=K,C[2]=$,C[3]=J,C}function p0(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q}function v0(Q,K,$,J,C){return Q[0]=K,Q[1]=$,Q[2]=J,Q[3]=C,Q}function g0(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q}function n0(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q}function z0(Q){var K=Q[0],$=Q[1],J=Q[2],C=Q[3];return Math.hypot(K,$,J,C)}function f0(Q){var K=Q[0],$=Q[1],J=Q[2],C=Q[3];return K*K+$*$+J*J+C*C}function d0(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=$*$+J*J+C*C+Z*Z;if(V>0)V=1/Math.sqrt(V);return Q[0]=$*V,Q[1]=J*V,Q[2]=C*V,Q[3]=Z*V,Q}function y0(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]+Q[3]*K[3]}function i0(Q,K,$,J){var C=K[0],Z=K[1],V=K[2],Y=K[3];return Q[0]=C+J*($[0]-C),Q[1]=Z+J*($[1]-Z),Q[2]=V+J*($[2]-V),Q[3]=Y+J*($[3]-Y),Q}function l0(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]}function x0(Q,K){var $=Q[0],J=Q[1],C=Q[2],Z=Q[3],V=K[0],Y=K[1],N=K[2],W=K[3];return Math.abs($-V)<=j*Math.max(1,Math.abs($),Math.abs(V))&&Math.abs(J-Y)<=j*Math.max(1,Math.abs(J),Math.abs(Y))&&Math.abs(C-N)<=j*Math.max(1,Math.abs(C),Math.abs(N))&&Math.abs(Z-W)<=j*Math.max(1,Math.abs(Z),Math.abs(W))}var S$=function(){var Q=IK();return function(K,$,J,C,Z,V){var Y,N;if(!$)$=4;if(!J)J=0;if(C)N=Math.min(C*$+J,K.length);else N=K.length;for(Y=J;Y<N;Y+=$)Q[0]=K[Y],Q[1]=K[Y+1],Q[2]=K[Y+2],Q[3]=K[Y+3],Z(Q,Q,V),K[Y]=Q[0],K[Y+1]=Q[1],K[Y+2]=Q[2],K[Y+3]=Q[3];return K}}();function Z0(){var Q=new S(4);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q[3]=1,Q}function pK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=1,Q}function c0(Q,K,$){$=$*0.5;var J=Math.sin($);return Q[0]=J*K[0],Q[1]=J*K[1],Q[2]=J*K[2],Q[3]=Math.cos($),Q}function vK(Q,K){var $=Math.acos(K[3])*2,J=Math.sin($/2);if(J>j)Q[0]=K[0]/J,Q[1]=K[1]/J,Q[2]=K[2]/J;else Q[0]=1,Q[1]=0,Q[2]=0;return $}function gK(Q,K){var $=u0(Q,K);return Math.acos(2*$*$-1)}function m0(Q,K,$){var J=K[0],C=K[1],Z=K[2],V=K[3],Y=$[0],N=$[1],W=$[2],B=$[3];return Q[0]=J*B+V*Y+C*W-Z*N,Q[1]=C*B+V*N+Z*Y-J*W,Q[2]=Z*B+V*W+J*N-C*Y,Q[3]=V*B-J*Y-C*N-Z*W,Q}function nK(Q,K,$){$*=0.5;var J=K[0],C=K[1],Z=K[2],V=K[3],Y=Math.sin($),N=Math.cos($);return Q[0]=J*N+V*Y,Q[1]=C*N+Z*Y,Q[2]=Z*N-C*Y,Q[3]=V*N-J*Y,Q}function zK(Q,K,$){$*=0.5;var J=K[0],C=K[1],Z=K[2],V=K[3],Y=Math.sin($),N=Math.cos($);return Q[0]=J*N-Z*Y,Q[1]=C*N+V*Y,Q[2]=Z*N+J*Y,Q[3]=V*N-C*Y,Q}function fK(Q,K,$){$*=0.5;var J=K[0],C=K[1],Z=K[2],V=K[3],Y=Math.sin($),N=Math.cos($);return Q[0]=J*N+C*Y,Q[1]=C*N-J*Y,Q[2]=Z*N+V*Y,Q[3]=V*N-Z*Y,Q}function dK(Q,K){var $=K[0],J=K[1],C=K[2];return Q[0]=$,Q[1]=J,Q[2]=C,Q[3]=Math.sqrt(Math.abs(1-$*$-J*J-C*C)),Q}function s0(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=Math.sqrt($*$+J*J+C*C),Y=Math.exp(Z),N=V>0?Y*Math.sin(V)/V:0;return Q[0]=$*N,Q[1]=J*N,Q[2]=C*N,Q[3]=Y*Math.cos(V),Q}function r0(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=Math.sqrt($*$+J*J+C*C),Y=V>0?Math.atan2(V,Z)/V:0;return Q[0]=$*Y,Q[1]=J*Y,Q[2]=C*Y,Q[3]=0.5*Math.log($*$+J*J+C*C+Z*Z),Q}function yK(Q,K,$){return r0(Q,K),b0(Q,Q,$),s0(Q,Q),Q}function e(Q,K,$,J){var C=K[0],Z=K[1],V=K[2],Y=K[3],N=$[0],W=$[1],B=$[2],F=$[3],M,H,E,X,P;if(H=C*N+Z*W+V*B+Y*F,H<0)H=-H,N=-N,W=-W,B=-B,F=-F;if(1-H>j)M=Math.acos(H),E=Math.sin(M),X=Math.sin((1-J)*M)/E,P=Math.sin(J*M)/E;else X=1-J,P=J;return Q[0]=X*C+P*N,Q[1]=X*Z+P*W,Q[2]=X*V+P*B,Q[3]=X*Y+P*F,Q}function iK(Q){var K=z(),$=z(),J=z(),C=Math.sqrt(1-K),Z=Math.sqrt(K);return Q[0]=C*Math.sin(2*Math.PI*$),Q[1]=C*Math.cos(2*Math.PI*$),Q[2]=Z*Math.sin(2*Math.PI*J),Q[3]=Z*Math.cos(2*Math.PI*J),Q}function lK(Q,K){var $=K[0],J=K[1],C=K[2],Z=K[3],V=$*$+J*J+C*C+Z*Z,Y=V?1/V:0;return Q[0]=-$*Y,Q[1]=-J*Y,Q[2]=-C*Y,Q[3]=Z*Y,Q}function xK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q[3]=K[3],Q}function e0(Q,K){var $=K[0]+K[4]+K[8],J;if($>0)J=Math.sqrt($+1),Q[3]=0.5*J,J=0.5/J,Q[0]=(K[5]-K[7])*J,Q[1]=(K[6]-K[2])*J,Q[2]=(K[1]-K[3])*J;else{var C=0;if(K[4]>K[0])C=1;if(K[8]>K[C*3+C])C=2;var Z=(C+1)%3,V=(C+2)%3;J=Math.sqrt(K[C*3+C]-K[Z*3+Z]-K[V*3+V]+1),Q[C]=0.5*J,J=0.5/J,Q[3]=(K[Z*3+V]-K[V*3+Z])*J,Q[Z]=(K[Z*3+C]+K[C*3+Z])*J,Q[V]=(K[V*3+C]+K[C*3+V])*J}return Q}function cK(Q,K,$,J){var C=0.5*Math.PI/180;K*=C,$*=C,J*=C;var Z=Math.sin(K),V=Math.cos(K),Y=Math.sin($),N=Math.cos($),W=Math.sin(J),B=Math.cos(J);return Q[0]=Z*N*B-V*Y*W,Q[1]=V*Y*B+Z*N*W,Q[2]=V*N*W-Z*Y*B,Q[3]=V*N*B+Z*Y*W,Q}function mK(Q){return"quat("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+")"}var sK=I0,rK=w0,eK=p0,bK=v0,uK=g0,oK=m0,b0=n0,u0=y0,tK=i0,o0=z0,aK=o0,t0=f0,Q$=t0,V0=d0,K$=l0,$$=x0,J$=function(){var Q=m(),K=s(1,0,0),$=s(0,1,0);return function(J,C,Z){var V=r(C,Z);if(V<-0.999999){if(x(Q,K,C),C0(Q)<0.000001)x(Q,$,C);return J0(Q,Q),c0(J,Q,Math.PI),J}else if(V>0.999999)return J[0]=0,J[1]=0,J[2]=0,J[3]=1,J;else return x(Q,C,Z),J[0]=Q[0],J[1]=Q[1],J[2]=Q[2],J[3]=1+V,V0(J,J)}}(),C$=function(){var Q=Z0(),K=Z0();return function($,J,C,Z,V,Y){return e(Q,J,V,Y),e(K,C,Z,Y),e($,Q,K,2*Y*(1-Y)),$}}(),Z$=function(){var Q=E0();return function(K,$,J,C){return Q[0]=J[0],Q[3]=J[1],Q[6]=J[2],Q[1]=C[0],Q[4]=C[1],Q[7]=C[2],Q[2]=-$[0],Q[5]=-$[1],Q[8]=-$[2],V0(K,e0(K,Q))}}();var a0=4096,V$=!1;class f extends g{texImgSrc;activated=!1;width;height;constructor(Q){super();this.texImgSrc=Q,this.width=Q instanceof HTMLImageElement?Q.naturalWidth:Q instanceof VideoFrame?Q.displayWidth:Q.width,this.height=Q instanceof HTMLImageElement?Q.naturalHeight:Q instanceof VideoFrame?Q.displayHeight:Q.width}static async loadImage(Q){return new Promise((K,$)=>{const J=new Image,C=new f(J),Z=()=>K(C),V=(Y)=>$(Y.error);J.addEventListener("error",V),J.addEventListener("load",Z,{once:!0}),C.addOnDestroy(()=>J.removeEventListener("load",Z)),J.src=Q})}static async loadVideo(Q,K){return new Promise(($,J)=>{const C=document.createElement("video"),Z=new f(C);if(C.loop=!0,K!==void 0)C.volume=K;const V=()=>C.play(),Y=()=>$(Z);C.addEventListener("loadedmetadata",V),C.addEventListener("playing",Y,{once:!0}),C.addEventListener("error",(N)=>J(N.error)),C.src=Q,Z.addOnDestroy(()=>{C.pause(),C.removeEventListener("playing",Y),C.removeEventListener("loadmetadata",V)})})}static async loadWebcam(Q){return new Promise((K,$)=>{const J=document.createElement("video"),C=new f(J);J.loop=!0;const Z=()=>J.play(),V=()=>K(C);J.addEventListener("loadedmetadata",Z),J.addEventListener("playing",V,{once:!0}),J.addEventListener("error",(N)=>$(N.error));let Y=!1;navigator.mediaDevices.getUserMedia({video:{deviceId:Q}}).then((N)=>{if(!Y)J.srcObject=N,C.addOnDestroy(()=>N.getTracks().forEach((W)=>W.stop()))}),C.addOnDestroy(()=>{Y=!0,J.pause(),J.removeEventListener("playing",V),J.removeEventListener("loadmetadata",Z)})})}}class Y0 extends g{gl;textureBuffers={};images={};tempCanvas=document.createElement("canvas");tempContext=this.tempCanvas.getContext("2d");constructor(Q){super();if(this.gl=Q,this.tempContext.imageSmoothingEnabled=!0,V$)this.tempCanvas.style.width="400px",this.tempCanvas.style.height="400px",document.body.appendChild(this.tempCanvas)}getTexture(Q){if(!this.textureBuffers[Q]){const K=this.gl.createTexture();if(!K)return;this.gl.bindTexture(U.TEXTURE_2D,K),this.gl.texImage2D(U.TEXTURE_2D,0,U.RGBA,a0,a0,0,U.RGBA,U.UNSIGNED_BYTE,null),this.gl.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),this.textureBuffers[Q]=K,this.addOnDestroy(()=>this.gl.deleteTexture(K))}return this.textureBuffers[Q]}loadTexture(Q,K,$,J,C){this.gl.activeTexture(U[K]),this.gl.bindTexture(U.TEXTURE_2D,$),this.applyTexImage2d(Q,J,C),this.gl.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR)}applyTexImage2d(Q,[K,$,J,C],[Z,V,Y,N]){const W=this.tempContext.canvas;if(Q.texImgSrc instanceof ImageData){if(W.width=Y||Q.width,W.height=N||Q.height,this.tempContext.putImageData(Q.texImgSrc,0,0),K||$)console.warn("Offset not available when sending imageData")}else{const B=J||Q.width,F=C||Q.height;W.width=Y||B,W.height=N||F,this.tempContext.drawImage(Q.texImgSrc,K,$,B,F,0,0,W.width,W.height)}this.gl.texSubImage2D(U.TEXTURE_2D,0,Z,V,W.width,W.height,U.RGBA,U.UNSIGNED_BYTE,W)}hasImageId(Q){return!!this.images[Q]}async loadCanvas(Q,K){const $=new f(Q);return this.images[K]=this.own($),$}async loadImage(Q,K){const $=await f.loadImage(Q);return this.images[K]=this.own($),$}async loadVideo(Q,K,$){const J=await f.loadVideo(Q,$);return this.images[K]=this.own(J),J}async loadWebCam(Q,K){const $=await f.loadWebcam(Q);return this.images[K]=this.own($),$}assignImageToTexture(Q,K,$,J){if(!this.getTexture(K)){console.warn("Invalid texture Id");return}const C=this.images[Q];if(C){const Z=this.getTexture(K);if(Z){const V=$??[0,0,C.width,C.height],Y=J??[0,0,V[2],V[3]];if(C.activated)this.gl.bindTexture(U.TEXTURE_2D,Z),this.applyTexImage2d(C,V,Y);else this.loadTexture(C,K,Z,V,Y),C.activated=!0}else console.warn(`Texture not found: ${K}`)}}generateMipMap(Q){const K=this.getTexture(Q);if(K)this.gl.activeTexture(U[Q]),this.gl.bindTexture(U.TEXTURE_2D,K),this.gl.generateMipmap(U.TEXTURE_2D),console.log("GENERATED MIPMAP")}}var W$=function(Q){if(!N$)return Q;return new Proxy(Q,{get($,J){const C=$,Z=C[J];if(typeof Z==="function")return(...Y)=>{const N=Z.apply(C,Y);return console.log(`gl.${String(J)}(`,Y,") = ",N),N};else return console.log(`gl.${String(J)} = `,Z),Z}})},Y$={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},b=2048,N$=!1;class N0 extends g{gl;perspectiveLevel=1;programs;attributeBuffers;uniforms;cameraMatrix;camTurnMatrix;perspectiveMatrix;orthoMatrix;projectionMatrix;canvas;textureManager;constructor(Q,K){super();this.gl=W$(Q.getContext("webgl2",{...Y$,...K})),this.canvas=Q,this.textureManager=new Y0(this.gl),this.programs=this.own(new t(this.gl)),this.attributeBuffers=this.own(new Q0(this.gl,this.programs)),this.uniforms=this.own(new K0(this.gl,this.programs)),this.cameraMatrix=R.translate(R.create(),R.identity(R.create()),d.fromValues(0,0,-1)),this.camTurnMatrix=R.identity(R.create()),this.perspectiveMatrix=R.identity(R.create()),this.orthoMatrix=R.identity(R.create()),this.projectionMatrix=R.identity(R.create()),window.addEventListener("resize",this.checkCanvasSize.bind(this))}checkCanvasSize(){this.canvas.width=this.canvas.offsetWidth*2,this.canvas.height=this.canvas.offsetHeight*2,this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const Q=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;this.configOrthoMatrix(Q),this.configPerspectiveMatrix(Q)}async initialize(){this.gl.enable(U.DEPTH_TEST),this.gl.depthFunc(U.LEQUAL),this.gl.enable(U.BLEND),this.gl.blendFunc(U.SRC_ALPHA,U.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);{const Q=P0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ELEMENT_ARRAY_BUFFER,K),this.attributeBuffers.bufferData(U.ELEMENT_ARRAY_BUFFER,Q,Uint16Array.from([0,1,2,2,3,0]),0,U.STATIC_DRAW)}{const Q=$0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,K),this.gl.vertexAttribPointer(K.location,3,U.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(K.location),this.attributeBuffers.bufferData(U.ARRAY_BUFFER,Q,Float32Array.from([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),0,U.STATIC_DRAW)}{const Q=H0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,K);for(let $=0;$<4;$++){const J=K.location+$;this.gl.vertexAttribPointer(J,4,U.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,$*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(J),this.gl.vertexAttribDivisor(J,1)}this.attributeBuffers.bufferData(U.ARRAY_BUFFER,Q,Float32Array.from([...R.identity(R.create()),...R.fromYRotation(R.create(),Math.PI/4),...R.fromYRotation(R.create(),Math.PI/2)]),0,U.DYNAMIC_DRAW)}{const Q=M0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,K),this.gl.vertexAttribPointer(K.location,2,U.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(K.location),this.attributeBuffers.bufferData(U.ARRAY_BUFFER,Q,Float32Array.from([0,1,1,1,1,0,0,0]),0,U.DYNAMIC_DRAW)}{const K=document.createElement("canvas");K.width=2048,K.height=2048;const $=K.getContext("2d");$.imageSmoothingEnabled=!0,$.fillStyle="silver",$.strokeStyle="black",$.lineWidth=K.width/50,$.fillRect(0,0,K.width,K.height),$.beginPath(),$.arc(K.width/2,K.height/2,K.width/2*0.8,0,2*Math.PI),$.moveTo(0,0),$.lineTo(K.width,K.height),$.moveTo(0,K.height),$.lineTo(K.width,0),$.stroke(),await this.textureManager.loadCanvas(K,"test"),this.textureManager.assignImageToTexture("test","TEXTURE0",[0,0,K.width,K.height],[0,0,b,b]),this.textureManager.generateMipMap("TEXTURE0")}this.checkCanvasSize(),this.refreshCamera()}configPerspectiveMatrix(Q){const K=Math.PI/90;this.perspectiveMatrix=R.perspective(R.create(),45*K,Q,0,1e4),this.setPerspective()}configOrthoMatrix(Q){this.orthoMatrix=R.ortho(R.create(),-1*Q,1*Q,-1,1,-100,100),this.setPerspective()}refreshCamera(){const Q=R.identity(R.create());R.mul(Q,this.cameraMatrix,Q),R.mul(Q,this.camTurnMatrix,Q),R.mul(Q,this.projectionMatrix,Q);const K=this.uniforms.getUniformLocation(X0);if(K)this.gl.uniformMatrix4fv(K,!1,Q)}updateTrianglePosition(Q,K){const $=this.attributeBuffers.getAttributeBuffer($0);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,$),this.attributeBuffers.bufferSubData(U.ARRAY_BUFFER,Float32Array.from(K),Q*4*3*Float32Array.BYTES_PER_ELEMENT)}setPerspective(Q){if(Q!==void 0)this.perspectiveLevel=Q;const K=R.create();R.multiplyScalar(K,this.orthoMatrix,1-this.perspectiveLevel);const $=R.create();R.multiplyScalar($,this.perspectiveMatrix,this.perspectiveLevel),R.copy(this.projectionMatrix,K),R.add(this.projectionMatrix,this.projectionMatrix,$),this.refreshCamera()}moveCam(Q,K){const $=c.create();R.getRotation($,this.camTurnMatrix),c.invert($,$);const J=d.fromValues(-Q,0,K);d.transformQuat(J,J,$),R.translate(this.cameraMatrix,this.cameraMatrix,J),this.refreshCamera()}turnCam(Q){R.rotateY(this.camTurnMatrix,this.camTurnMatrix,Q),this.refreshCamera()}drawArrays(Q){this.gl.drawArrays(U.TRIANGLES,0,Q)}drawElementsInstanced(Q,K){this.gl.clear(U.COLOR_BUFFER_BIT|U.DEPTH_BUFFER_BIT),this.gl.drawElementsInstanced(U.TRIANGLES,Q,U.UNSIGNED_SHORT,0,K)}bindVertexArray(){return this.own(new a(this.gl))}}var QQ=`#version 300 es

precision highp float;

const float TEXTURE_SIZE = 4096.;
const float SLOT_SIZE = ~{TEXTURE_SLOT_SIZE}; //  256
const float SLOT_SIDE_COUNT = TEXTURE_SIZE / SLOT_SIZE;

//  IN
//  shape
layout (location=0) in vec4 position;
layout (location=1) in mat4 transform;
//  2, 3, 4
//  animation
layout (location=5) in vec2 tex;

//  UNIFORM
uniform mat4 cam;

//  OUT
out vec2 vTex;
out float textureIndex;
out float opacity;

void main() {
    gl_Position = cam * transform * position;
    float slotTextSize = SLOT_SIZE / TEXTURE_SIZE;
    vTex = tex * slotTextSize;
    textureIndex = 0.;
    opacity = 1.;
}
`;var KQ=`#version 300 es

precision highp float;

//  CONST
const int NUM_TEXTURES = 16;
const float threshold = 0.00001;

//  IN
//  texture
uniform sampler2D uTextures[NUM_TEXTURES];
in float textureIndex;
in vec2 vTex;
in float opacity;

//  OUT
out vec4 fragColor;

//  FUNCTIONS
vec4 getTextureColor(float textureSlot, vec2 vTexturePoint);

void main() {
    vec4 color = getTextureColor(textureIndex, vTex);
    if (color.a <= .01) {
        discard;
    };
    fragColor = vec4(color.rgb, 1.);
}

vec4 getTextureColor(float textureSlot, vec2 vTexturePoint) {
    if (abs(0.0 - textureSlot) < threshold) {
        return texture(uTextures[0], vTexturePoint);
    }
    if (abs(1.0 - textureSlot) < threshold) {
        return texture(uTextures[1], vTexturePoint);
    }
    if (abs(2.0 - textureSlot) < threshold) {
        return texture(uTextures[2], vTexturePoint);
    }
    if (abs(3.0 - textureSlot) < threshold) {
        return texture(uTextures[3], vTexturePoint);
    }
    if (abs(4.0 - textureSlot) < threshold) {
        return texture(uTextures[4], vTexturePoint);
    }
    if (abs(5.0 - textureSlot) < threshold) {
        return texture(uTextures[5], vTexturePoint);
    }
    if (abs(6.0 - textureSlot) < threshold) {
        return texture(uTextures[6], vTexturePoint);
    }
    if (abs(7.0 - textureSlot) < threshold) {
        return texture(uTextures[7], vTexturePoint);
    }
    if (abs(8.0 - textureSlot) < threshold) {
        return texture(uTextures[8], vTexturePoint);
    }
    if (abs(9.0 - textureSlot) < threshold) {
        return texture(uTextures[9], vTexturePoint);
    }
    if (abs(10.0 - textureSlot) < threshold) {
        return texture(uTextures[10], vTexturePoint);
    }
    if (abs(11.0 - textureSlot) < threshold) {
        return texture(uTextures[11], vTexturePoint);
    }
    if (abs(12.0 - textureSlot) < threshold) {
        return texture(uTextures[12], vTexturePoint);
    }
    if (abs(13.0 - textureSlot) < threshold) {
        return texture(uTextures[13], vTexturePoint);
    }
    if (abs(14.0 - textureSlot) < threshold) {
        return texture(uTextures[14], vTexturePoint);
    }
    if (abs(15.0 - textureSlot) < threshold) {
        return texture(uTextures[15], vTexturePoint);
    }
    return texture(uTextures[0], vTexturePoint);
}            
`;function W0(Q,K){return Q.replace(/~\{(\w+)\}/g,($,J)=>{return K?.[J]||$})}async function e$(){console.log("Hello World!")}function b$(Q){Q.style.border=".5px solid silver";const K=new N0(Q),$={TEXTURE_SLOT_SIZE:b.toFixed(1)};K.programs.addProgram("test",W0(QQ,$),W0(KQ,$)),K.programs.useProgram("test"),K.initialize();const J={};document.addEventListener("keydown",(Z)=>{J[Z.code]=!0}),document.addEventListener("keyup",(Z)=>{J[Z.code]=!1});function C(){if(J.KeyW)K.moveCam(0,0.25);if(J.KeyS)K.moveCam(0,-0.25);if(J.KeyA)K.moveCam(-0.25,0);if(J.KeyD)K.moveCam(0.25,0);if(J.KeyQ)K.turnCam(-0.05);if(J.KeyE)K.turnCam(0.05);const Y=6,N=1;K.drawElementsInstanced(Y,N),requestAnimationFrame(C)}return C(),K}export{b$ as testCanvas,e$ as hello};

//# debugId=F8768B9F307FE40A64756e2164756e21
