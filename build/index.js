var _K=Object.defineProperty;var F0=(K,Q)=>{for(var $ in Q)_K(K,$,{get:Q[$],enumerable:!0,configurable:!0,set:(J)=>Q[$]=()=>J})};class f{disposables;own(K){if(!this.disposables)this.disposables=new Set;return this.disposables.add(K),K}addOnDestroy(K){this.disposables?.add({destroy:K})}destroy(){this.disposables?.forEach((K)=>K.destroy())}}var A=globalThis.WebGL2RenderingContext!==void 0?globalThis.WebGL2RenderingContext:{},I0="position_and_tex",S0="index",P0="transform",w0="slotSize_and_number",e="cam",v0="projection",p0="maxTextureSize";var GK=function(K,Q,$){function J(C,H){function W(O){return O===K?.VERTEX_SHADER?"vertex":O===K?.FRAGMENT_SHADER?"fragment":void 0}if(H!==K.VERTEX_SHADER&&H!==K.FRAGMENT_SHADER)throw new Error(`Shader error in ${W(H)}`);const U=K.createShader(H);if(!U)throw new Error(`Unable to generate ${W(H)} shader.`);if(K.shaderSource(U,C),K.compileShader(U),!K.getShaderParameter(U,K.COMPILE_STATUS))console.error(`Shader compile error in ${W(H)}:`+K.getShaderInfoLog(U));return U}const V=K.createProgram();if(!V)throw new Error("Unable to create program.");const Y=J(Q,K.VERTEX_SHADER),Z=J($,K.FRAGMENT_SHADER),B=K.getShaderInfoLog(Y),F=K.getShaderInfoLog(Z);if(B)console.log("VERTEX",B);if(F)console.log("FRAGMENT",F);K.attachShader(V,Y),K.attachShader(V,Z),K.linkProgram(V);const P=K.getProgramInfoLog(V);if(P)console.log("PROGRAM",P);if(K.detachShader(V,Y),K.detachShader(V,Z),K.deleteShader(Y),K.deleteShader(Z),K.validateProgram(V),Object.entries(A).forEach(([C,H])=>{if(H&&K.getError()===H)console.log(`gl.${C}`)}),!K.getProgramParameter(V,K.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+K.getProgramInfoLog(V));return V},kK=function(K,Q){K.deleteProgram(Q)};class C0 extends f{gl;program;constructor(K,Q,$){super();this.gl=K,this.program=GK(K,Q.trim(),$.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),kK(this.gl,this.program)}}class H0 extends f{activeProgramId="";gl;programs={};constructor(K){super();this.gl=K}addProgram(K,Q,$){if(this.programs[K])this.removeProgram(K);this.programs[K]=this.own(new C0(this.gl,Q,$))}useProgram(K){if(this.activeProgramId!==K)this.activeProgramId=K,this.programs[K].use()}removeProgram(K){this.programs[K].destroy(),delete this.programs[K]}getProgram(K){return this.programs[K??this.activeProgramId]?.program}}class X0 extends f{gl;triangleArray;constructor(K){super();this.gl=K,this.triangleArray=K.createVertexArray(),K.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class U0 extends f{bufferRecord={};lastBoundBuffer;gl;programs;constructor(K,Q){super();this.gl=K,this.programs=Q}getAttributeLocation(K,Q){const $=this.programs.getProgram(Q);return $?this.gl.getAttribLocation($,K)??-1:-1}createBuffer(K){this.deleteBuffer(K);const Q=this.gl?.createBuffer();if(!Q)throw new Error(`Unable to create buffer "${K}"`);const $={buffer:Q,location:this.getAttributeLocation(K)};return this.bufferRecord[K]=$,$}deleteBuffer(K){if(this.bufferRecord[K])this.gl.deleteBuffer(this.bufferRecord[K].buffer),delete this.bufferRecord[K]}getAttributeBuffer(K,Q){const $=this.bufferRecord[K];if(!$){if(Q)return this.createBuffer(K);throw new Error(`Attribute "${K}" not created. Make sure "createBuffer" is called.`)}return $}bufferData(K,Q,$,J,V){const Y=this.getAttributeBuffer(Q);if($)this.gl.bufferData(K,$,V);else this.gl.bufferData(K,J,V);Y.bufferSize=J||$?.length,Y.bufferArray=$??new Float32Array(Y.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),Y.usage=V,Y.target=K}bufferSubData(K,Q,$,J,V){if(J)this.gl.bufferSubData(K,$,Q,J,V);else this.gl.bufferSubData(K,$,Q)}bindBuffer(K,Q){if(this.lastBoundBuffer!==Q)this.lastBoundBuffer=Q,this.gl.bindBuffer(K,Q.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((K)=>this.deleteBuffer(K))}}class W0 extends f{gl;programs;constructor(K,Q){super();this.gl=K,this.programs=Q}getUniformLocation(K,Q){const $=this.programs.getProgram(Q);return $?this.gl.getUniformLocation($,K)??void 0:void 0}}var f0=4096;class D0 extends f{gl;textureBuffers={};tempCanvas=new OffscreenCanvas(1,1);tempContext=this.tempCanvas.getContext("2d");constructor(K){super();this.gl=K,this.tempContext.imageSmoothingEnabled=!0}getTexture(K){if(!this.textureBuffers[K]){const Q=this.gl.createTexture();if(!Q)return;this.gl.bindTexture(A.TEXTURE_2D,Q),this.gl.texImage2D(A.TEXTURE_2D,0,A.RGBA,f0,f0,0,A.RGBA,A.UNSIGNED_BYTE,null),this.textureBuffers[K]=Q,this.addOnDestroy(()=>this.gl.deleteTexture(Q))}return this.textureBuffers[K]}loadTexture(K,Q,$,J,V){this.gl.activeTexture(A[Q]),this.gl.bindTexture(A.TEXTURE_2D,$),this.applyTexImage2d(K,J,V),this.gl.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR)}applyTexImage2d(K,[Q,$,J,V],[Y,Z,B,F]){if(J===B&&V===F&&!Q&&!$)this.gl.texSubImage2D(A.TEXTURE_2D,0,Y,Z,J,V,A.RGBA,A.UNSIGNED_BYTE,K.texImgSrc);else{console.log("Used canvas");const P=this.tempContext.canvas;if(K.texImgSrc instanceof ImageData){if(P.width=B||K.width,P.height=F||K.height,this.tempContext.putImageData(K.texImgSrc,0,0),Q||$)console.warn("Offset not available when sending imageData")}else{const C=J||K.width,H=V||K.height;P.width=B||C,P.height=F||H,this.tempContext.drawImage(K.texImgSrc,Q,$,C,H,0,0,P.width,P.height)}this.gl.texSubImage2D(A.TEXTURE_2D,0,Y,Z,P.width,P.height,A.RGBA,A.UNSIGNED_BYTE,P)}}applyImageToSlot(K,Q,$=!1){const J=`TEXTURE${Q.textureIndex}`,V=this.getTexture(J);if(!V)return console.warn(`Invalid texture Id ${J}`),null;const Y=this.assignImageToTexture(K,J,V,[0,0,K.width,K.height],[Q.x,Q.y,...Q.size]);if($)this.generateMipMap(J);return Y}assignImageToTexture(K,Q,$,J,V){if(K){const Y=J??[0,0,K.width,K.height],Z=V??[0,0,Y[2],Y[3]];if(K.active){const B=()=>{this.gl.bindTexture(A.TEXTURE_2D,$),this.applyTexImage2d(K,Y,Z)};return B(),B}else this.loadTexture(K,Q,$,Y,Z),K.active=!0}return null}generateMipMap(K){const Q=this.getTexture(K);if(Q)this.gl.activeTexture(A[K]),this.gl.bindTexture(A.TEXTURE_2D,Q),this.gl.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),this.gl.generateMipmap(A.TEXTURE_2D),console.log("GENERATED MIPMAP")}}class y extends f{texImgSrc;active=!1;width;height;constructor(K){super();if(this.texImgSrc=K,this.width=K instanceof Image?K.naturalWidth:K instanceof VideoFrame?K.displayWidth:K.width,this.height=K instanceof Image?K.naturalHeight:K instanceof VideoFrame?K.displayHeight:K.height,!this.width||!this.height)throw new Error("Invalid image")}static createFromCanvas(K){return new y(K)}static async loadImage(K){return new Promise((Q,$)=>{const J=new Image,V=new y(J),Y=()=>Q(V),Z=(B)=>$(B.error);J.addEventListener("error",Z),J.addEventListener("load",Y,{once:!0}),V.addOnDestroy(()=>J.removeEventListener("load",Y)),J.src=K})}static async loadVideo(K,Q){return new Promise(($,J)=>{const V=document.createElement("video"),Y=new y(V);if(V.loop=!0,Q!==void 0)V.volume=Q;const Z=()=>V.play(),B=()=>$(Y);V.addEventListener("loadedmetadata",Z),V.addEventListener("playing",B,{once:!0}),V.addEventListener("error",(F)=>J(F.error)),V.src=K,Y.addOnDestroy(()=>{V.pause(),V.removeEventListener("playing",B),V.removeEventListener("loadmetadata",Z)})})}static async loadWebcam(K){return new Promise((Q,$)=>{const J=document.createElement("video"),V=new y(J);J.loop=!0;const Y=()=>J.play(),Z=()=>Q(V);J.addEventListener("loadedmetadata",Y),J.addEventListener("playing",Z,{once:!0}),J.addEventListener("error",(F)=>$(F.error));let B=!1;navigator.mediaDevices.getUserMedia({video:{deviceId:K}}).then((F)=>{if(!B)J.srcObject=F,V.addOnDestroy(()=>F.getTracks().forEach((P)=>P.stop()))}),V.addOnDestroy(()=>{B=!0,J.pause(),J.removeEventListener("playing",Z),J.removeEventListener("loadmetadata",Y)})})}}class O0 extends f{constructor(){super(...arguments)}images={};hasImageId(K){return!!this.getMedia(K)}getMedia(K){return this.images[K]}setImage(K,Q){this.images[K]=Q}async drawImage(K,Q){const $=new OffscreenCanvas(1,1);Q($.getContext("2d"));const J=y.createFromCanvas($);return this.images[K]=this.own(J),J}async loadCanvas(K,Q){const $=y.createFromCanvas(Q);return Q.getContext("2d"),this.images[K]=this.own($),$}async loadImage(K,Q){const $=await y.loadImage(Q);return this.images[K]=this.own($),$}async loadVideo(K,Q,$){const J=await y.loadVideo(Q,$);return this.images[K]=this.own(J),J}async loadWebCam(K,Q){const $=await y.loadWebcam(Q);return this.images[K]=this.own($),$}}var z0=`#version 300 es
//  ~{AUTHOR}

precision highp float;

//  IN
//  shape
layout(location = 0) in vec4 position_and_tex;
layout(location = 1) in mat4 transform;
//  2, 3, 4
//  animation
layout(location = 5) in vec3 slotSize_and_number;

//  UNIFORM
uniform float maxTextureSize;
uniform mat4 cam;
uniform mat4 projection;

//  OUT
out vec2 vTex;
out float textureIndex;

void main() {
  vec2 position = position_and_tex.xy;
  vec2 tex = position_and_tex.zw;
  vec2 slotSize = slotSize_and_number.xy;
  float slotNumber = slotSize_and_number.z;
  vec2 slotOffset = vec2(mod(slotNumber, slotSize.x), floor(slotNumber / slotSize.x));

  gl_Position = projection * cam * transform * vec4(position, 0.0, 1.0);
  vTex = (slotOffset + tex) * (slotSize / maxTextureSize);
  textureIndex = 0.;
}
`;var g0=`#version 300 es
//  ~{AUTHOR}
precision highp float;

//  CONST
const int NUM_TEXTURES = 16;
const float threshold = 0.00001;

//  IN
//  texture
uniform sampler2D uTextures[NUM_TEXTURES];
in float textureIndex;
in vec2 vTex;
in float opacity;

//  OUT
out vec4 fragColor;

//  FUNCTIONS
vec4 getTextureColor(float textureSlot, vec2 vTexturePoint);

void main() {
  vec4 color = getTextureColor(textureIndex, vTex);
  if (color.a <= .01) {
    discard;
  };
  fragColor = color;
}

vec4 getTextureColor(float textureSlot, vec2 vTexturePoint) {
  if (abs(0.0 - textureSlot) < threshold) {
    return texture(uTextures[0], vTexturePoint);
  }
  if (abs(1.0 - textureSlot) < threshold) {
    return texture(uTextures[1], vTexturePoint);
  }
  if (abs(2.0 - textureSlot) < threshold) {
    return texture(uTextures[2], vTexturePoint);
  }
  if (abs(3.0 - textureSlot) < threshold) {
    return texture(uTextures[3], vTexturePoint);
  }
  if (abs(4.0 - textureSlot) < threshold) {
    return texture(uTextures[4], vTexturePoint);
  }
  if (abs(5.0 - textureSlot) < threshold) {
    return texture(uTextures[5], vTexturePoint);
  }
  if (abs(6.0 - textureSlot) < threshold) {
    return texture(uTextures[6], vTexturePoint);
  }
  if (abs(7.0 - textureSlot) < threshold) {
    return texture(uTextures[7], vTexturePoint);
  }
  if (abs(8.0 - textureSlot) < threshold) {
    return texture(uTextures[8], vTexturePoint);
  }
  if (abs(9.0 - textureSlot) < threshold) {
    return texture(uTextures[9], vTexturePoint);
  }
  if (abs(10.0 - textureSlot) < threshold) {
    return texture(uTextures[10], vTexturePoint);
  }
  if (abs(11.0 - textureSlot) < threshold) {
    return texture(uTextures[11], vTexturePoint);
  }
  if (abs(12.0 - textureSlot) < threshold) {
    return texture(uTextures[12], vTexturePoint);
  }
  if (abs(13.0 - textureSlot) < threshold) {
    return texture(uTextures[13], vTexturePoint);
  }
  if (abs(14.0 - textureSlot) < threshold) {
    return texture(uTextures[14], vTexturePoint);
  }
  if (abs(15.0 - textureSlot) < threshold) {
    return texture(uTextures[15], vTexturePoint);
  }
  return texture(uTextures[0], vTexturePoint);
}
`;function j0(K,Q){return K.replace(/~\{(\w+)\}/g,($,J)=>{return Q?.[J]||$})}var _=0.000001,L=typeof Float32Array!=="undefined"?Float32Array:Array,c=Math.random,FJ=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var K=0,Q=arguments.length;while(Q--)K+=arguments[Q]*arguments[Q];return Math.sqrt(K)};function y0(){var K=new L(9);if(L!=Float32Array)K[1]=0,K[2]=0,K[3]=0,K[5]=0,K[6]=0,K[7]=0;return K[0]=1,K[4]=1,K[8]=1,K}var q={};F0(q,{transpose:()=>{{return pK}},translate:()=>{{return yK}},targetTo:()=>{{return PQ}},subtract:()=>{{return n0}},sub:()=>{{return AQ}},str:()=>{{return CQ}},set:()=>{{return vK}},scale:()=>{{return xK}},rotateZ:()=>{{return lK}},rotateY:()=>{{return dK}},rotateX:()=>{{return mK}},rotate:()=>{{return cK}},perspectiveZO:()=>{{return VQ}},perspectiveNO:()=>{{return l0}},perspectiveFromFieldOfView:()=>{{return YQ}},perspective:()=>{{return JQ}},orthoZO:()=>{{return ZQ}},orthoNO:()=>{{return i0}},ortho:()=>{{return BQ}},multiplyScalarAndAdd:()=>{{return WQ}},multiplyScalar:()=>{{return UQ}},multiply:()=>{{return c0}},mul:()=>{{return jQ}},lookAt:()=>{{return FQ}},invert:()=>{{return fK}},identity:()=>{{return x0}},getTranslation:()=>{{return oK}},getScaling:()=>{{return d0}},getRotation:()=>{{return aK}},frustum:()=>{{return $Q}},fromZRotation:()=>{{return eK}},fromYRotation:()=>{{return bK}},fromXRotation:()=>{{return rK}},fromValues:()=>{{return wK}},fromTranslation:()=>{{return iK}},fromScaling:()=>{{return nK}},fromRotationTranslationScaleOrigin:()=>{{return KQ}},fromRotationTranslationScale:()=>{{return tK}},fromRotationTranslation:()=>{{return m0}},fromRotation:()=>{{return sK}},fromQuat2:()=>{{return uK}},fromQuat:()=>{{return QQ}},frob:()=>{{return HQ}},exactEquals:()=>{{return DQ}},equals:()=>{{return OQ}},determinant:()=>{{return gK}},create:()=>{{return hK}},copy:()=>{{return SK}},clone:()=>{{return IK}},adjoint:()=>{{return zK}},add:()=>{{return XQ}}});function hK(){var K=new L(16);if(L!=Float32Array)K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[11]=0,K[12]=0,K[13]=0,K[14]=0;return K[0]=1,K[5]=1,K[10]=1,K[15]=1,K}function IK(K){var Q=new L(16);return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function SK(K,Q){return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function wK(K,Q,$,J,V,Y,Z,B,F,P,C,H,W,U,O,D){var X=new L(16);return X[0]=K,X[1]=Q,X[2]=$,X[3]=J,X[4]=V,X[5]=Y,X[6]=Z,X[7]=B,X[8]=F,X[9]=P,X[10]=C,X[11]=H,X[12]=W,X[13]=U,X[14]=O,X[15]=D,X}function vK(K,Q,$,J,V,Y,Z,B,F,P,C,H,W,U,O,D,X){return K[0]=Q,K[1]=$,K[2]=J,K[3]=V,K[4]=Y,K[5]=Z,K[6]=B,K[7]=F,K[8]=P,K[9]=C,K[10]=H,K[11]=W,K[12]=U,K[13]=O,K[14]=D,K[15]=X,K}function x0(K){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function pK(K,Q){if(K===Q){var $=Q[1],J=Q[2],V=Q[3],Y=Q[6],Z=Q[7],B=Q[11];K[1]=Q[4],K[2]=Q[8],K[3]=Q[12],K[4]=$,K[6]=Q[9],K[7]=Q[13],K[8]=J,K[9]=Y,K[11]=Q[14],K[12]=V,K[13]=Z,K[14]=B}else K[0]=Q[0],K[1]=Q[4],K[2]=Q[8],K[3]=Q[12],K[4]=Q[1],K[5]=Q[5],K[6]=Q[9],K[7]=Q[13],K[8]=Q[2],K[9]=Q[6],K[10]=Q[10],K[11]=Q[14],K[12]=Q[3],K[13]=Q[7],K[14]=Q[11],K[15]=Q[15];return K}function fK(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=Q[4],B=Q[5],F=Q[6],P=Q[7],C=Q[8],H=Q[9],W=Q[10],U=Q[11],O=Q[12],D=Q[13],X=Q[14],j=Q[15],G=$*B-J*Z,N=$*F-V*Z,R=$*P-Y*Z,M=J*F-V*B,E=J*P-Y*B,w=V*P-Y*F,h=C*D-H*O,I=C*X-W*O,S=C*j-U*O,v=H*X-W*D,p=H*j-U*D,z=W*j-U*X,k=G*z-N*p+R*v+M*S-E*I+w*h;if(!k)return null;return k=1/k,K[0]=(B*z-F*p+P*v)*k,K[1]=(V*p-J*z-Y*v)*k,K[2]=(D*w-X*E+j*M)*k,K[3]=(W*E-H*w-U*M)*k,K[4]=(F*S-Z*z-P*I)*k,K[5]=($*z-V*S+Y*I)*k,K[6]=(X*R-O*w-j*N)*k,K[7]=(C*w-W*R+U*N)*k,K[8]=(Z*p-B*S+P*h)*k,K[9]=(J*S-$*p-Y*h)*k,K[10]=(O*E-D*R+j*G)*k,K[11]=(H*R-C*E-U*G)*k,K[12]=(B*I-Z*v-F*h)*k,K[13]=($*v-J*I+V*h)*k,K[14]=(D*N-O*M-X*G)*k,K[15]=(C*M-H*N+W*G)*k,K}function zK(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=Q[4],B=Q[5],F=Q[6],P=Q[7],C=Q[8],H=Q[9],W=Q[10],U=Q[11],O=Q[12],D=Q[13],X=Q[14],j=Q[15];return K[0]=B*(W*j-U*X)-H*(F*j-P*X)+D*(F*U-P*W),K[1]=-(J*(W*j-U*X)-H*(V*j-Y*X)+D*(V*U-Y*W)),K[2]=J*(F*j-P*X)-B*(V*j-Y*X)+D*(V*P-Y*F),K[3]=-(J*(F*U-P*W)-B*(V*U-Y*W)+H*(V*P-Y*F)),K[4]=-(Z*(W*j-U*X)-C*(F*j-P*X)+O*(F*U-P*W)),K[5]=$*(W*j-U*X)-C*(V*j-Y*X)+O*(V*U-Y*W),K[6]=-($*(F*j-P*X)-Z*(V*j-Y*X)+O*(V*P-Y*F)),K[7]=$*(F*U-P*W)-Z*(V*U-Y*W)+C*(V*P-Y*F),K[8]=Z*(H*j-U*D)-C*(B*j-P*D)+O*(B*U-P*H),K[9]=-($*(H*j-U*D)-C*(J*j-Y*D)+O*(J*U-Y*H)),K[10]=$*(B*j-P*D)-Z*(J*j-Y*D)+O*(J*P-Y*B),K[11]=-($*(B*U-P*H)-Z*(J*U-Y*H)+C*(J*P-Y*B)),K[12]=-(Z*(H*X-W*D)-C*(B*X-F*D)+O*(B*W-F*H)),K[13]=$*(H*X-W*D)-C*(J*X-V*D)+O*(J*W-V*H),K[14]=-($*(B*X-F*D)-Z*(J*X-V*D)+O*(J*F-V*B)),K[15]=$*(B*W-F*H)-Z*(J*W-V*H)+C*(J*F-V*B),K}function gK(K){var Q=K[0],$=K[1],J=K[2],V=K[3],Y=K[4],Z=K[5],B=K[6],F=K[7],P=K[8],C=K[9],H=K[10],W=K[11],U=K[12],O=K[13],D=K[14],X=K[15],j=Q*Z-$*Y,G=Q*B-J*Y,N=Q*F-V*Y,R=$*B-J*Z,M=$*F-V*Z,E=J*F-V*B,w=P*O-C*U,h=P*D-H*U,I=P*X-W*U,S=C*D-H*O,v=C*X-W*O,p=H*X-W*D;return j*p-G*v+N*S+R*I-M*h+E*w}function c0(K,Q,$){var J=Q[0],V=Q[1],Y=Q[2],Z=Q[3],B=Q[4],F=Q[5],P=Q[6],C=Q[7],H=Q[8],W=Q[9],U=Q[10],O=Q[11],D=Q[12],X=Q[13],j=Q[14],G=Q[15],N=$[0],R=$[1],M=$[2],E=$[3];return K[0]=N*J+R*B+M*H+E*D,K[1]=N*V+R*F+M*W+E*X,K[2]=N*Y+R*P+M*U+E*j,K[3]=N*Z+R*C+M*O+E*G,N=$[4],R=$[5],M=$[6],E=$[7],K[4]=N*J+R*B+M*H+E*D,K[5]=N*V+R*F+M*W+E*X,K[6]=N*Y+R*P+M*U+E*j,K[7]=N*Z+R*C+M*O+E*G,N=$[8],R=$[9],M=$[10],E=$[11],K[8]=N*J+R*B+M*H+E*D,K[9]=N*V+R*F+M*W+E*X,K[10]=N*Y+R*P+M*U+E*j,K[11]=N*Z+R*C+M*O+E*G,N=$[12],R=$[13],M=$[14],E=$[15],K[12]=N*J+R*B+M*H+E*D,K[13]=N*V+R*F+M*W+E*X,K[14]=N*Y+R*P+M*U+E*j,K[15]=N*Z+R*C+M*O+E*G,K}function yK(K,Q,$){var J=$[0],V=$[1],Y=$[2],Z,B,F,P,C,H,W,U,O,D,X,j;if(Q===K)K[12]=Q[0]*J+Q[4]*V+Q[8]*Y+Q[12],K[13]=Q[1]*J+Q[5]*V+Q[9]*Y+Q[13],K[14]=Q[2]*J+Q[6]*V+Q[10]*Y+Q[14],K[15]=Q[3]*J+Q[7]*V+Q[11]*Y+Q[15];else Z=Q[0],B=Q[1],F=Q[2],P=Q[3],C=Q[4],H=Q[5],W=Q[6],U=Q[7],O=Q[8],D=Q[9],X=Q[10],j=Q[11],K[0]=Z,K[1]=B,K[2]=F,K[3]=P,K[4]=C,K[5]=H,K[6]=W,K[7]=U,K[8]=O,K[9]=D,K[10]=X,K[11]=j,K[12]=Z*J+C*V+O*Y+Q[12],K[13]=B*J+H*V+D*Y+Q[13],K[14]=F*J+W*V+X*Y+Q[14],K[15]=P*J+U*V+j*Y+Q[15];return K}function xK(K,Q,$){var J=$[0],V=$[1],Y=$[2];return K[0]=Q[0]*J,K[1]=Q[1]*J,K[2]=Q[2]*J,K[3]=Q[3]*J,K[4]=Q[4]*V,K[5]=Q[5]*V,K[6]=Q[6]*V,K[7]=Q[7]*V,K[8]=Q[8]*Y,K[9]=Q[9]*Y,K[10]=Q[10]*Y,K[11]=Q[11]*Y,K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function cK(K,Q,$,J){var V=J[0],Y=J[1],Z=J[2],B=Math.hypot(V,Y,Z),F,P,C,H,W,U,O,D,X,j,G,N,R,M,E,w,h,I,S,v,p,z,k,g;if(B<_)return null;if(B=1/B,V*=B,Y*=B,Z*=B,F=Math.sin($),P=Math.cos($),C=1-P,H=Q[0],W=Q[1],U=Q[2],O=Q[3],D=Q[4],X=Q[5],j=Q[6],G=Q[7],N=Q[8],R=Q[9],M=Q[10],E=Q[11],w=V*V*C+P,h=Y*V*C+Z*F,I=Z*V*C-Y*F,S=V*Y*C-Z*F,v=Y*Y*C+P,p=Z*Y*C+V*F,z=V*Z*C+Y*F,k=Y*Z*C-V*F,g=Z*Z*C+P,K[0]=H*w+D*h+N*I,K[1]=W*w+X*h+R*I,K[2]=U*w+j*h+M*I,K[3]=O*w+G*h+E*I,K[4]=H*S+D*v+N*p,K[5]=W*S+X*v+R*p,K[6]=U*S+j*v+M*p,K[7]=O*S+G*v+E*p,K[8]=H*z+D*k+N*g,K[9]=W*z+X*k+R*g,K[10]=U*z+j*k+M*g,K[11]=O*z+G*k+E*g,Q!==K)K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K}function mK(K,Q,$){var J=Math.sin($),V=Math.cos($),Y=Q[4],Z=Q[5],B=Q[6],F=Q[7],P=Q[8],C=Q[9],H=Q[10],W=Q[11];if(Q!==K)K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K[4]=Y*V+P*J,K[5]=Z*V+C*J,K[6]=B*V+H*J,K[7]=F*V+W*J,K[8]=P*V-Y*J,K[9]=C*V-Z*J,K[10]=H*V-B*J,K[11]=W*V-F*J,K}function dK(K,Q,$){var J=Math.sin($),V=Math.cos($),Y=Q[0],Z=Q[1],B=Q[2],F=Q[3],P=Q[8],C=Q[9],H=Q[10],W=Q[11];if(Q!==K)K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K[0]=Y*V-P*J,K[1]=Z*V-C*J,K[2]=B*V-H*J,K[3]=F*V-W*J,K[8]=Y*J+P*V,K[9]=Z*J+C*V,K[10]=B*J+H*V,K[11]=F*J+W*V,K}function lK(K,Q,$){var J=Math.sin($),V=Math.cos($),Y=Q[0],Z=Q[1],B=Q[2],F=Q[3],P=Q[4],C=Q[5],H=Q[6],W=Q[7];if(Q!==K)K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K[0]=Y*V+P*J,K[1]=Z*V+C*J,K[2]=B*V+H*J,K[3]=F*V+W*J,K[4]=P*V-Y*J,K[5]=C*V-Z*J,K[6]=H*V-B*J,K[7]=W*V-F*J,K}function iK(K,Q){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=Q[0],K[13]=Q[1],K[14]=Q[2],K[15]=1,K}function nK(K,Q){return K[0]=Q[0],K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=Q[1],K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=Q[2],K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function sK(K,Q,$){var J=$[0],V=$[1],Y=$[2],Z=Math.hypot(J,V,Y),B,F,P;if(Z<_)return null;return Z=1/Z,J*=Z,V*=Z,Y*=Z,B=Math.sin(Q),F=Math.cos(Q),P=1-F,K[0]=J*J*P+F,K[1]=V*J*P+Y*B,K[2]=Y*J*P-V*B,K[3]=0,K[4]=J*V*P-Y*B,K[5]=V*V*P+F,K[6]=Y*V*P+J*B,K[7]=0,K[8]=J*Y*P+V*B,K[9]=V*Y*P-J*B,K[10]=Y*Y*P+F,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function rK(K,Q){var $=Math.sin(Q),J=Math.cos(Q);return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=J,K[6]=$,K[7]=0,K[8]=0,K[9]=-$,K[10]=J,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function bK(K,Q){var $=Math.sin(Q),J=Math.cos(Q);return K[0]=J,K[1]=0,K[2]=-$,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=$,K[9]=0,K[10]=J,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function eK(K,Q){var $=Math.sin(Q),J=Math.cos(Q);return K[0]=J,K[1]=$,K[2]=0,K[3]=0,K[4]=-$,K[5]=J,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function m0(K,Q,$){var J=Q[0],V=Q[1],Y=Q[2],Z=Q[3],B=J+J,F=V+V,P=Y+Y,C=J*B,H=J*F,W=J*P,U=V*F,O=V*P,D=Y*P,X=Z*B,j=Z*F,G=Z*P;return K[0]=1-(U+D),K[1]=H+G,K[2]=W-j,K[3]=0,K[4]=H-G,K[5]=1-(C+D),K[6]=O+X,K[7]=0,K[8]=W+j,K[9]=O-X,K[10]=1-(C+U),K[11]=0,K[12]=$[0],K[13]=$[1],K[14]=$[2],K[15]=1,K}function uK(K,Q){var $=new L(3),J=-Q[0],V=-Q[1],Y=-Q[2],Z=Q[3],B=Q[4],F=Q[5],P=Q[6],C=Q[7],H=J*J+V*V+Y*Y+Z*Z;if(H>0)$[0]=(B*Z+C*J+F*Y-P*V)*2/H,$[1]=(F*Z+C*V+P*J-B*Y)*2/H,$[2]=(P*Z+C*Y+B*V-F*J)*2/H;else $[0]=(B*Z+C*J+F*Y-P*V)*2,$[1]=(F*Z+C*V+P*J-B*Y)*2,$[2]=(P*Z+C*Y+B*V-F*J)*2;return m0(K,Q,$),K}function oK(K,Q){return K[0]=Q[12],K[1]=Q[13],K[2]=Q[14],K}function d0(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[4],Z=Q[5],B=Q[6],F=Q[8],P=Q[9],C=Q[10];return K[0]=Math.hypot($,J,V),K[1]=Math.hypot(Y,Z,B),K[2]=Math.hypot(F,P,C),K}function aK(K,Q){var $=new L(3);d0($,Q);var J=1/$[0],V=1/$[1],Y=1/$[2],Z=Q[0]*J,B=Q[1]*V,F=Q[2]*Y,P=Q[4]*J,C=Q[5]*V,H=Q[6]*Y,W=Q[8]*J,U=Q[9]*V,O=Q[10]*Y,D=Z+C+O,X=0;if(D>0)X=Math.sqrt(D+1)*2,K[3]=0.25*X,K[0]=(H-U)/X,K[1]=(W-F)/X,K[2]=(B-P)/X;else if(Z>C&&Z>O)X=Math.sqrt(1+Z-C-O)*2,K[3]=(H-U)/X,K[0]=0.25*X,K[1]=(B+P)/X,K[2]=(W+F)/X;else if(C>O)X=Math.sqrt(1+C-Z-O)*2,K[3]=(W-F)/X,K[0]=(B+P)/X,K[1]=0.25*X,K[2]=(H+U)/X;else X=Math.sqrt(1+O-Z-C)*2,K[3]=(B-P)/X,K[0]=(W+F)/X,K[1]=(H+U)/X,K[2]=0.25*X;return K}function tK(K,Q,$,J){var V=Q[0],Y=Q[1],Z=Q[2],B=Q[3],F=V+V,P=Y+Y,C=Z+Z,H=V*F,W=V*P,U=V*C,O=Y*P,D=Y*C,X=Z*C,j=B*F,G=B*P,N=B*C,R=J[0],M=J[1],E=J[2];return K[0]=(1-(O+X))*R,K[1]=(W+N)*R,K[2]=(U-G)*R,K[3]=0,K[4]=(W-N)*M,K[5]=(1-(H+X))*M,K[6]=(D+j)*M,K[7]=0,K[8]=(U+G)*E,K[9]=(D-j)*E,K[10]=(1-(H+O))*E,K[11]=0,K[12]=$[0],K[13]=$[1],K[14]=$[2],K[15]=1,K}function KQ(K,Q,$,J,V){var Y=Q[0],Z=Q[1],B=Q[2],F=Q[3],P=Y+Y,C=Z+Z,H=B+B,W=Y*P,U=Y*C,O=Y*H,D=Z*C,X=Z*H,j=B*H,G=F*P,N=F*C,R=F*H,M=J[0],E=J[1],w=J[2],h=V[0],I=V[1],S=V[2],v=(1-(D+j))*M,p=(U+R)*M,z=(O-N)*M,k=(U-R)*E,g=(1-(W+j))*E,l=(X+G)*E,i=(O+N)*w,T0=(X-G)*w,h0=(1-(W+D))*w;return K[0]=v,K[1]=p,K[2]=z,K[3]=0,K[4]=k,K[5]=g,K[6]=l,K[7]=0,K[8]=i,K[9]=T0,K[10]=h0,K[11]=0,K[12]=$[0]+h-(v*h+k*I+i*S),K[13]=$[1]+I-(p*h+g*I+T0*S),K[14]=$[2]+S-(z*h+l*I+h0*S),K[15]=1,K}function QQ(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=$+$,B=J+J,F=V+V,P=$*Z,C=J*Z,H=J*B,W=V*Z,U=V*B,O=V*F,D=Y*Z,X=Y*B,j=Y*F;return K[0]=1-H-O,K[1]=C+j,K[2]=W-X,K[3]=0,K[4]=C-j,K[5]=1-P-O,K[6]=U+D,K[7]=0,K[8]=W+X,K[9]=U-D,K[10]=1-P-H,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function $Q(K,Q,$,J,V,Y,Z){var B=1/($-Q),F=1/(V-J),P=1/(Y-Z);return K[0]=Y*2*B,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=Y*2*F,K[6]=0,K[7]=0,K[8]=($+Q)*B,K[9]=(V+J)*F,K[10]=(Z+Y)*P,K[11]=-1,K[12]=0,K[13]=0,K[14]=Z*Y*2*P,K[15]=0,K}function l0(K,Q,$,J,V){var Y=1/Math.tan(Q/2),Z;if(K[0]=Y/$,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=Y,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[11]=-1,K[12]=0,K[13]=0,K[15]=0,V!=null&&V!==Infinity)Z=1/(J-V),K[10]=(V+J)*Z,K[14]=2*V*J*Z;else K[10]=-1,K[14]=-2*J;return K}function VQ(K,Q,$,J,V){var Y=1/Math.tan(Q/2),Z;if(K[0]=Y/$,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=Y,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[11]=-1,K[12]=0,K[13]=0,K[15]=0,V!=null&&V!==Infinity)Z=1/(J-V),K[10]=V*Z,K[14]=V*J*Z;else K[10]=-1,K[14]=-J;return K}function YQ(K,Q,$,J){var V=Math.tan(Q.upDegrees*Math.PI/180),Y=Math.tan(Q.downDegrees*Math.PI/180),Z=Math.tan(Q.leftDegrees*Math.PI/180),B=Math.tan(Q.rightDegrees*Math.PI/180),F=2/(Z+B),P=2/(V+Y);return K[0]=F,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=P,K[6]=0,K[7]=0,K[8]=-((Z-B)*F*0.5),K[9]=(V-Y)*P*0.5,K[10]=J/($-J),K[11]=-1,K[12]=0,K[13]=0,K[14]=J*$/($-J),K[15]=0,K}function i0(K,Q,$,J,V,Y,Z){var B=1/(Q-$),F=1/(J-V),P=1/(Y-Z);return K[0]=-2*B,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=-2*F,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=2*P,K[11]=0,K[12]=(Q+$)*B,K[13]=(V+J)*F,K[14]=(Z+Y)*P,K[15]=1,K}function ZQ(K,Q,$,J,V,Y,Z){var B=1/(Q-$),F=1/(J-V),P=1/(Y-Z);return K[0]=-2*B,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=-2*F,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=P,K[11]=0,K[12]=(Q+$)*B,K[13]=(V+J)*F,K[14]=Y*P,K[15]=1,K}function FQ(K,Q,$,J){var V,Y,Z,B,F,P,C,H,W,U,O=Q[0],D=Q[1],X=Q[2],j=J[0],G=J[1],N=J[2],R=$[0],M=$[1],E=$[2];if(Math.abs(O-R)<_&&Math.abs(D-M)<_&&Math.abs(X-E)<_)return x0(K);if(C=O-R,H=D-M,W=X-E,U=1/Math.hypot(C,H,W),C*=U,H*=U,W*=U,V=G*W-N*H,Y=N*C-j*W,Z=j*H-G*C,U=Math.hypot(V,Y,Z),!U)V=0,Y=0,Z=0;else U=1/U,V*=U,Y*=U,Z*=U;if(B=H*Z-W*Y,F=W*V-C*Z,P=C*Y-H*V,U=Math.hypot(B,F,P),!U)B=0,F=0,P=0;else U=1/U,B*=U,F*=U,P*=U;return K[0]=V,K[1]=B,K[2]=C,K[3]=0,K[4]=Y,K[5]=F,K[6]=H,K[7]=0,K[8]=Z,K[9]=P,K[10]=W,K[11]=0,K[12]=-(V*O+Y*D+Z*X),K[13]=-(B*O+F*D+P*X),K[14]=-(C*O+H*D+W*X),K[15]=1,K}function PQ(K,Q,$,J){var V=Q[0],Y=Q[1],Z=Q[2],B=J[0],F=J[1],P=J[2],C=V-$[0],H=Y-$[1],W=Z-$[2],U=C*C+H*H+W*W;if(U>0)U=1/Math.sqrt(U),C*=U,H*=U,W*=U;var O=F*W-P*H,D=P*C-B*W,X=B*H-F*C;if(U=O*O+D*D+X*X,U>0)U=1/Math.sqrt(U),O*=U,D*=U,X*=U;return K[0]=O,K[1]=D,K[2]=X,K[3]=0,K[4]=H*X-W*D,K[5]=W*O-C*X,K[6]=C*D-H*O,K[7]=0,K[8]=C,K[9]=H,K[10]=W,K[11]=0,K[12]=V,K[13]=Y,K[14]=Z,K[15]=1,K}function CQ(K){return"mat4("+K[0]+", "+K[1]+", "+K[2]+", "+K[3]+", "+K[4]+", "+K[5]+", "+K[6]+", "+K[7]+", "+K[8]+", "+K[9]+", "+K[10]+", "+K[11]+", "+K[12]+", "+K[13]+", "+K[14]+", "+K[15]+")"}function HQ(K){return Math.hypot(K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],K[8],K[9],K[10],K[11],K[12],K[13],K[14],K[15])}function XQ(K,Q,$){return K[0]=Q[0]+$[0],K[1]=Q[1]+$[1],K[2]=Q[2]+$[2],K[3]=Q[3]+$[3],K[4]=Q[4]+$[4],K[5]=Q[5]+$[5],K[6]=Q[6]+$[6],K[7]=Q[7]+$[7],K[8]=Q[8]+$[8],K[9]=Q[9]+$[9],K[10]=Q[10]+$[10],K[11]=Q[11]+$[11],K[12]=Q[12]+$[12],K[13]=Q[13]+$[13],K[14]=Q[14]+$[14],K[15]=Q[15]+$[15],K}function n0(K,Q,$){return K[0]=Q[0]-$[0],K[1]=Q[1]-$[1],K[2]=Q[2]-$[2],K[3]=Q[3]-$[3],K[4]=Q[4]-$[4],K[5]=Q[5]-$[5],K[6]=Q[6]-$[6],K[7]=Q[7]-$[7],K[8]=Q[8]-$[8],K[9]=Q[9]-$[9],K[10]=Q[10]-$[10],K[11]=Q[11]-$[11],K[12]=Q[12]-$[12],K[13]=Q[13]-$[13],K[14]=Q[14]-$[14],K[15]=Q[15]-$[15],K}function UQ(K,Q,$){return K[0]=Q[0]*$,K[1]=Q[1]*$,K[2]=Q[2]*$,K[3]=Q[3]*$,K[4]=Q[4]*$,K[5]=Q[5]*$,K[6]=Q[6]*$,K[7]=Q[7]*$,K[8]=Q[8]*$,K[9]=Q[9]*$,K[10]=Q[10]*$,K[11]=Q[11]*$,K[12]=Q[12]*$,K[13]=Q[13]*$,K[14]=Q[14]*$,K[15]=Q[15]*$,K}function WQ(K,Q,$,J){return K[0]=Q[0]+$[0]*J,K[1]=Q[1]+$[1]*J,K[2]=Q[2]+$[2]*J,K[3]=Q[3]+$[3]*J,K[4]=Q[4]+$[4]*J,K[5]=Q[5]+$[5]*J,K[6]=Q[6]+$[6]*J,K[7]=Q[7]+$[7]*J,K[8]=Q[8]+$[8]*J,K[9]=Q[9]+$[9]*J,K[10]=Q[10]+$[10]*J,K[11]=Q[11]+$[11]*J,K[12]=Q[12]+$[12]*J,K[13]=Q[13]+$[13]*J,K[14]=Q[14]+$[14]*J,K[15]=Q[15]+$[15]*J,K}function DQ(K,Q){return K[0]===Q[0]&&K[1]===Q[1]&&K[2]===Q[2]&&K[3]===Q[3]&&K[4]===Q[4]&&K[5]===Q[5]&&K[6]===Q[6]&&K[7]===Q[7]&&K[8]===Q[8]&&K[9]===Q[9]&&K[10]===Q[10]&&K[11]===Q[11]&&K[12]===Q[12]&&K[13]===Q[13]&&K[14]===Q[14]&&K[15]===Q[15]}function OQ(K,Q){var $=K[0],J=K[1],V=K[2],Y=K[3],Z=K[4],B=K[5],F=K[6],P=K[7],C=K[8],H=K[9],W=K[10],U=K[11],O=K[12],D=K[13],X=K[14],j=K[15],G=Q[0],N=Q[1],R=Q[2],M=Q[3],E=Q[4],w=Q[5],h=Q[6],I=Q[7],S=Q[8],v=Q[9],p=Q[10],z=Q[11],k=Q[12],g=Q[13],l=Q[14],i=Q[15];return Math.abs($-G)<=_*Math.max(1,Math.abs($),Math.abs(G))&&Math.abs(J-N)<=_*Math.max(1,Math.abs(J),Math.abs(N))&&Math.abs(V-R)<=_*Math.max(1,Math.abs(V),Math.abs(R))&&Math.abs(Y-M)<=_*Math.max(1,Math.abs(Y),Math.abs(M))&&Math.abs(Z-E)<=_*Math.max(1,Math.abs(Z),Math.abs(E))&&Math.abs(B-w)<=_*Math.max(1,Math.abs(B),Math.abs(w))&&Math.abs(F-h)<=_*Math.max(1,Math.abs(F),Math.abs(h))&&Math.abs(P-I)<=_*Math.max(1,Math.abs(P),Math.abs(I))&&Math.abs(C-S)<=_*Math.max(1,Math.abs(C),Math.abs(S))&&Math.abs(H-v)<=_*Math.max(1,Math.abs(H),Math.abs(v))&&Math.abs(W-p)<=_*Math.max(1,Math.abs(W),Math.abs(p))&&Math.abs(U-z)<=_*Math.max(1,Math.abs(U),Math.abs(z))&&Math.abs(O-k)<=_*Math.max(1,Math.abs(O),Math.abs(k))&&Math.abs(D-g)<=_*Math.max(1,Math.abs(D),Math.abs(g))&&Math.abs(X-l)<=_*Math.max(1,Math.abs(X),Math.abs(l))&&Math.abs(j-i)<=_*Math.max(1,Math.abs(j),Math.abs(i))}var JQ=l0,BQ=i0,jQ=c0,AQ=n0;var r={};F0(r,{str:()=>{{return W$}},squaredLength:()=>{{return EK}},sqrLen:()=>{{return _$}},sqlerp:()=>{{return L$}},slerp:()=>{{return t}},setAxisAngle:()=>{{return XK}},setAxes:()=>{{return T$}},set:()=>{{return A$}},scale:()=>{{return jK}},rotationTo:()=>{{return q$}},rotateZ:()=>{{return Z$}},rotateY:()=>{{return B$}},rotateX:()=>{{return Y$}},random:()=>{{return C$}},pow:()=>{{return P$}},normalize:()=>{{return R0}},multiply:()=>{{return UK}},mul:()=>{{return E$}},ln:()=>{{return DK}},lerp:()=>{{return R$}},length:()=>{{return MK}},len:()=>{{return N$}},invert:()=>{{return H$}},identity:()=>{{return $$}},getAxisAngle:()=>{{return J$}},getAngle:()=>{{return V$}},fromValues:()=>{{return O$}},fromMat3:()=>{{return OK}},fromEuler:()=>{{return U$}},exp:()=>{{return WK}},exactEquals:()=>{{return G$}},equals:()=>{{return k$}},dot:()=>{{return AK}},create:()=>{{return E0}},copy:()=>{{return j$}},conjugate:()=>{{return X$}},clone:()=>{{return D$}},calculateW:()=>{{return F$}},add:()=>{{return M$}}});var m={};F0(m,{zero:()=>{{return lQ}},transformQuat:()=>{{return yQ}},transformMat4:()=>{{return zQ}},transformMat3:()=>{{return gQ}},subtract:()=>{{return r0}},sub:()=>{{return rQ}},str:()=>{{return iQ}},squaredLength:()=>{{return a0}},squaredDistance:()=>{{return o0}},sqrLen:()=>{{return aQ}},sqrDist:()=>{{return oQ}},set:()=>{{return RQ}},scaleAndAdd:()=>{{return hQ}},scale:()=>{{return TQ}},round:()=>{{return LQ}},rotateZ:()=>{{return mQ}},rotateY:()=>{{return cQ}},rotateX:()=>{{return xQ}},random:()=>{{return fQ}},normalize:()=>{{return A0}},negate:()=>{{return IQ}},multiply:()=>{{return b0}},mul:()=>{{return bQ}},min:()=>{{return kQ}},max:()=>{{return qQ}},lerp:()=>{{return wQ}},length:()=>{{return s0}},len:()=>{{return M0}},inverse:()=>{{return SQ}},hermite:()=>{{return vQ}},fromValues:()=>{{return o}},forEach:()=>{{return tQ}},floor:()=>{{return GQ}},exactEquals:()=>{{return nQ}},equals:()=>{{return sQ}},dot:()=>{{return a}},divide:()=>{{return e0}},div:()=>{{return eQ}},distance:()=>{{return u0}},dist:()=>{{return uQ}},cross:()=>{{return s}},create:()=>{{return u}},copy:()=>{{return EQ}},clone:()=>{{return MQ}},ceil:()=>{{return _Q}},bezier:()=>{{return pQ}},angle:()=>{{return dQ}},add:()=>{{return NQ}}});function u(){var K=new L(3);if(L!=Float32Array)K[0]=0,K[1]=0,K[2]=0;return K}function MQ(K){var Q=new L(3);return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q}function s0(K){var Q=K[0],$=K[1],J=K[2];return Math.hypot(Q,$,J)}function o(K,Q,$){var J=new L(3);return J[0]=K,J[1]=Q,J[2]=$,J}function EQ(K,Q){return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K}function RQ(K,Q,$,J){return K[0]=Q,K[1]=$,K[2]=J,K}function NQ(K,Q,$){return K[0]=Q[0]+$[0],K[1]=Q[1]+$[1],K[2]=Q[2]+$[2],K}function r0(K,Q,$){return K[0]=Q[0]-$[0],K[1]=Q[1]-$[1],K[2]=Q[2]-$[2],K}function b0(K,Q,$){return K[0]=Q[0]*$[0],K[1]=Q[1]*$[1],K[2]=Q[2]*$[2],K}function e0(K,Q,$){return K[0]=Q[0]/$[0],K[1]=Q[1]/$[1],K[2]=Q[2]/$[2],K}function _Q(K,Q){return K[0]=Math.ceil(Q[0]),K[1]=Math.ceil(Q[1]),K[2]=Math.ceil(Q[2]),K}function GQ(K,Q){return K[0]=Math.floor(Q[0]),K[1]=Math.floor(Q[1]),K[2]=Math.floor(Q[2]),K}function kQ(K,Q,$){return K[0]=Math.min(Q[0],$[0]),K[1]=Math.min(Q[1],$[1]),K[2]=Math.min(Q[2],$[2]),K}function qQ(K,Q,$){return K[0]=Math.max(Q[0],$[0]),K[1]=Math.max(Q[1],$[1]),K[2]=Math.max(Q[2],$[2]),K}function LQ(K,Q){return K[0]=Math.round(Q[0]),K[1]=Math.round(Q[1]),K[2]=Math.round(Q[2]),K}function TQ(K,Q,$){return K[0]=Q[0]*$,K[1]=Q[1]*$,K[2]=Q[2]*$,K}function hQ(K,Q,$,J){return K[0]=Q[0]+$[0]*J,K[1]=Q[1]+$[1]*J,K[2]=Q[2]+$[2]*J,K}function u0(K,Q){var $=Q[0]-K[0],J=Q[1]-K[1],V=Q[2]-K[2];return Math.hypot($,J,V)}function o0(K,Q){var $=Q[0]-K[0],J=Q[1]-K[1],V=Q[2]-K[2];return $*$+J*J+V*V}function a0(K){var Q=K[0],$=K[1],J=K[2];return Q*Q+$*$+J*J}function IQ(K,Q){return K[0]=-Q[0],K[1]=-Q[1],K[2]=-Q[2],K}function SQ(K,Q){return K[0]=1/Q[0],K[1]=1/Q[1],K[2]=1/Q[2],K}function A0(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=$*$+J*J+V*V;if(Y>0)Y=1/Math.sqrt(Y);return K[0]=Q[0]*Y,K[1]=Q[1]*Y,K[2]=Q[2]*Y,K}function a(K,Q){return K[0]*Q[0]+K[1]*Q[1]+K[2]*Q[2]}function s(K,Q,$){var J=Q[0],V=Q[1],Y=Q[2],Z=$[0],B=$[1],F=$[2];return K[0]=V*F-Y*B,K[1]=Y*Z-J*F,K[2]=J*B-V*Z,K}function wQ(K,Q,$,J){var V=Q[0],Y=Q[1],Z=Q[2];return K[0]=V+J*($[0]-V),K[1]=Y+J*($[1]-Y),K[2]=Z+J*($[2]-Z),K}function vQ(K,Q,$,J,V,Y){var Z=Y*Y,B=Z*(2*Y-3)+1,F=Z*(Y-2)+Y,P=Z*(Y-1),C=Z*(3-2*Y);return K[0]=Q[0]*B+$[0]*F+J[0]*P+V[0]*C,K[1]=Q[1]*B+$[1]*F+J[1]*P+V[1]*C,K[2]=Q[2]*B+$[2]*F+J[2]*P+V[2]*C,K}function pQ(K,Q,$,J,V,Y){var Z=1-Y,B=Z*Z,F=Y*Y,P=B*Z,C=3*Y*B,H=3*F*Z,W=F*Y;return K[0]=Q[0]*P+$[0]*C+J[0]*H+V[0]*W,K[1]=Q[1]*P+$[1]*C+J[1]*H+V[1]*W,K[2]=Q[2]*P+$[2]*C+J[2]*H+V[2]*W,K}function fQ(K,Q){Q=Q||1;var $=c()*2*Math.PI,J=c()*2-1,V=Math.sqrt(1-J*J)*Q;return K[0]=Math.cos($)*V,K[1]=Math.sin($)*V,K[2]=J*Q,K}function zQ(K,Q,$){var J=Q[0],V=Q[1],Y=Q[2],Z=$[3]*J+$[7]*V+$[11]*Y+$[15];return Z=Z||1,K[0]=($[0]*J+$[4]*V+$[8]*Y+$[12])/Z,K[1]=($[1]*J+$[5]*V+$[9]*Y+$[13])/Z,K[2]=($[2]*J+$[6]*V+$[10]*Y+$[14])/Z,K}function gQ(K,Q,$){var J=Q[0],V=Q[1],Y=Q[2];return K[0]=J*$[0]+V*$[3]+Y*$[6],K[1]=J*$[1]+V*$[4]+Y*$[7],K[2]=J*$[2]+V*$[5]+Y*$[8],K}function yQ(K,Q,$){var J=$[0],V=$[1],Y=$[2],Z=$[3],B=Q[0],F=Q[1],P=Q[2],C=V*P-Y*F,H=Y*B-J*P,W=J*F-V*B,U=V*W-Y*H,O=Y*C-J*W,D=J*H-V*C,X=Z*2;return C*=X,H*=X,W*=X,U*=2,O*=2,D*=2,K[0]=B+C+U,K[1]=F+H+O,K[2]=P+W+D,K}function xQ(K,Q,$,J){var V=[],Y=[];return V[0]=Q[0]-$[0],V[1]=Q[1]-$[1],V[2]=Q[2]-$[2],Y[0]=V[0],Y[1]=V[1]*Math.cos(J)-V[2]*Math.sin(J),Y[2]=V[1]*Math.sin(J)+V[2]*Math.cos(J),K[0]=Y[0]+$[0],K[1]=Y[1]+$[1],K[2]=Y[2]+$[2],K}function cQ(K,Q,$,J){var V=[],Y=[];return V[0]=Q[0]-$[0],V[1]=Q[1]-$[1],V[2]=Q[2]-$[2],Y[0]=V[2]*Math.sin(J)+V[0]*Math.cos(J),Y[1]=V[1],Y[2]=V[2]*Math.cos(J)-V[0]*Math.sin(J),K[0]=Y[0]+$[0],K[1]=Y[1]+$[1],K[2]=Y[2]+$[2],K}function mQ(K,Q,$,J){var V=[],Y=[];return V[0]=Q[0]-$[0],V[1]=Q[1]-$[1],V[2]=Q[2]-$[2],Y[0]=V[0]*Math.cos(J)-V[1]*Math.sin(J),Y[1]=V[0]*Math.sin(J)+V[1]*Math.cos(J),Y[2]=V[2],K[0]=Y[0]+$[0],K[1]=Y[1]+$[1],K[2]=Y[2]+$[2],K}function dQ(K,Q){var $=K[0],J=K[1],V=K[2],Y=Q[0],Z=Q[1],B=Q[2],F=Math.sqrt($*$+J*J+V*V),P=Math.sqrt(Y*Y+Z*Z+B*B),C=F*P,H=C&&a(K,Q)/C;return Math.acos(Math.min(Math.max(H,-1),1))}function lQ(K){return K[0]=0,K[1]=0,K[2]=0,K}function iQ(K){return"vec3("+K[0]+", "+K[1]+", "+K[2]+")"}function nQ(K,Q){return K[0]===Q[0]&&K[1]===Q[1]&&K[2]===Q[2]}function sQ(K,Q){var $=K[0],J=K[1],V=K[2],Y=Q[0],Z=Q[1],B=Q[2];return Math.abs($-Y)<=_*Math.max(1,Math.abs($),Math.abs(Y))&&Math.abs(J-Z)<=_*Math.max(1,Math.abs(J),Math.abs(Z))&&Math.abs(V-B)<=_*Math.max(1,Math.abs(V),Math.abs(B))}var rQ=r0,bQ=b0,eQ=e0,uQ=u0,oQ=o0,M0=s0,aQ=a0,tQ=function(){var K=u();return function(Q,$,J,V,Y,Z){var B,F;if(!$)$=3;if(!J)J=0;if(V)F=Math.min(V*$+J,Q.length);else F=Q.length;for(B=J;B<F;B+=$)K[0]=Q[B],K[1]=Q[B+1],K[2]=Q[B+2],Y(K,K,Z),Q[B]=K[0],Q[B+1]=K[1],Q[B+2]=K[2];return Q}}();function K$(){var K=new L(4);if(L!=Float32Array)K[0]=0,K[1]=0,K[2]=0,K[3]=0;return K}function t0(K){var Q=new L(4);return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q}function KK(K,Q,$,J){var V=new L(4);return V[0]=K,V[1]=Q,V[2]=$,V[3]=J,V}function QK(K,Q){return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K}function $K(K,Q,$,J,V){return K[0]=Q,K[1]=$,K[2]=J,K[3]=V,K}function JK(K,Q,$){return K[0]=Q[0]+$[0],K[1]=Q[1]+$[1],K[2]=Q[2]+$[2],K[3]=Q[3]+$[3],K}function VK(K,Q,$){return K[0]=Q[0]*$,K[1]=Q[1]*$,K[2]=Q[2]*$,K[3]=Q[3]*$,K}function YK(K){var Q=K[0],$=K[1],J=K[2],V=K[3];return Math.hypot(Q,$,J,V)}function BK(K){var Q=K[0],$=K[1],J=K[2],V=K[3];return Q*Q+$*$+J*J+V*V}function ZK(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=$*$+J*J+V*V+Y*Y;if(Z>0)Z=1/Math.sqrt(Z);return K[0]=$*Z,K[1]=J*Z,K[2]=V*Z,K[3]=Y*Z,K}function FK(K,Q){return K[0]*Q[0]+K[1]*Q[1]+K[2]*Q[2]+K[3]*Q[3]}function PK(K,Q,$,J){var V=Q[0],Y=Q[1],Z=Q[2],B=Q[3];return K[0]=V+J*($[0]-V),K[1]=Y+J*($[1]-Y),K[2]=Z+J*($[2]-Z),K[3]=B+J*($[3]-B),K}function CK(K,Q){return K[0]===Q[0]&&K[1]===Q[1]&&K[2]===Q[2]&&K[3]===Q[3]}function HK(K,Q){var $=K[0],J=K[1],V=K[2],Y=K[3],Z=Q[0],B=Q[1],F=Q[2],P=Q[3];return Math.abs($-Z)<=_*Math.max(1,Math.abs($),Math.abs(Z))&&Math.abs(J-B)<=_*Math.max(1,Math.abs(J),Math.abs(B))&&Math.abs(V-F)<=_*Math.max(1,Math.abs(V),Math.abs(F))&&Math.abs(Y-P)<=_*Math.max(1,Math.abs(Y),Math.abs(P))}var PJ=function(){var K=K$();return function(Q,$,J,V,Y,Z){var B,F;if(!$)$=4;if(!J)J=0;if(V)F=Math.min(V*$+J,Q.length);else F=Q.length;for(B=J;B<F;B+=$)K[0]=Q[B],K[1]=Q[B+1],K[2]=Q[B+2],K[3]=Q[B+3],Y(K,K,Z),Q[B]=K[0],Q[B+1]=K[1],Q[B+2]=K[2],Q[B+3]=K[3];return Q}}();function E0(){var K=new L(4);if(L!=Float32Array)K[0]=0,K[1]=0,K[2]=0;return K[3]=1,K}function $$(K){return K[0]=0,K[1]=0,K[2]=0,K[3]=1,K}function XK(K,Q,$){$=$*0.5;var J=Math.sin($);return K[0]=J*Q[0],K[1]=J*Q[1],K[2]=J*Q[2],K[3]=Math.cos($),K}function J$(K,Q){var $=Math.acos(Q[3])*2,J=Math.sin($/2);if(J>_)K[0]=Q[0]/J,K[1]=Q[1]/J,K[2]=Q[2]/J;else K[0]=1,K[1]=0,K[2]=0;return $}function V$(K,Q){var $=AK(K,Q);return Math.acos(2*$*$-1)}function UK(K,Q,$){var J=Q[0],V=Q[1],Y=Q[2],Z=Q[3],B=$[0],F=$[1],P=$[2],C=$[3];return K[0]=J*C+Z*B+V*P-Y*F,K[1]=V*C+Z*F+Y*B-J*P,K[2]=Y*C+Z*P+J*F-V*B,K[3]=Z*C-J*B-V*F-Y*P,K}function Y$(K,Q,$){$*=0.5;var J=Q[0],V=Q[1],Y=Q[2],Z=Q[3],B=Math.sin($),F=Math.cos($);return K[0]=J*F+Z*B,K[1]=V*F+Y*B,K[2]=Y*F-V*B,K[3]=Z*F-J*B,K}function B$(K,Q,$){$*=0.5;var J=Q[0],V=Q[1],Y=Q[2],Z=Q[3],B=Math.sin($),F=Math.cos($);return K[0]=J*F-Y*B,K[1]=V*F+Z*B,K[2]=Y*F+J*B,K[3]=Z*F-V*B,K}function Z$(K,Q,$){$*=0.5;var J=Q[0],V=Q[1],Y=Q[2],Z=Q[3],B=Math.sin($),F=Math.cos($);return K[0]=J*F+V*B,K[1]=V*F-J*B,K[2]=Y*F+Z*B,K[3]=Z*F-Y*B,K}function F$(K,Q){var $=Q[0],J=Q[1],V=Q[2];return K[0]=$,K[1]=J,K[2]=V,K[3]=Math.sqrt(Math.abs(1-$*$-J*J-V*V)),K}function WK(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=Math.sqrt($*$+J*J+V*V),B=Math.exp(Y),F=Z>0?B*Math.sin(Z)/Z:0;return K[0]=$*F,K[1]=J*F,K[2]=V*F,K[3]=B*Math.cos(Z),K}function DK(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=Math.sqrt($*$+J*J+V*V),B=Z>0?Math.atan2(Z,Y)/Z:0;return K[0]=$*B,K[1]=J*B,K[2]=V*B,K[3]=0.5*Math.log($*$+J*J+V*V+Y*Y),K}function P$(K,Q,$){return DK(K,Q),jK(K,K,$),WK(K,K),K}function t(K,Q,$,J){var V=Q[0],Y=Q[1],Z=Q[2],B=Q[3],F=$[0],P=$[1],C=$[2],H=$[3],W,U,O,D,X;if(U=V*F+Y*P+Z*C+B*H,U<0)U=-U,F=-F,P=-P,C=-C,H=-H;if(1-U>_)W=Math.acos(U),O=Math.sin(W),D=Math.sin((1-J)*W)/O,X=Math.sin(J*W)/O;else D=1-J,X=J;return K[0]=D*V+X*F,K[1]=D*Y+X*P,K[2]=D*Z+X*C,K[3]=D*B+X*H,K}function C$(K){var Q=c(),$=c(),J=c(),V=Math.sqrt(1-Q),Y=Math.sqrt(Q);return K[0]=V*Math.sin(2*Math.PI*$),K[1]=V*Math.cos(2*Math.PI*$),K[2]=Y*Math.sin(2*Math.PI*J),K[3]=Y*Math.cos(2*Math.PI*J),K}function H$(K,Q){var $=Q[0],J=Q[1],V=Q[2],Y=Q[3],Z=$*$+J*J+V*V+Y*Y,B=Z?1/Z:0;return K[0]=-$*B,K[1]=-J*B,K[2]=-V*B,K[3]=Y*B,K}function X$(K,Q){return K[0]=-Q[0],K[1]=-Q[1],K[2]=-Q[2],K[3]=Q[3],K}function OK(K,Q){var $=Q[0]+Q[4]+Q[8],J;if($>0)J=Math.sqrt($+1),K[3]=0.5*J,J=0.5/J,K[0]=(Q[5]-Q[7])*J,K[1]=(Q[6]-Q[2])*J,K[2]=(Q[1]-Q[3])*J;else{var V=0;if(Q[4]>Q[0])V=1;if(Q[8]>Q[V*3+V])V=2;var Y=(V+1)%3,Z=(V+2)%3;J=Math.sqrt(Q[V*3+V]-Q[Y*3+Y]-Q[Z*3+Z]+1),K[V]=0.5*J,J=0.5/J,K[3]=(Q[Y*3+Z]-Q[Z*3+Y])*J,K[Y]=(Q[Y*3+V]+Q[V*3+Y])*J,K[Z]=(Q[Z*3+V]+Q[V*3+Z])*J}return K}function U$(K,Q,$,J){var V=0.5*Math.PI/180;Q*=V,$*=V,J*=V;var Y=Math.sin(Q),Z=Math.cos(Q),B=Math.sin($),F=Math.cos($),P=Math.sin(J),C=Math.cos(J);return K[0]=Y*F*C-Z*B*P,K[1]=Z*B*C+Y*F*P,K[2]=Z*F*P-Y*B*C,K[3]=Z*F*C+Y*B*P,K}function W$(K){return"quat("+K[0]+", "+K[1]+", "+K[2]+", "+K[3]+")"}var D$=t0,O$=KK,j$=QK,A$=$K,M$=JK,E$=UK,jK=VK,AK=FK,R$=PK,MK=YK,N$=MK,EK=BK,_$=EK,R0=ZK,G$=CK,k$=HK,q$=function(){var K=u(),Q=o(1,0,0),$=o(0,1,0);return function(J,V,Y){var Z=a(V,Y);if(Z<-0.999999){if(s(K,Q,V),M0(K)<0.000001)s(K,$,V);return A0(K,K),XK(J,K,Math.PI),J}else if(Z>0.999999)return J[0]=0,J[1]=0,J[2]=0,J[3]=1,J;else return s(K,V,Y),J[0]=K[0],J[1]=K[1],J[2]=K[2],J[3]=1+Z,R0(J,J)}}(),L$=function(){var K=E0(),Q=E0();return function($,J,V,Y,Z,B){return t(K,J,Z,B),t(Q,V,Y,B),t($,K,Q,2*B*(1-B)),$}}(),T$=function(){var K=y0();return function(Q,$,J,V){return K[0]=J[0],K[3]=J[1],K[6]=J[2],K[1]=V[0],K[4]=V[1],K[7]=V[2],K[2]=-$[0],K[5]=-$[1],K[8]=-$[2],R0(Q,OK(Q,K))}}();var h$=Math.PI/90;class N0{matrix;constructor(){this.matrix=q.create()}static create(){return new N0}copy(K){return q.copy(this.matrix,K),this}invert(){return q.invert(this.matrix,this.matrix),this}multiply(K){return q.multiply(this.matrix,this.matrix,K),this}translate(K,Q,$){return q.translate(this.matrix,this.matrix,[K,Q,$]),this}rotateX(K){return q.rotateX(this.matrix,this.matrix,K),this}rotateY(K){return q.rotateY(this.matrix,this.matrix,K),this}rotateZ(K){return q.rotateZ(this.matrix,this.matrix,K),this}scale(K,Q,$){return q.scale(this.matrix,this.matrix,[K,Q,$]),this}perspective(K,Q,$,J){return q.perspective(this.matrix,K*h$,Q,$,J),this}ortho(K,Q,$,J,V,Y){return q.ortho(this.matrix,K,Q,$,J,V,Y),this}static aTemp=q.create();static bTemp=q.create();static combineMat4(K,Q,$,J=0.5){q.multiplyScalar(this.aTemp,Q,1-J),q.multiplyScalar(this.bTemp,$,J),q.add(K,this.aTemp,this.bTemp)}static tempQuat=r.create();static moveMatrix(K,Q,$,J,V=null){const Y=m.fromValues(-Q,$,J);if(V)q.getRotation(this.tempQuat,V),r.invert(this.tempQuat,this.tempQuat),m.transformQuat(Y,Y,this.tempQuat);q.translate(K,K,Y)}getMatrix(){return this.matrix}}var T=N0;class _0{gl;uniforms;cameraMatrix=T.create().translate(0,0,-1).getMatrix();perspectiveMatrix=T.create().getMatrix();orthoMatrix=T.create().getMatrix();projectionMatrix=T.create().getMatrix();perspectiveLevel=1;constructor(K,Q){this.gl=K,this.uniforms=Q}configPerspectiveMatrix(K){this.perspectiveMatrix=T.create().perspective(45,K,0.1,1000).getMatrix(),this.updatePerspective()}configOrthoMatrix(K){this.orthoMatrix=T.create().ortho(-K,K,-1,1,-1000,1000).getMatrix(),this.updatePerspective()}camTiltMatrix=T.create().getMatrix();camTurnMatrix=T.create().getMatrix();camMatrix=q.create();refresh(){q.mul(this.camMatrix,this.camTiltMatrix,this.camTurnMatrix),q.mul(this.camMatrix,this.camMatrix,this.cameraMatrix);const K=this.uniforms.getUniformLocation(e);if(K)this.gl.uniformMatrix4fv(K,!1,this.camMatrix)}orthoTemp=q.create();perspectiveTemp=q.create();updatePerspective(K){if(K!==void 0)this.perspectiveLevel=K;T.combineMat4(this.projectionMatrix,this.orthoMatrix,this.perspectiveMatrix,this.perspectiveLevel);const Q=this.uniforms.getUniformLocation(v0);if(Q)this.gl.uniformMatrix4fv(Q,!1,this.projectionMatrix);this.refresh()}moveCam(K,Q,$){T.moveMatrix(this.cameraMatrix,K,Q,$,this.camTurnMatrix),this.refresh()}turnCam(K){q.rotateY(this.camTurnMatrix,this.camTurnMatrix,K),this.refresh()}tilt(K){q.rotateX(this.camTiltMatrix,this.camTiltMatrix,K),this.refresh()}}function RK(K,Q=($)=>$.key){var $=[];return G0(K,"",!0,(J)=>$.push(J),Q),$.join("")}var G0=function(K,Q,$,J,V){if(K){J(`${Q}${$?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 "}${V(K)}\n`);const Y=Q+($?"    ":"\u2502   ");if(K.left)G0(K.left,Y,!1,J,V);if(K.right)G0(K.right,Y,!0,J,V)}};function K0(K){if(K===null)return!0;var Q=Q0(K.left),$=Q0(K.right);if(Math.abs(Q-$)<=1&&K0(K.left)&&K0(K.right))return!0;return!1}var Q0=function(K){return K?1+Math.max(Q0(K.left),Q0(K.right)):0};function $0(K,Q,$,J,V){const Y=V-J;if(Y>0){const Z=J+Math.floor(Y/2),B=Q[Z],F=$[Z],P={key:B,data:F,parent:K};return P.left=$0(P,Q,$,J,Z),P.right=$0(P,Q,$,Z+1,V),P}return null}function J0(K){if(K===null)return 0;const Q=J0(K.left),$=J0(K.right);return K.balanceFactor=Q-$,Math.max(Q,$)+1}function V0(K,Q,$,J,V){if($>=J)return;const Y=K[$+J>>1];let Z=$-1,B=J+1;while(!0){do Z++;while(V(K[Z],Y)<0);do B--;while(V(K[B],Y)>0);if(Z>=B)break;let F=K[Z];K[Z]=K[B],K[B]=F,F=Q[Z],Q[Z]=Q[B],Q[B]=F}V0(K,Q,$,B,V),V0(K,Q,B+1,J,V)}var I$=function(K,Q){return K>Q?1:K<Q?-1:0},Y0=function(K){var Q=K.right;if(K.right=Q.left,Q.left)Q.left.parent=K;if(Q.parent=K.parent,Q.parent)if(Q.parent.left===K)Q.parent.left=Q;else Q.parent.right=Q;if(K.parent=Q,Q.left=K,K.balanceFactor+=1,Q.balanceFactor<0)K.balanceFactor-=Q.balanceFactor;if(Q.balanceFactor+=1,K.balanceFactor>0)Q.balanceFactor+=K.balanceFactor;return Q},B0=function(K){var Q=K.left;if(K.left=Q.right,K.left)K.left.parent=K;if(Q.parent=K.parent,Q.parent)if(Q.parent.left===K)Q.parent.left=Q;else Q.parent.right=Q;if(K.parent=Q,Q.right=K,K.balanceFactor-=1,Q.balanceFactor>0)K.balanceFactor-=Q.balanceFactor;if(Q.balanceFactor-=1,K.balanceFactor<0)Q.balanceFactor+=K.balanceFactor;return Q};class d{constructor(K,Q=!1){this._comparator=K||I$,this._root=null,this._size=0,this._noDuplicates=!!Q}destroy(){return this.clear()}clear(){return this._root=null,this._size=0,this}get size(){return this._size}contains(K){if(this._root){var Q=this._root,$=this._comparator;while(Q){var J=$(K,Q.key);if(J===0)return!0;else if(J<0)Q=Q.left;else Q=Q.right}}return!1}next(K){var Q=K;if(Q)if(Q.right){Q=Q.right;while(Q.left)Q=Q.left}else{Q=K.parent;while(Q&&Q.right===K)K=Q,Q=Q.parent}return Q}prev(K){var Q=K;if(Q)if(Q.left){Q=Q.left;while(Q.right)Q=Q.right}else{Q=K.parent;while(Q&&Q.left===K)K=Q,Q=Q.parent}return Q}forEach(K){var Q=this._root,$=[],J=!1,V=0;while(!J)if(Q)$.push(Q),Q=Q.left;else if($.length>0)Q=$.pop(),K(Q,V++),Q=Q.right;else J=!0;return this}range(K,Q,$,J){const V=[],Y=this._comparator;let Z=this._root,B;while(V.length!==0||Z)if(Z)V.push(Z),Z=Z.left;else{if(Z=V.pop(),B=Y(Z.key,Q),B>0)break;else if(Y(Z.key,K)>=0){if($.call(J,Z))return this}Z=Z.right}return this}keys(){var K=this._root,Q=[],$=[],J=!1;while(!J)if(K)Q.push(K),K=K.left;else if(Q.length>0)K=Q.pop(),$.push(K.key),K=K.right;else J=!0;return $}values(){var K=this._root,Q=[],$=[],J=!1;while(!J)if(K)Q.push(K),K=K.left;else if(Q.length>0)K=Q.pop(),$.push(K.data),K=K.right;else J=!0;return $}at(K){var Q=this._root,$=[],J=!1,V=0;while(!J)if(Q)$.push(Q),Q=Q.left;else if($.length>0){if(Q=$.pop(),V===K)return Q;V++,Q=Q.right}else J=!0;return null}minNode(){var K=this._root;if(!K)return null;while(K.left)K=K.left;return K}maxNode(){var K=this._root;if(!K)return null;while(K.right)K=K.right;return K}min(){var K=this._root;if(!K)return null;while(K.left)K=K.left;return K.key}max(){var K=this._root;if(!K)return null;while(K.right)K=K.right;return K.key}isEmpty(){return!this._root}pop(){var K=this._root,Q=null;if(K){while(K.left)K=K.left;Q={key:K.key,data:K.data},this.remove(K.key)}return Q}popMax(){var K=this._root,Q=null;if(K){while(K.right)K=K.right;Q={key:K.key,data:K.data},this.remove(K.key)}return Q}find(K){var Q=this._root,$=Q,J,V=this._comparator;while($)if(J=V(K,$.key),J===0)return $;else if(J<0)$=$.left;else $=$.right;return null}insert(K,Q){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:K,data:Q},this._size++,this._root;var $=this._comparator,J=this._root,V=null,Y=0;if(this._noDuplicates)while(J)if(Y=$(K,J.key),V=J,Y===0)return null;else if(Y<0)J=J.left;else J=J.right;else while(J)if(Y=$(K,J.key),V=J,Y<=0)J=J.left;else J=J.right;var Z={left:null,right:null,balanceFactor:0,parent:V,key:K,data:Q},B;if(Y<=0)V.left=Z;else V.right=Z;while(V){if(Y=$(V.key,K),Y<0)V.balanceFactor-=1;else V.balanceFactor+=1;if(V.balanceFactor===0)break;else if(V.balanceFactor<-1){if(V.right.balanceFactor===1)B0(V.right);if(B=Y0(V),V===this._root)this._root=B;break}else if(V.balanceFactor>1){if(V.left.balanceFactor===-1)Y0(V.left);if(B=B0(V),V===this._root)this._root=B;break}V=V.parent}return this._size++,Z}remove(K){if(!this._root)return null;var Q=this._root,$=this._comparator,J=0;while(Q)if(J=$(K,Q.key),J===0)break;else if(J<0)Q=Q.left;else Q=Q.right;if(!Q)return null;var V=Q.key,Y,Z;if(Q.left){Y=Q.left;while(Y.left||Y.right){while(Y.right)Y=Y.right;if(Q.key=Y.key,Q.data=Y.data,Y.left)Q=Y,Y=Y.left}Q.key=Y.key,Q.data=Y.data,Q=Y}if(Q.right){Z=Q.right;while(Z.left||Z.right){while(Z.left)Z=Z.left;if(Q.key=Z.key,Q.data=Z.data,Z.right)Q=Z,Z=Z.right}Q.key=Z.key,Q.data=Z.data,Q=Z}var B=Q.parent,F=Q,P;while(B){if(B.left===F)B.balanceFactor-=1;else B.balanceFactor+=1;if(B.balanceFactor<-1){if(B.right.balanceFactor===1)B0(B.right);if(P=Y0(B),B===this._root)this._root=P;B=P}else if(B.balanceFactor>1){if(B.left.balanceFactor===-1)Y0(B.left);if(P=B0(B),B===this._root)this._root=P;B=P}if(B.balanceFactor===-1||B.balanceFactor===1)break;F=B,B=B.parent}if(Q.parent)if(Q.parent.left===Q)Q.parent.left=null;else Q.parent.right=null;if(Q===this._root)this._root=null;return this._size--,V}load(K=[],Q=[],$){if(this._size!==0)throw new Error("bulk-load: tree is not empty");const J=K.length;if($)V0(K,Q,0,J-1,this._comparator);return this._root=$0(null,K,Q,0,J),J0(this._root),this._size=J,this}isBalanced(){return K0(this._root)}toString(K){return RK(this._root,K)}}d.default=d;class x{size;slotNumber;x;y;textureIndex;parent;sibbling;textureSizeLimits;constructor(K,Q,$,J){this.textureSizeLimits=$?.textureSizeLimits??J??{min:k0,max:q0},this.size=K,this.slotNumber=Q,this.parent=$,this.sibbling=void 0;const{x:V,y:Y,textureIndex:Z}=this.calculatePosition(K,Q);this.x=V,this.y=Y,this.textureIndex=Z}calculateTextureIndex(K,Q){const[$,J]=K,V=this.textureSizeLimits.max/$*(this.textureSizeLimits.max/J);return Math.floor(Q/V)}calculatePosition(K,Q){const[$,J]=K,V=this.textureSizeLimits.max/$,Y=this.textureSizeLimits.max/J,Z=Q%V*$,B=Math.floor(Q/V)%Y*J;return{x:Z,y:B,textureIndex:this.calculateTextureIndex(K,Q)}}getTag(){return x.getTag(this)}static getTag(K){return`${K.size[0]}x${K.size[1]}-#${K.slotNumber}-[${K.textureIndex}]`}static positionToTextureSlot(K,Q,$,J,V){const[Y,Z]=$,B=V.textureSizeLimits.max/Y,P=V.textureSizeLimits.max/Y*(V.textureSizeLimits.max/Z)*J+Q/Z*B+K/Y;return new x($,P,V)}getPosition(){return{x:this.x,y:this.y,size:this.size,textureIndex:this.textureIndex}}canSplitHorizontally(){const[,K]=this.size;return K>this.textureSizeLimits.min}canSplitVertically(){const[K]=this.size;return K>this.textureSizeLimits.min}splitHorizontally(){const{x:K,y:Q,size:$,textureIndex:J}=this,[V,Y]=$;if(!this.canSplitHorizontally())throw new Error(`Cannot split texture slot of size ${V} horizontally`);const Z=V/2,B=x.positionToTextureSlot(K,Q,[Z,Y],J,this),F=x.positionToTextureSlot(K+Z,Q,[Z,Y],J,this);return B.sibbling=F,F.sibbling=B,[B,F]}splitVertically(){const{x:K,y:Q,size:$,textureIndex:J}=this,[V,Y]=$;if(!this.canSplitVertically())throw new Error(`Cannot split texture slot of size ${Y} vertically`);const Z=Y/2,B=x.positionToTextureSlot(K,Q,[V,Z],J,this),F=x.positionToTextureSlot(K,Q+Z,[V,Z],J,this);return B.sibbling=F,F.sibbling=B,[B,F]}}function Z0(K,Q){return Math.max(Q,Math.pow(2,Math.ceil(Math.log(K)/Math.log(2))))}function NK(K,Q,$,J){if($<1)throw new Error("Invalid count");const V=Z0(K,J.min),Y=Z0(Q,J.min),Z=new Map;let B=J.min;for(let F=1;F<=$;F++){B=Z0(V*F,J.min);const P=Z0(Y*Math.ceil($/F),J.min);Z.set(B,P)}for(let F=B;F<=J.max;F*=2)if(!Z.has(F))Z.set(F,Y);return Z}var S$=!1,k0=16,q0=4096,w$=16;class b{textureSlots=new d((K,Q)=>{const $=K.size[0]*K.size[1]-Q.size[0]*Q.size[1];if($!==0)return $;return K.slotNumber-Q.slotNumber},!1);allocatedTextures={};minTextureSize;maxTextureSize;constructor({numTextureSheets:K,minTextureSize:Q,maxTextureSize:$}={},J){let V=K??w$;if(this.minTextureSize=Q??k0,this.maxTextureSize=$??q0,J)V=Math.min(V,J.getParameter(WebGL2RenderingContext.MAX_TEXTURE_IMAGE_UNITS)),this.maxTextureSize=Math.min(this.maxTextureSize,J.getParameter(WebGL2RenderingContext.MAX_TEXTURE_SIZE)),this.minTextureSize=Math.min(this.minTextureSize,this.maxTextureSize);for(let Y=0;Y<V;Y++)this.textureSlots.insert(new x([this.maxTextureSize,this.maxTextureSize],Y,void 0,{min:this.minTextureSize,max:this.maxTextureSize}))}allocate(K,Q,$=1){const{size:J,slotNumber:V,x:Y,y:Z,textureIndex:B}=this.allocateHelper(K,Q,$);return{size:J,slotNumber:V,x:Y,y:Z,textureIndex:B}}deallocate(K){if(!this.isSlotUsed(K))throw new Error("Slot is not allocated");const Q=this.allocatedTextures[x.getTag(K)];this.deallocateHelper(Q)}allocateHelper(K,Q,$=1){const J=NK(K,Q,$,{min:this.minTextureSize,max:this.maxTextureSize}),V=this.findSlot(J);if(!V)throw new Error(`Could not find a slot for texture to fit ${$} sprites of size ${K}x${Q}`);this.textureSlots.remove(V);const[Y,Z]=this.bestFit(J,V);return this.fitSlot(V,Y,Z)}findSlot(K){for(let Q=0;Q<this.textureSlots.size;Q++){const J=this.textureSlots.at(Q).key,[V,Y]=J.size;if(K.get(V)<=Y)return J}return null}calculateRatio(K,Q){return Math.max(K/Q,Q/K)}bestFit(K,Q){const[$,J]=Q.size;let V=Q.textureSizeLimits.max;return K.forEach((Y,Z)=>{if(Z<=$&&Y<=J){const B=Z*Y,F=K.get(V)*V;if(B<F)V=Z;else if(B===F){if(this.calculateRatio(Z,Y)<this.calculateRatio(V,K.get(V)))V=Z}}}),[V,K.get(V)]}isSlotUsed(K){return!!this.allocatedTextures[x.getTag(K)]}deallocateHelper(K){if(K.parent&&K.sibbling&&!this.isSlotUsed(K.sibbling)){const Q=K.sibbling;if(this.textureSlots.remove(Q),S$&&this.textureSlots.find(K))throw new Error("Slot is not expected to be in the tree");const $=K.parent;this.deallocateHelper($);return}this.textureSlots.insert(K),delete this.allocatedTextures[K.getTag()]}trySplitHorizontally(K,Q,$){if(K.canSplitHorizontally()){const[J,V]=K.splitHorizontally();if(J.size[0]>=Q)return this.textureSlots.insert(V),this.fitSlot(J,Q,$)}return null}trySplitVertically(K,Q,$){if(K.canSplitVertically()){const[J,V]=K.splitVertically();if(J.size[1]>=$)return this.textureSlots.insert(V),this.fitSlot(J,Q,$)}return null}fitSlot(K,Q,$){if(this.allocatedTextures[K.getTag()]=K,K.size[0]>K.size[1]){const J=this.trySplitHorizontally(K,Q,$)??this.trySplitVertically(K,Q,$);if(J)return J}else{const J=this.trySplitVertically(K,Q,$)??this.trySplitHorizontally(K,Q,$);if(J)return J}return K}listSlots(){this.textureSlots.forEach((K)=>{console.log(K.key?.getTag())})}}var f$=function(K){if(!p$)return K;return new Proxy(K,{get($,J){const V=$,Y=V[J];if(typeof Y==="function")return(...B)=>{const F=Y.apply(V,B);return console.log(`gl.${String(J)}(`,B,") = ",F),F};else return console.log(`gl.${String(J)} = `,Y),Y}})},v$={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},p$=!1;class L0 extends f{gl;programs;attributeBuffers;uniforms;canvas;textureManager;textureAllocator;imageManager;camera;constructor(K,Q){super();this.gl=f$(K.getContext("webgl2",{...v$,...Q})),this.canvas=K,this.programs=this.own(new H0(this.gl)),this.uniforms=this.own(new W0(this.gl,this.programs)),this.attributeBuffers=this.own(new U0(this.gl,this.programs)),this.textureManager=new D0(this.gl),this.textureAllocator=new b,this.imageManager=new O0,this.camera=new _0(this.gl,this.uniforms),window.addEventListener("resize",this.checkCanvasSize.bind(this))}checkCanvasSize(){this.canvas.width=this.canvas.offsetWidth*2,this.canvas.height=this.canvas.offsetHeight*2,this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const K=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;this.camera.configOrthoMatrix(K),this.camera.configPerspectiveMatrix(K)}async initialize(){const Q={AUTHOR:"Jack le hamster"};this.programs.addProgram("main",j0(z0,Q),j0(g0,Q)),console.log(performance.now(),11),this.programs.useProgram("main"),console.log(this.uniforms.getUniformLocation(e)),console.log(performance.now(),22),this.gl.enable(A.DEPTH_TEST),this.gl.depthFunc(A.LESS),this.gl.clearDepth(1),this.gl.enable(A.BLEND),this.gl.blendFunc(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),console.log(performance.now(),33);{const $=S0;this.attributeBuffers.createBuffer($);const J=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(A.ELEMENT_ARRAY_BUFFER,J),this.attributeBuffers.bufferData(A.ELEMENT_ARRAY_BUFFER,$,Uint16Array.from([0,1,2,2,3,0]),0,A.STATIC_DRAW)}{const $=I0;this.attributeBuffers.createBuffer($);const J=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(A.ARRAY_BUFFER,J),this.gl.vertexAttribPointer(J.location,4,A.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(J.location),this.attributeBuffers.bufferData(A.ARRAY_BUFFER,$,Float32Array.from([-1,-1,0,1,1,-1,1,1,1,1,1,0,-1,1,0,0]),0,A.STATIC_DRAW)}console.log(performance.now(),44);{const $=P0;this.attributeBuffers.createBuffer($);const J=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(A.ARRAY_BUFFER,J);for(let Y=0;Y<4;Y++){const Z=J.location+Y;this.gl.vertexAttribPointer(Z,4,A.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,Y*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(Z),this.gl.vertexAttribDivisor(Z,1)}this.attributeBuffers.bufferData(A.ARRAY_BUFFER,$,Float32Array.from([...T.create().translate(0,0,0).getMatrix(),...T.create().translate(-1,0,1).rotateY(Math.PI/2).scale(1,1,1).getMatrix(),...T.create().translate(1,0,1).rotateY(-Math.PI/2).scale(1,1,1).getMatrix(),...T.create().translate(0,-1,1).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...T.create().translate(0,-1,3).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...T.create().translate(-2,-1,3).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...T.create().translate(2,-1,3).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...T.create().translate(0,0,0).getMatrix()]),0,A.DYNAMIC_DRAW);const V=this.uniforms.getUniformLocation(p0);if(V)this.gl.uniform1f(V,this.textureAllocator.maxTextureSize);console.log(performance.now(),55)}await this.loadLogoTexture(),this.checkCanvasSize(),this.camera.refresh()}syncHud(){this.attributeBuffers.bindBuffer(A.ARRAY_BUFFER,this.attributeBuffers.getAttributeBuffer(P0));const K=[-this.camera.cameraMatrix[12],-this.camera.cameraMatrix[13],-this.camera.cameraMatrix[14]],Q=T.create().copy(this.camera.camTurnMatrix).invert().getMatrix(),$=T.create().copy(this.camera.camTiltMatrix).invert().getMatrix();this.attributeBuffers.bufferSubData(A.ARRAY_BUFFER,Float32Array.from([...T.create().translate(K[0],K[1],K[2]).multiply(Q).multiply($).translate(0,0,-2).getMatrix()]),16*Float32Array.BYTES_PER_ELEMENT*7)}async loadLogoTexture(){const K=this.textureAllocator.maxTextureSize,Q=K,$=K/4;await this.imageManager.drawImage("logo",(B)=>{const{canvas:F}=B;F.width=$,F.height=$;const P=F.width/2,C=F.height/2,H=F.width/2;B.imageSmoothingEnabled=!0,B.fillStyle="#ddd",B.lineWidth=F.width/50,B.fillRect(0,0,F.width,F.height),B.strokeStyle="black",B.fillStyle="gold",B.beginPath(),B.arc(P,C,H*0.8,0,2*Math.PI),B.fill(),B.stroke(),B.beginPath(),B.arc(P,C,H*0.5,0,Math.PI),B.stroke(),B.beginPath(),B.arc(F.width/3,F.height/3,H*0.1,0,Math.PI,!0),B.stroke(),B.beginPath(),B.arc(F.width/3*2,F.height/3,H*0.1,0,Math.PI*2,!0),B.stroke()}),await this.imageManager.drawImage("ground",(B)=>{const{canvas:F}=B;F.width=$,F.height=$,B.imageSmoothingEnabled=!0,B.fillStyle="#ddd",B.lineWidth=F.width/50,B.fillRect(0,0,F.width,F.height),B.strokeStyle="black",B.fillStyle="silver",B.beginPath(),B.rect(F.width*0.2,F.height*0.2,F.width*0.6,F.height*0.6),B.fill(),B.stroke()}),console.log(performance.now(),1);const J=this.textureAllocator.allocate(Q,Q),V=this.imageManager.getMedia("logo");console.log(performance.now(),2),this.textureManager.applyImageToSlot(V,J),console.log(performance.now(),3);const Y=this.textureAllocator.allocate(Q,Q);console.log(performance.now(),4);const Z=this.imageManager.getMedia("ground");console.log(performance.now(),5),this.textureManager.applyImageToSlot(Z,Y),console.log(performance.now(),6),console.log(J,Y),console.log(performance.now(),7),this.textureManager.generateMipMap("TEXTURE0");{const B=w0;this.attributeBuffers.createBuffer(B);const F=this.attributeBuffers.getAttributeBuffer(B);this.attributeBuffers.bindBuffer(A.ARRAY_BUFFER,F);const P=F.location;this.gl.vertexAttribPointer(P,3,A.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),this.gl.enableVertexAttribArray(P),this.gl.vertexAttribDivisor(P,1),this.attributeBuffers.bufferData(A.ARRAY_BUFFER,B,Float32Array.from([...J.size,J.slotNumber,...J.size,J.slotNumber,...J.size,J.slotNumber,...Y.size,Y.slotNumber,...Y.size,Y.slotNumber,...Y.size,Y.slotNumber,...Y.size,Y.slotNumber,...J.size,J.slotNumber]),0,A.DYNAMIC_DRAW)}}drawElementsInstanced(K,Q){this.gl.drawElementsInstanced(A.TRIANGLES,K,A.UNSIGNED_SHORT,0,Q)}refresh(){this.gl.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT);const K=6,Q=8;this.syncHud(),this.drawElementsInstanced(K,Q)}bindVertexArray(){return this.own(new X0(this.gl))}}async function K8(){console.log("Hello World!")}function Q8(K){K.style.border="2px solid silver",K.style.cursor="grab",K.addEventListener("mouseenter",()=>{K.style.borderColor="black"}),K.addEventListener("mouseleave",()=>{K.style.borderColor="silver"});const Q=new L0(K);Q.initialize();const $={};document.addEventListener("keydown",(V)=>{$[V.code]=!0}),document.addEventListener("keyup",(V)=>{$[V.code]=!1});function J(){Q.gl.enable(Q.gl.DEPTH_TEST);const V=0.25,Y=0.05;if($.KeyW)Q.camera.moveCam(0,0,V);if($.KeyS)Q.camera.moveCam(0,0,-V);if($.ArrowUp&&!$.ShiftRight)Q.camera.moveCam(0,-V,0);if($.ArrowDown&&!$.ShiftRight)Q.camera.moveCam(0,V,0);if($.KeyA||$.ArrowLeft&&!$.ShiftRight)Q.camera.moveCam(-V,0,0);if($.KeyD||$.ArrowRight&&!$.ShiftRight)Q.camera.moveCam(V,0,0);if($.KeyQ||$.ArrowLeft&&$.ShiftRight)Q.camera.turnCam(-Y);if($.KeyE||$.ArrowRight&&$.ShiftRight)Q.camera.turnCam(Y);if($.ArrowUp&&$.ShiftRight)Q.camera.tilt(-Y);if($.ArrowDown&&$.ShiftRight)Q.camera.tilt(Y);Q.refresh(),requestAnimationFrame(J)}return console.log(performance.now(),"<<"),Q.refresh(),console.log(performance.now(),"<<<"),J(),Q}export{Q8 as testCanvas,K8 as hello};

//# debugId=AB7A7C3E573DFE0464756e2164756e21
