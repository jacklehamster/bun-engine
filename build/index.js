var e0=Object.defineProperty;var o=(M,Q)=>{for(var V in Q)e0(M,V,{get:Q[V],enumerable:!0,configurable:!0,set:(W)=>Q[V]=()=>W})};class n{disposables;own(M){if(!this.disposables)this.disposables=new Set;return this.disposables.add(M),M}destroy(){this.disposables?.forEach((M)=>M.destroy())}}var b0=function(M,Q,V){function W($,H){function X(h){return h===M?.VERTEX_SHADER?"vertex":h===M?.FRAGMENT_SHADER?"fragment":void 0}if(H!==M.VERTEX_SHADER&&H!==M.FRAGMENT_SHADER)throw new Error(`Shader error in ${X(H)}`);const J=M.createShader(H);if(!J)throw new Error(`Unable to generate ${X(H)} shader.`);if(M.shaderSource(J,$),M.compileShader(J),!M.getShaderParameter(J,M.COMPILE_STATUS))console.error(`Shader compile error in ${X(H)}:`+M.getShaderInfoLog(J));return J}const Y=M.createProgram();if(!Y)throw new Error("Unable to create program.");const Z=W(Q,M.VERTEX_SHADER),K=W(V,M.FRAGMENT_SHADER);if(M.attachShader(Y,Z),M.attachShader(Y,K),M.linkProgram(Y),M.detachShader(Y,Z),M.detachShader(Y,K),M.deleteShader(Z),M.deleteShader(K),M.validateProgram(Y),!M.getProgramParameter(Y,M.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+M.getProgramInfoLog(Y));return Y},u0=function(M,Q){M.deleteProgram(Q)};class t extends n{gl;program;constructor(M,Q,V){super();this.gl=M,this.program=b0(M,Q.trim(),V.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),u0(this.gl,this.program)}}class a extends n{activeProgramId="";gl;programs={};constructor(M){super();this.gl=M}addProgram(M,Q,V){if(this.programs[M])this.removeProgram(M);this.programs[M]=this.own(new t(this.gl,Q,V))}useProgram(M){if(this.activeProgramId!==M)this.activeProgramId=M,this.programs[M].use()}removeProgram(M){this.programs[M].destroy(),delete this.programs[M]}getProgram(M){return this.programs[M??this.activeProgramId]?.program}}class M0 extends n{gl;triangleArray;constructor(M){super();this.gl=M,this.triangleArray=M.createVertexArray(),M.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class Q0 extends n{bufferRecord={};lastBoundBuffer;gl;programs;constructor(M,Q){super();this.gl=M,this.programs=Q}getAttributeLocation(M,Q){const V=this.programs.getProgram(Q);return V?this.gl.getAttribLocation(V,M)??-1:-1}createBuffer(M){this.deleteBuffer(M);const Q=this.gl?.createBuffer();if(!Q)throw new Error(`Unable to create buffer "${M}"`);const V={buffer:Q,location:this.getAttributeLocation(M)};return this.bufferRecord[M]=V,V}deleteBuffer(M){if(this.bufferRecord[M])this.gl.deleteBuffer(this.bufferRecord[M].buffer),delete this.bufferRecord[M]}getAttributeBuffer(M,Q){const V=this.bufferRecord[M];if(!V){if(Q)return this.createBuffer(M);throw new Error(`Attribute "${M}" not created. Make sure "createBuffer" is called.`)}return V}bufferData(M,Q,V,W,Y){const Z=this.getAttributeBuffer(Q);if(V)this.gl.bufferData(M,V,Y);else this.gl.bufferData(M,W,Y);Z.bufferSize=W||V?.length,Z.bufferArray=V??new Float32Array(Z.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),Z.usage=Y,Z.target=M}bufferSubData(M,Q,V,W,Y){if(W)this.gl.bufferSubData(M,V,Q,W,Y);else this.gl.bufferSubData(M,V,Q)}bindBuffer(M,Q){if(this.lastBoundBuffer!==Q)this.lastBoundBuffer=Q,this.gl.bindBuffer(M,Q.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((M)=>this.deleteBuffer(M))}}class V0 extends n{gl;programs;constructor(M,Q){super();this.gl=M,this.programs=Q}getUniformLocation(M,Q){const V=this.programs.getProgram(Q);return V?this.gl.getUniformLocation(V,M)??void 0:void 0}}var l="position",m="index",s="transform",J0="cam";var T=0.000001,I=typeof Float32Array!=="undefined"?Float32Array:Array,d=Math.random,EV=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var M=0,Q=arguments.length;while(Q--)M+=arguments[Q]*arguments[Q];return Math.sqrt(M)};function B0(){var M=new I(9);if(I!=Float32Array)M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0;return M[0]=1,M[4]=1,M[8]=1,M}var A={};o(A,{transpose:()=>{{return WM}},translate:()=>{{return $M}},targetTo:()=>{{return pM}},subtract:()=>{{return U0}},sub:()=>{{return lM}},str:()=>{{return wM}},set:()=>{{return VM}},scale:()=>{{return HM}},rotateZ:()=>{{return hM}},rotateY:()=>{{return BM}},rotateX:()=>{{return JM}},rotate:()=>{{return XM}},perspectiveZO:()=>{{return GM}},perspectiveNO:()=>{{return F0}},perspectiveFromFieldOfView:()=>{{return _M}},perspective:()=>{{return IM}},orthoZO:()=>{{return LM}},orthoNO:()=>{{return N0}},ortho:()=>{{return SM}},multiplyScalarAndAdd:()=>{{return dM}},multiplyScalar:()=>{{return gM}},multiply:()=>{{return C0}},mul:()=>{{return cM}},lookAt:()=>{{return qM}},invert:()=>{{return YM}},identity:()=>{{return h0}},getTranslation:()=>{{return DM}},getScaling:()=>{{return E0}},getRotation:()=>{{return kM}},frustum:()=>{{return OM}},fromZRotation:()=>{{return UM}},fromYRotation:()=>{{return NM}},fromXRotation:()=>{{return FM}},fromValues:()=>{{return QM}},fromTranslation:()=>{{return CM}},fromScaling:()=>{{return PM}},fromRotationTranslationScaleOrigin:()=>{{return TM}},fromRotationTranslationScale:()=>{{return AM}},fromRotationTranslation:()=>{{return P0}},fromRotation:()=>{{return EM}},fromQuat2:()=>{{return RM}},fromQuat:()=>{{return jM}},frob:()=>{{return vM}},exactEquals:()=>{{return iM}},equals:()=>{{return fM}},determinant:()=>{{return KM}},create:()=>{{return t0}},copy:()=>{{return MM}},clone:()=>{{return a0}},adjoint:()=>{{return ZM}},add:()=>{{return nM}}});function t0(){var M=new I(16);if(I!=Float32Array)M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0;return M[0]=1,M[5]=1,M[10]=1,M[15]=1,M}function a0(M){var Q=new I(16);return Q[0]=M[0],Q[1]=M[1],Q[2]=M[2],Q[3]=M[3],Q[4]=M[4],Q[5]=M[5],Q[6]=M[6],Q[7]=M[7],Q[8]=M[8],Q[9]=M[9],Q[10]=M[10],Q[11]=M[11],Q[12]=M[12],Q[13]=M[13],Q[14]=M[14],Q[15]=M[15],Q}function MM(M,Q){return M[0]=Q[0],M[1]=Q[1],M[2]=Q[2],M[3]=Q[3],M[4]=Q[4],M[5]=Q[5],M[6]=Q[6],M[7]=Q[7],M[8]=Q[8],M[9]=Q[9],M[10]=Q[10],M[11]=Q[11],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15],M}function QM(M,Q,V,W,Y,Z,K,$,H,X,J,h,P,C,F,E){var B=new I(16);return B[0]=M,B[1]=Q,B[2]=V,B[3]=W,B[4]=Y,B[5]=Z,B[6]=K,B[7]=$,B[8]=H,B[9]=X,B[10]=J,B[11]=h,B[12]=P,B[13]=C,B[14]=F,B[15]=E,B}function VM(M,Q,V,W,Y,Z,K,$,H,X,J,h,P,C,F,E,B){return M[0]=Q,M[1]=V,M[2]=W,M[3]=Y,M[4]=Z,M[5]=K,M[6]=$,M[7]=H,M[8]=X,M[9]=J,M[10]=h,M[11]=P,M[12]=C,M[13]=F,M[14]=E,M[15]=B,M}function h0(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function WM(M,Q){if(M===Q){var V=Q[1],W=Q[2],Y=Q[3],Z=Q[6],K=Q[7],$=Q[11];M[1]=Q[4],M[2]=Q[8],M[3]=Q[12],M[4]=V,M[6]=Q[9],M[7]=Q[13],M[8]=W,M[9]=Z,M[11]=Q[14],M[12]=Y,M[13]=K,M[14]=$}else M[0]=Q[0],M[1]=Q[4],M[2]=Q[8],M[3]=Q[12],M[4]=Q[1],M[5]=Q[5],M[6]=Q[9],M[7]=Q[13],M[8]=Q[2],M[9]=Q[6],M[10]=Q[10],M[11]=Q[14],M[12]=Q[3],M[13]=Q[7],M[14]=Q[11],M[15]=Q[15];return M}function YM(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=Q[4],$=Q[5],H=Q[6],X=Q[7],J=Q[8],h=Q[9],P=Q[10],C=Q[11],F=Q[12],E=Q[13],B=Q[14],N=Q[15],j=V*$-W*K,k=V*H-Y*K,D=V*X-Z*K,U=W*H-Y*$,R=W*X-Z*$,q=Y*X-Z*H,_=J*E-h*F,S=J*B-P*F,L=J*N-C*F,p=h*B-P*E,w=h*N-C*E,v=P*N-C*B,O=j*v-k*w+D*p+U*L-R*S+q*_;if(!O)return null;return O=1/O,M[0]=($*v-H*w+X*p)*O,M[1]=(Y*w-W*v-Z*p)*O,M[2]=(E*q-B*R+N*U)*O,M[3]=(P*R-h*q-C*U)*O,M[4]=(H*L-K*v-X*S)*O,M[5]=(V*v-Y*L+Z*S)*O,M[6]=(B*D-F*q-N*k)*O,M[7]=(J*q-P*D+C*k)*O,M[8]=(K*w-$*L+X*_)*O,M[9]=(W*L-V*w-Z*_)*O,M[10]=(F*R-E*D+N*j)*O,M[11]=(h*D-J*R-C*j)*O,M[12]=($*S-K*p-H*_)*O,M[13]=(V*p-W*S+Y*_)*O,M[14]=(E*k-F*U-B*j)*O,M[15]=(J*U-h*k+P*j)*O,M}function ZM(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=Q[4],$=Q[5],H=Q[6],X=Q[7],J=Q[8],h=Q[9],P=Q[10],C=Q[11],F=Q[12],E=Q[13],B=Q[14],N=Q[15];return M[0]=$*(P*N-C*B)-h*(H*N-X*B)+E*(H*C-X*P),M[1]=-(W*(P*N-C*B)-h*(Y*N-Z*B)+E*(Y*C-Z*P)),M[2]=W*(H*N-X*B)-$*(Y*N-Z*B)+E*(Y*X-Z*H),M[3]=-(W*(H*C-X*P)-$*(Y*C-Z*P)+h*(Y*X-Z*H)),M[4]=-(K*(P*N-C*B)-J*(H*N-X*B)+F*(H*C-X*P)),M[5]=V*(P*N-C*B)-J*(Y*N-Z*B)+F*(Y*C-Z*P),M[6]=-(V*(H*N-X*B)-K*(Y*N-Z*B)+F*(Y*X-Z*H)),M[7]=V*(H*C-X*P)-K*(Y*C-Z*P)+J*(Y*X-Z*H),M[8]=K*(h*N-C*E)-J*($*N-X*E)+F*($*C-X*h),M[9]=-(V*(h*N-C*E)-J*(W*N-Z*E)+F*(W*C-Z*h)),M[10]=V*($*N-X*E)-K*(W*N-Z*E)+F*(W*X-Z*$),M[11]=-(V*($*C-X*h)-K*(W*C-Z*h)+J*(W*X-Z*$)),M[12]=-(K*(h*B-P*E)-J*($*B-H*E)+F*($*P-H*h)),M[13]=V*(h*B-P*E)-J*(W*B-Y*E)+F*(W*P-Y*h),M[14]=-(V*($*B-H*E)-K*(W*B-Y*E)+F*(W*H-Y*$)),M[15]=V*($*P-H*h)-K*(W*P-Y*h)+J*(W*H-Y*$),M}function KM(M){var Q=M[0],V=M[1],W=M[2],Y=M[3],Z=M[4],K=M[5],$=M[6],H=M[7],X=M[8],J=M[9],h=M[10],P=M[11],C=M[12],F=M[13],E=M[14],B=M[15],N=Q*K-V*Z,j=Q*$-W*Z,k=Q*H-Y*Z,D=V*$-W*K,U=V*H-Y*K,R=W*H-Y*$,q=X*F-J*C,_=X*E-h*C,S=X*B-P*C,L=J*E-h*F,p=J*B-P*F,w=h*B-P*E;return N*w-j*p+k*L+D*S-U*_+R*q}function C0(M,Q,V){var W=Q[0],Y=Q[1],Z=Q[2],K=Q[3],$=Q[4],H=Q[5],X=Q[6],J=Q[7],h=Q[8],P=Q[9],C=Q[10],F=Q[11],E=Q[12],B=Q[13],N=Q[14],j=Q[15],k=V[0],D=V[1],U=V[2],R=V[3];return M[0]=k*W+D*$+U*h+R*E,M[1]=k*Y+D*H+U*P+R*B,M[2]=k*Z+D*X+U*C+R*N,M[3]=k*K+D*J+U*F+R*j,k=V[4],D=V[5],U=V[6],R=V[7],M[4]=k*W+D*$+U*h+R*E,M[5]=k*Y+D*H+U*P+R*B,M[6]=k*Z+D*X+U*C+R*N,M[7]=k*K+D*J+U*F+R*j,k=V[8],D=V[9],U=V[10],R=V[11],M[8]=k*W+D*$+U*h+R*E,M[9]=k*Y+D*H+U*P+R*B,M[10]=k*Z+D*X+U*C+R*N,M[11]=k*K+D*J+U*F+R*j,k=V[12],D=V[13],U=V[14],R=V[15],M[12]=k*W+D*$+U*h+R*E,M[13]=k*Y+D*H+U*P+R*B,M[14]=k*Z+D*X+U*C+R*N,M[15]=k*K+D*J+U*F+R*j,M}function $M(M,Q,V){var W=V[0],Y=V[1],Z=V[2],K,$,H,X,J,h,P,C,F,E,B,N;if(Q===M)M[12]=Q[0]*W+Q[4]*Y+Q[8]*Z+Q[12],M[13]=Q[1]*W+Q[5]*Y+Q[9]*Z+Q[13],M[14]=Q[2]*W+Q[6]*Y+Q[10]*Z+Q[14],M[15]=Q[3]*W+Q[7]*Y+Q[11]*Z+Q[15];else K=Q[0],$=Q[1],H=Q[2],X=Q[3],J=Q[4],h=Q[5],P=Q[6],C=Q[7],F=Q[8],E=Q[9],B=Q[10],N=Q[11],M[0]=K,M[1]=$,M[2]=H,M[3]=X,M[4]=J,M[5]=h,M[6]=P,M[7]=C,M[8]=F,M[9]=E,M[10]=B,M[11]=N,M[12]=K*W+J*Y+F*Z+Q[12],M[13]=$*W+h*Y+E*Z+Q[13],M[14]=H*W+P*Y+B*Z+Q[14],M[15]=X*W+C*Y+N*Z+Q[15];return M}function HM(M,Q,V){var W=V[0],Y=V[1],Z=V[2];return M[0]=Q[0]*W,M[1]=Q[1]*W,M[2]=Q[2]*W,M[3]=Q[3]*W,M[4]=Q[4]*Y,M[5]=Q[5]*Y,M[6]=Q[6]*Y,M[7]=Q[7]*Y,M[8]=Q[8]*Z,M[9]=Q[9]*Z,M[10]=Q[10]*Z,M[11]=Q[11]*Z,M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15],M}function XM(M,Q,V,W){var Y=W[0],Z=W[1],K=W[2],$=Math.hypot(Y,Z,K),H,X,J,h,P,C,F,E,B,N,j,k,D,U,R,q,_,S,L,p,w,v,O,g;if($<T)return null;if($=1/$,Y*=$,Z*=$,K*=$,H=Math.sin(V),X=Math.cos(V),J=1-X,h=Q[0],P=Q[1],C=Q[2],F=Q[3],E=Q[4],B=Q[5],N=Q[6],j=Q[7],k=Q[8],D=Q[9],U=Q[10],R=Q[11],q=Y*Y*J+X,_=Z*Y*J+K*H,S=K*Y*J-Z*H,L=Y*Z*J-K*H,p=Z*Z*J+X,w=K*Z*J+Y*H,v=Y*K*J+Z*H,O=Z*K*J-Y*H,g=K*K*J+X,M[0]=h*q+E*_+k*S,M[1]=P*q+B*_+D*S,M[2]=C*q+N*_+U*S,M[3]=F*q+j*_+R*S,M[4]=h*L+E*p+k*w,M[5]=P*L+B*p+D*w,M[6]=C*L+N*p+U*w,M[7]=F*L+j*p+R*w,M[8]=h*v+E*O+k*g,M[9]=P*v+B*O+D*g,M[10]=C*v+N*O+U*g,M[11]=F*v+j*O+R*g,Q!==M)M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15];return M}function JM(M,Q,V){var W=Math.sin(V),Y=Math.cos(V),Z=Q[4],K=Q[5],$=Q[6],H=Q[7],X=Q[8],J=Q[9],h=Q[10],P=Q[11];if(Q!==M)M[0]=Q[0],M[1]=Q[1],M[2]=Q[2],M[3]=Q[3],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15];return M[4]=Z*Y+X*W,M[5]=K*Y+J*W,M[6]=$*Y+h*W,M[7]=H*Y+P*W,M[8]=X*Y-Z*W,M[9]=J*Y-K*W,M[10]=h*Y-$*W,M[11]=P*Y-H*W,M}function BM(M,Q,V){var W=Math.sin(V),Y=Math.cos(V),Z=Q[0],K=Q[1],$=Q[2],H=Q[3],X=Q[8],J=Q[9],h=Q[10],P=Q[11];if(Q!==M)M[4]=Q[4],M[5]=Q[5],M[6]=Q[6],M[7]=Q[7],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15];return M[0]=Z*Y-X*W,M[1]=K*Y-J*W,M[2]=$*Y-h*W,M[3]=H*Y-P*W,M[8]=Z*W+X*Y,M[9]=K*W+J*Y,M[10]=$*W+h*Y,M[11]=H*W+P*Y,M}function hM(M,Q,V){var W=Math.sin(V),Y=Math.cos(V),Z=Q[0],K=Q[1],$=Q[2],H=Q[3],X=Q[4],J=Q[5],h=Q[6],P=Q[7];if(Q!==M)M[8]=Q[8],M[9]=Q[9],M[10]=Q[10],M[11]=Q[11],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15];return M[0]=Z*Y+X*W,M[1]=K*Y+J*W,M[2]=$*Y+h*W,M[3]=H*Y+P*W,M[4]=X*Y-Z*W,M[5]=J*Y-K*W,M[6]=h*Y-$*W,M[7]=P*Y-H*W,M}function CM(M,Q){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=Q[0],M[13]=Q[1],M[14]=Q[2],M[15]=1,M}function PM(M,Q){return M[0]=Q[0],M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Q[1],M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=Q[2],M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function EM(M,Q,V){var W=V[0],Y=V[1],Z=V[2],K=Math.hypot(W,Y,Z),$,H,X;if(K<T)return null;return K=1/K,W*=K,Y*=K,Z*=K,$=Math.sin(Q),H=Math.cos(Q),X=1-H,M[0]=W*W*X+H,M[1]=Y*W*X+Z*$,M[2]=Z*W*X-Y*$,M[3]=0,M[4]=W*Y*X-Z*$,M[5]=Y*Y*X+H,M[6]=Z*Y*X+W*$,M[7]=0,M[8]=W*Z*X+Y*$,M[9]=Y*Z*X-W*$,M[10]=Z*Z*X+H,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function FM(M,Q){var V=Math.sin(Q),W=Math.cos(Q);return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=W,M[6]=V,M[7]=0,M[8]=0,M[9]=-V,M[10]=W,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function NM(M,Q){var V=Math.sin(Q),W=Math.cos(Q);return M[0]=W,M[1]=0,M[2]=-V,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=V,M[9]=0,M[10]=W,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function UM(M,Q){var V=Math.sin(Q),W=Math.cos(Q);return M[0]=W,M[1]=V,M[2]=0,M[3]=0,M[4]=-V,M[5]=W,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function P0(M,Q,V){var W=Q[0],Y=Q[1],Z=Q[2],K=Q[3],$=W+W,H=Y+Y,X=Z+Z,J=W*$,h=W*H,P=W*X,C=Y*H,F=Y*X,E=Z*X,B=K*$,N=K*H,j=K*X;return M[0]=1-(C+E),M[1]=h+j,M[2]=P-N,M[3]=0,M[4]=h-j,M[5]=1-(J+E),M[6]=F+B,M[7]=0,M[8]=P+N,M[9]=F-B,M[10]=1-(J+C),M[11]=0,M[12]=V[0],M[13]=V[1],M[14]=V[2],M[15]=1,M}function RM(M,Q){var V=new I(3),W=-Q[0],Y=-Q[1],Z=-Q[2],K=Q[3],$=Q[4],H=Q[5],X=Q[6],J=Q[7],h=W*W+Y*Y+Z*Z+K*K;if(h>0)V[0]=($*K+J*W+H*Z-X*Y)*2/h,V[1]=(H*K+J*Y+X*W-$*Z)*2/h,V[2]=(X*K+J*Z+$*Y-H*W)*2/h;else V[0]=($*K+J*W+H*Z-X*Y)*2,V[1]=(H*K+J*Y+X*W-$*Z)*2,V[2]=(X*K+J*Z+$*Y-H*W)*2;return P0(M,Q,V),M}function DM(M,Q){return M[0]=Q[12],M[1]=Q[13],M[2]=Q[14],M}function E0(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[4],K=Q[5],$=Q[6],H=Q[8],X=Q[9],J=Q[10];return M[0]=Math.hypot(V,W,Y),M[1]=Math.hypot(Z,K,$),M[2]=Math.hypot(H,X,J),M}function kM(M,Q){var V=new I(3);E0(V,Q);var W=1/V[0],Y=1/V[1],Z=1/V[2],K=Q[0]*W,$=Q[1]*Y,H=Q[2]*Z,X=Q[4]*W,J=Q[5]*Y,h=Q[6]*Z,P=Q[8]*W,C=Q[9]*Y,F=Q[10]*Z,E=K+J+F,B=0;if(E>0)B=Math.sqrt(E+1)*2,M[3]=0.25*B,M[0]=(h-C)/B,M[1]=(P-H)/B,M[2]=($-X)/B;else if(K>J&&K>F)B=Math.sqrt(1+K-J-F)*2,M[3]=(h-C)/B,M[0]=0.25*B,M[1]=($+X)/B,M[2]=(P+H)/B;else if(J>F)B=Math.sqrt(1+J-K-F)*2,M[3]=(P-H)/B,M[0]=($+X)/B,M[1]=0.25*B,M[2]=(h+C)/B;else B=Math.sqrt(1+F-K-J)*2,M[3]=($-X)/B,M[0]=(P+H)/B,M[1]=(h+C)/B,M[2]=0.25*B;return M}function AM(M,Q,V,W){var Y=Q[0],Z=Q[1],K=Q[2],$=Q[3],H=Y+Y,X=Z+Z,J=K+K,h=Y*H,P=Y*X,C=Y*J,F=Z*X,E=Z*J,B=K*J,N=$*H,j=$*X,k=$*J,D=W[0],U=W[1],R=W[2];return M[0]=(1-(F+B))*D,M[1]=(P+k)*D,M[2]=(C-j)*D,M[3]=0,M[4]=(P-k)*U,M[5]=(1-(h+B))*U,M[6]=(E+N)*U,M[7]=0,M[8]=(C+j)*R,M[9]=(E-N)*R,M[10]=(1-(h+F))*R,M[11]=0,M[12]=V[0],M[13]=V[1],M[14]=V[2],M[15]=1,M}function TM(M,Q,V,W,Y){var Z=Q[0],K=Q[1],$=Q[2],H=Q[3],X=Z+Z,J=K+K,h=$+$,P=Z*X,C=Z*J,F=Z*h,E=K*J,B=K*h,N=$*h,j=H*X,k=H*J,D=H*h,U=W[0],R=W[1],q=W[2],_=Y[0],S=Y[1],L=Y[2],p=(1-(E+N))*U,w=(C+D)*U,v=(F-k)*U,O=(C-D)*R,g=(1-(P+N))*R,f=(B+j)*R,c=(F+k)*q,H0=(B-j)*q,X0=(1-(P+E))*q;return M[0]=p,M[1]=w,M[2]=v,M[3]=0,M[4]=O,M[5]=g,M[6]=f,M[7]=0,M[8]=c,M[9]=H0,M[10]=X0,M[11]=0,M[12]=V[0]+_-(p*_+O*S+c*L),M[13]=V[1]+S-(w*_+g*S+H0*L),M[14]=V[2]+L-(v*_+f*S+X0*L),M[15]=1,M}function jM(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=V+V,$=W+W,H=Y+Y,X=V*K,J=W*K,h=W*$,P=Y*K,C=Y*$,F=Y*H,E=Z*K,B=Z*$,N=Z*H;return M[0]=1-h-F,M[1]=J+N,M[2]=P-B,M[3]=0,M[4]=J-N,M[5]=1-X-F,M[6]=C+E,M[7]=0,M[8]=P+B,M[9]=C-E,M[10]=1-X-h,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function OM(M,Q,V,W,Y,Z,K){var $=1/(V-Q),H=1/(Y-W),X=1/(Z-K);return M[0]=Z*2*$,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Z*2*H,M[6]=0,M[7]=0,M[8]=(V+Q)*$,M[9]=(Y+W)*H,M[10]=(K+Z)*X,M[11]=-1,M[12]=0,M[13]=0,M[14]=K*Z*2*X,M[15]=0,M}function F0(M,Q,V,W,Y){var Z=1/Math.tan(Q/2),K;if(M[0]=Z/V,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Z,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,Y!=null&&Y!==Infinity)K=1/(W-Y),M[10]=(Y+W)*K,M[14]=2*Y*W*K;else M[10]=-1,M[14]=-2*W;return M}function GM(M,Q,V,W,Y){var Z=1/Math.tan(Q/2),K;if(M[0]=Z/V,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Z,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,Y!=null&&Y!==Infinity)K=1/(W-Y),M[10]=Y*K,M[14]=Y*W*K;else M[10]=-1,M[14]=-W;return M}function _M(M,Q,V,W){var Y=Math.tan(Q.upDegrees*Math.PI/180),Z=Math.tan(Q.downDegrees*Math.PI/180),K=Math.tan(Q.leftDegrees*Math.PI/180),$=Math.tan(Q.rightDegrees*Math.PI/180),H=2/(K+$),X=2/(Y+Z);return M[0]=H,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=X,M[6]=0,M[7]=0,M[8]=-((K-$)*H*0.5),M[9]=(Y-Z)*X*0.5,M[10]=W/(V-W),M[11]=-1,M[12]=0,M[13]=0,M[14]=W*V/(V-W),M[15]=0,M}function N0(M,Q,V,W,Y,Z,K){var $=1/(Q-V),H=1/(W-Y),X=1/(Z-K);return M[0]=-2*$,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*H,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*X,M[11]=0,M[12]=(Q+V)*$,M[13]=(Y+W)*H,M[14]=(K+Z)*X,M[15]=1,M}function LM(M,Q,V,W,Y,Z,K){var $=1/(Q-V),H=1/(W-Y),X=1/(Z-K);return M[0]=-2*$,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*H,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=X,M[11]=0,M[12]=(Q+V)*$,M[13]=(Y+W)*H,M[14]=Z*X,M[15]=1,M}function qM(M,Q,V,W){var Y,Z,K,$,H,X,J,h,P,C,F=Q[0],E=Q[1],B=Q[2],N=W[0],j=W[1],k=W[2],D=V[0],U=V[1],R=V[2];if(Math.abs(F-D)<T&&Math.abs(E-U)<T&&Math.abs(B-R)<T)return h0(M);if(J=F-D,h=E-U,P=B-R,C=1/Math.hypot(J,h,P),J*=C,h*=C,P*=C,Y=j*P-k*h,Z=k*J-N*P,K=N*h-j*J,C=Math.hypot(Y,Z,K),!C)Y=0,Z=0,K=0;else C=1/C,Y*=C,Z*=C,K*=C;if($=h*K-P*Z,H=P*Y-J*K,X=J*Z-h*Y,C=Math.hypot($,H,X),!C)$=0,H=0,X=0;else C=1/C,$*=C,H*=C,X*=C;return M[0]=Y,M[1]=$,M[2]=J,M[3]=0,M[4]=Z,M[5]=H,M[6]=h,M[7]=0,M[8]=K,M[9]=X,M[10]=P,M[11]=0,M[12]=-(Y*F+Z*E+K*B),M[13]=-($*F+H*E+X*B),M[14]=-(J*F+h*E+P*B),M[15]=1,M}function pM(M,Q,V,W){var Y=Q[0],Z=Q[1],K=Q[2],$=W[0],H=W[1],X=W[2],J=Y-V[0],h=Z-V[1],P=K-V[2],C=J*J+h*h+P*P;if(C>0)C=1/Math.sqrt(C),J*=C,h*=C,P*=C;var F=H*P-X*h,E=X*J-$*P,B=$*h-H*J;if(C=F*F+E*E+B*B,C>0)C=1/Math.sqrt(C),F*=C,E*=C,B*=C;return M[0]=F,M[1]=E,M[2]=B,M[3]=0,M[4]=h*B-P*E,M[5]=P*F-J*B,M[6]=J*E-h*F,M[7]=0,M[8]=J,M[9]=h,M[10]=P,M[11]=0,M[12]=Y,M[13]=Z,M[14]=K,M[15]=1,M}function wM(M){return"mat4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+", "+M[4]+", "+M[5]+", "+M[6]+", "+M[7]+", "+M[8]+", "+M[9]+", "+M[10]+", "+M[11]+", "+M[12]+", "+M[13]+", "+M[14]+", "+M[15]+")"}function vM(M){return Math.hypot(M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],M[8],M[9],M[10],M[11],M[12],M[13],M[14],M[15])}function nM(M,Q,V){return M[0]=Q[0]+V[0],M[1]=Q[1]+V[1],M[2]=Q[2]+V[2],M[3]=Q[3]+V[3],M[4]=Q[4]+V[4],M[5]=Q[5]+V[5],M[6]=Q[6]+V[6],M[7]=Q[7]+V[7],M[8]=Q[8]+V[8],M[9]=Q[9]+V[9],M[10]=Q[10]+V[10],M[11]=Q[11]+V[11],M[12]=Q[12]+V[12],M[13]=Q[13]+V[13],M[14]=Q[14]+V[14],M[15]=Q[15]+V[15],M}function U0(M,Q,V){return M[0]=Q[0]-V[0],M[1]=Q[1]-V[1],M[2]=Q[2]-V[2],M[3]=Q[3]-V[3],M[4]=Q[4]-V[4],M[5]=Q[5]-V[5],M[6]=Q[6]-V[6],M[7]=Q[7]-V[7],M[8]=Q[8]-V[8],M[9]=Q[9]-V[9],M[10]=Q[10]-V[10],M[11]=Q[11]-V[11],M[12]=Q[12]-V[12],M[13]=Q[13]-V[13],M[14]=Q[14]-V[14],M[15]=Q[15]-V[15],M}function gM(M,Q,V){return M[0]=Q[0]*V,M[1]=Q[1]*V,M[2]=Q[2]*V,M[3]=Q[3]*V,M[4]=Q[4]*V,M[5]=Q[5]*V,M[6]=Q[6]*V,M[7]=Q[7]*V,M[8]=Q[8]*V,M[9]=Q[9]*V,M[10]=Q[10]*V,M[11]=Q[11]*V,M[12]=Q[12]*V,M[13]=Q[13]*V,M[14]=Q[14]*V,M[15]=Q[15]*V,M}function dM(M,Q,V,W){return M[0]=Q[0]+V[0]*W,M[1]=Q[1]+V[1]*W,M[2]=Q[2]+V[2]*W,M[3]=Q[3]+V[3]*W,M[4]=Q[4]+V[4]*W,M[5]=Q[5]+V[5]*W,M[6]=Q[6]+V[6]*W,M[7]=Q[7]+V[7]*W,M[8]=Q[8]+V[8]*W,M[9]=Q[9]+V[9]*W,M[10]=Q[10]+V[10]*W,M[11]=Q[11]+V[11]*W,M[12]=Q[12]+V[12]*W,M[13]=Q[13]+V[13]*W,M[14]=Q[14]+V[14]*W,M[15]=Q[15]+V[15]*W,M}function iM(M,Q){return M[0]===Q[0]&&M[1]===Q[1]&&M[2]===Q[2]&&M[3]===Q[3]&&M[4]===Q[4]&&M[5]===Q[5]&&M[6]===Q[6]&&M[7]===Q[7]&&M[8]===Q[8]&&M[9]===Q[9]&&M[10]===Q[10]&&M[11]===Q[11]&&M[12]===Q[12]&&M[13]===Q[13]&&M[14]===Q[14]&&M[15]===Q[15]}function fM(M,Q){var V=M[0],W=M[1],Y=M[2],Z=M[3],K=M[4],$=M[5],H=M[6],X=M[7],J=M[8],h=M[9],P=M[10],C=M[11],F=M[12],E=M[13],B=M[14],N=M[15],j=Q[0],k=Q[1],D=Q[2],U=Q[3],R=Q[4],q=Q[5],_=Q[6],S=Q[7],L=Q[8],p=Q[9],w=Q[10],v=Q[11],O=Q[12],g=Q[13],f=Q[14],c=Q[15];return Math.abs(V-j)<=T*Math.max(1,Math.abs(V),Math.abs(j))&&Math.abs(W-k)<=T*Math.max(1,Math.abs(W),Math.abs(k))&&Math.abs(Y-D)<=T*Math.max(1,Math.abs(Y),Math.abs(D))&&Math.abs(Z-U)<=T*Math.max(1,Math.abs(Z),Math.abs(U))&&Math.abs(K-R)<=T*Math.max(1,Math.abs(K),Math.abs(R))&&Math.abs($-q)<=T*Math.max(1,Math.abs($),Math.abs(q))&&Math.abs(H-_)<=T*Math.max(1,Math.abs(H),Math.abs(_))&&Math.abs(X-S)<=T*Math.max(1,Math.abs(X),Math.abs(S))&&Math.abs(J-L)<=T*Math.max(1,Math.abs(J),Math.abs(L))&&Math.abs(h-p)<=T*Math.max(1,Math.abs(h),Math.abs(p))&&Math.abs(P-w)<=T*Math.max(1,Math.abs(P),Math.abs(w))&&Math.abs(C-v)<=T*Math.max(1,Math.abs(C),Math.abs(v))&&Math.abs(F-O)<=T*Math.max(1,Math.abs(F),Math.abs(O))&&Math.abs(E-g)<=T*Math.max(1,Math.abs(E),Math.abs(g))&&Math.abs(B-f)<=T*Math.max(1,Math.abs(B),Math.abs(f))&&Math.abs(N-c)<=T*Math.max(1,Math.abs(N),Math.abs(c))}var IM=F0,SM=N0,cM=C0,lM=U0;var y={};o(y,{str:()=>{{return dQ}},squaredLength:()=>{{return r0}},sqrLen:()=>{{return sQ}},sqlerp:()=>{{return uQ}},slerp:()=>{{return u}},setAxisAngle:()=>{{return f0}},setAxes:()=>{{return oQ}},set:()=>{{return lQ}},scale:()=>{{return y0}},rotationTo:()=>{{return bQ}},rotateZ:()=>{{return LQ}},rotateY:()=>{{return SQ}},rotateX:()=>{{return _Q}},random:()=>{{return wQ}},pow:()=>{{return pQ}},normalize:()=>{{return K0}},multiply:()=>{{return c0}},mul:()=>{{return xQ}},ln:()=>{{return z0}},lerp:()=>{{return yQ}},length:()=>{{return s0}},len:()=>{{return mQ}},invert:()=>{{return vQ}},identity:()=>{{return OQ}},getAxisAngle:()=>{{return IQ}},getAngle:()=>{{return GQ}},fromValues:()=>{{return fQ}},fromMat3:()=>{{return x0}},fromEuler:()=>{{return gQ}},exp:()=>{{return l0}},exactEquals:()=>{{return rQ}},equals:()=>{{return eQ}},dot:()=>{{return m0}},create:()=>{{return Z0}},copy:()=>{{return cQ}},conjugate:()=>{{return nQ}},clone:()=>{{return iQ}},calculateW:()=>{{return qQ}},add:()=>{{return zQ}}});var i={};o(i,{zero:()=>{{return hQ}},transformQuat:()=>{{return $Q}},transformMat4:()=>{{return ZQ}},transformMat3:()=>{{return KQ}},subtract:()=>{{return D0}},sub:()=>{{return FQ}},str:()=>{{return CQ}},squaredLength:()=>{{return O0}},squaredDistance:()=>{{return j0}},sqrLen:()=>{{return kQ}},sqrDist:()=>{{return DQ}},set:()=>{{return yM}},scaleAndAdd:()=>{{return tM}},scale:()=>{{return oM}},round:()=>{{return uM}},rotateZ:()=>{{return JQ}},rotateY:()=>{{return XQ}},rotateX:()=>{{return HQ}},random:()=>{{return YQ}},normalize:()=>{{return W0}},negate:()=>{{return aM}},multiply:()=>{{return k0}},mul:()=>{{return NQ}},min:()=>{{return eM}},max:()=>{{return bM}},lerp:()=>{{return QQ}},length:()=>{{return R0}},len:()=>{{return Y0}},inverse:()=>{{return MQ}},hermite:()=>{{return VQ}},fromValues:()=>{{return e}},forEach:()=>{{return AQ}},floor:()=>{{return rM}},exactEquals:()=>{{return PQ}},equals:()=>{{return EQ}},dot:()=>{{return b}},divide:()=>{{return A0}},div:()=>{{return UQ}},distance:()=>{{return T0}},dist:()=>{{return RQ}},cross:()=>{{return x}},create:()=>{{return r}},copy:()=>{{return xM}},clone:()=>{{return zM}},ceil:()=>{{return sM}},bezier:()=>{{return WQ}},angle:()=>{{return BQ}},add:()=>{{return mM}}});function r(){var M=new I(3);if(I!=Float32Array)M[0]=0,M[1]=0,M[2]=0;return M}function zM(M){var Q=new I(3);return Q[0]=M[0],Q[1]=M[1],Q[2]=M[2],Q}function R0(M){var Q=M[0],V=M[1],W=M[2];return Math.hypot(Q,V,W)}function e(M,Q,V){var W=new I(3);return W[0]=M,W[1]=Q,W[2]=V,W}function xM(M,Q){return M[0]=Q[0],M[1]=Q[1],M[2]=Q[2],M}function yM(M,Q,V,W){return M[0]=Q,M[1]=V,M[2]=W,M}function mM(M,Q,V){return M[0]=Q[0]+V[0],M[1]=Q[1]+V[1],M[2]=Q[2]+V[2],M}function D0(M,Q,V){return M[0]=Q[0]-V[0],M[1]=Q[1]-V[1],M[2]=Q[2]-V[2],M}function k0(M,Q,V){return M[0]=Q[0]*V[0],M[1]=Q[1]*V[1],M[2]=Q[2]*V[2],M}function A0(M,Q,V){return M[0]=Q[0]/V[0],M[1]=Q[1]/V[1],M[2]=Q[2]/V[2],M}function sM(M,Q){return M[0]=Math.ceil(Q[0]),M[1]=Math.ceil(Q[1]),M[2]=Math.ceil(Q[2]),M}function rM(M,Q){return M[0]=Math.floor(Q[0]),M[1]=Math.floor(Q[1]),M[2]=Math.floor(Q[2]),M}function eM(M,Q,V){return M[0]=Math.min(Q[0],V[0]),M[1]=Math.min(Q[1],V[1]),M[2]=Math.min(Q[2],V[2]),M}function bM(M,Q,V){return M[0]=Math.max(Q[0],V[0]),M[1]=Math.max(Q[1],V[1]),M[2]=Math.max(Q[2],V[2]),M}function uM(M,Q){return M[0]=Math.round(Q[0]),M[1]=Math.round(Q[1]),M[2]=Math.round(Q[2]),M}function oM(M,Q,V){return M[0]=Q[0]*V,M[1]=Q[1]*V,M[2]=Q[2]*V,M}function tM(M,Q,V,W){return M[0]=Q[0]+V[0]*W,M[1]=Q[1]+V[1]*W,M[2]=Q[2]+V[2]*W,M}function T0(M,Q){var V=Q[0]-M[0],W=Q[1]-M[1],Y=Q[2]-M[2];return Math.hypot(V,W,Y)}function j0(M,Q){var V=Q[0]-M[0],W=Q[1]-M[1],Y=Q[2]-M[2];return V*V+W*W+Y*Y}function O0(M){var Q=M[0],V=M[1],W=M[2];return Q*Q+V*V+W*W}function aM(M,Q){return M[0]=-Q[0],M[1]=-Q[1],M[2]=-Q[2],M}function MQ(M,Q){return M[0]=1/Q[0],M[1]=1/Q[1],M[2]=1/Q[2],M}function W0(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=V*V+W*W+Y*Y;if(Z>0)Z=1/Math.sqrt(Z);return M[0]=Q[0]*Z,M[1]=Q[1]*Z,M[2]=Q[2]*Z,M}function b(M,Q){return M[0]*Q[0]+M[1]*Q[1]+M[2]*Q[2]}function x(M,Q,V){var W=Q[0],Y=Q[1],Z=Q[2],K=V[0],$=V[1],H=V[2];return M[0]=Y*H-Z*$,M[1]=Z*K-W*H,M[2]=W*$-Y*K,M}function QQ(M,Q,V,W){var Y=Q[0],Z=Q[1],K=Q[2];return M[0]=Y+W*(V[0]-Y),M[1]=Z+W*(V[1]-Z),M[2]=K+W*(V[2]-K),M}function VQ(M,Q,V,W,Y,Z){var K=Z*Z,$=K*(2*Z-3)+1,H=K*(Z-2)+Z,X=K*(Z-1),J=K*(3-2*Z);return M[0]=Q[0]*$+V[0]*H+W[0]*X+Y[0]*J,M[1]=Q[1]*$+V[1]*H+W[1]*X+Y[1]*J,M[2]=Q[2]*$+V[2]*H+W[2]*X+Y[2]*J,M}function WQ(M,Q,V,W,Y,Z){var K=1-Z,$=K*K,H=Z*Z,X=$*K,J=3*Z*$,h=3*H*K,P=H*Z;return M[0]=Q[0]*X+V[0]*J+W[0]*h+Y[0]*P,M[1]=Q[1]*X+V[1]*J+W[1]*h+Y[1]*P,M[2]=Q[2]*X+V[2]*J+W[2]*h+Y[2]*P,M}function YQ(M,Q){Q=Q||1;var V=d()*2*Math.PI,W=d()*2-1,Y=Math.sqrt(1-W*W)*Q;return M[0]=Math.cos(V)*Y,M[1]=Math.sin(V)*Y,M[2]=W*Q,M}function ZQ(M,Q,V){var W=Q[0],Y=Q[1],Z=Q[2],K=V[3]*W+V[7]*Y+V[11]*Z+V[15];return K=K||1,M[0]=(V[0]*W+V[4]*Y+V[8]*Z+V[12])/K,M[1]=(V[1]*W+V[5]*Y+V[9]*Z+V[13])/K,M[2]=(V[2]*W+V[6]*Y+V[10]*Z+V[14])/K,M}function KQ(M,Q,V){var W=Q[0],Y=Q[1],Z=Q[2];return M[0]=W*V[0]+Y*V[3]+Z*V[6],M[1]=W*V[1]+Y*V[4]+Z*V[7],M[2]=W*V[2]+Y*V[5]+Z*V[8],M}function $Q(M,Q,V){var W=V[0],Y=V[1],Z=V[2],K=V[3],$=Q[0],H=Q[1],X=Q[2],J=Y*X-Z*H,h=Z*$-W*X,P=W*H-Y*$,C=Y*P-Z*h,F=Z*J-W*P,E=W*h-Y*J,B=K*2;return J*=B,h*=B,P*=B,C*=2,F*=2,E*=2,M[0]=$+J+C,M[1]=H+h+F,M[2]=X+P+E,M}function HQ(M,Q,V,W){var Y=[],Z=[];return Y[0]=Q[0]-V[0],Y[1]=Q[1]-V[1],Y[2]=Q[2]-V[2],Z[0]=Y[0],Z[1]=Y[1]*Math.cos(W)-Y[2]*Math.sin(W),Z[2]=Y[1]*Math.sin(W)+Y[2]*Math.cos(W),M[0]=Z[0]+V[0],M[1]=Z[1]+V[1],M[2]=Z[2]+V[2],M}function XQ(M,Q,V,W){var Y=[],Z=[];return Y[0]=Q[0]-V[0],Y[1]=Q[1]-V[1],Y[2]=Q[2]-V[2],Z[0]=Y[2]*Math.sin(W)+Y[0]*Math.cos(W),Z[1]=Y[1],Z[2]=Y[2]*Math.cos(W)-Y[0]*Math.sin(W),M[0]=Z[0]+V[0],M[1]=Z[1]+V[1],M[2]=Z[2]+V[2],M}function JQ(M,Q,V,W){var Y=[],Z=[];return Y[0]=Q[0]-V[0],Y[1]=Q[1]-V[1],Y[2]=Q[2]-V[2],Z[0]=Y[0]*Math.cos(W)-Y[1]*Math.sin(W),Z[1]=Y[0]*Math.sin(W)+Y[1]*Math.cos(W),Z[2]=Y[2],M[0]=Z[0]+V[0],M[1]=Z[1]+V[1],M[2]=Z[2]+V[2],M}function BQ(M,Q){var V=M[0],W=M[1],Y=M[2],Z=Q[0],K=Q[1],$=Q[2],H=Math.sqrt(V*V+W*W+Y*Y),X=Math.sqrt(Z*Z+K*K+$*$),J=H*X,h=J&&b(M,Q)/J;return Math.acos(Math.min(Math.max(h,-1),1))}function hQ(M){return M[0]=0,M[1]=0,M[2]=0,M}function CQ(M){return"vec3("+M[0]+", "+M[1]+", "+M[2]+")"}function PQ(M,Q){return M[0]===Q[0]&&M[1]===Q[1]&&M[2]===Q[2]}function EQ(M,Q){var V=M[0],W=M[1],Y=M[2],Z=Q[0],K=Q[1],$=Q[2];return Math.abs(V-Z)<=T*Math.max(1,Math.abs(V),Math.abs(Z))&&Math.abs(W-K)<=T*Math.max(1,Math.abs(W),Math.abs(K))&&Math.abs(Y-$)<=T*Math.max(1,Math.abs(Y),Math.abs($))}var FQ=D0,NQ=k0,UQ=A0,RQ=T0,DQ=j0,Y0=R0,kQ=O0,AQ=function(){var M=r();return function(Q,V,W,Y,Z,K){var $,H;if(!V)V=3;if(!W)W=0;if(Y)H=Math.min(Y*V+W,Q.length);else H=Q.length;for($=W;$<H;$+=V)M[0]=Q[$],M[1]=Q[$+1],M[2]=Q[$+2],Z(M,M,K),Q[$]=M[0],Q[$+1]=M[1],Q[$+2]=M[2];return Q}}();function TQ(){var M=new I(4);if(I!=Float32Array)M[0]=0,M[1]=0,M[2]=0,M[3]=0;return M}function I0(M){var Q=new I(4);return Q[0]=M[0],Q[1]=M[1],Q[2]=M[2],Q[3]=M[3],Q}function G0(M,Q,V,W){var Y=new I(4);return Y[0]=M,Y[1]=Q,Y[2]=V,Y[3]=W,Y}function _0(M,Q){return M[0]=Q[0],M[1]=Q[1],M[2]=Q[2],M[3]=Q[3],M}function S0(M,Q,V,W,Y){return M[0]=Q,M[1]=V,M[2]=W,M[3]=Y,M}function L0(M,Q,V){return M[0]=Q[0]+V[0],M[1]=Q[1]+V[1],M[2]=Q[2]+V[2],M[3]=Q[3]+V[3],M}function q0(M,Q,V){return M[0]=Q[0]*V,M[1]=Q[1]*V,M[2]=Q[2]*V,M[3]=Q[3]*V,M}function p0(M){var Q=M[0],V=M[1],W=M[2],Y=M[3];return Math.hypot(Q,V,W,Y)}function w0(M){var Q=M[0],V=M[1],W=M[2],Y=M[3];return Q*Q+V*V+W*W+Y*Y}function v0(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=V*V+W*W+Y*Y+Z*Z;if(K>0)K=1/Math.sqrt(K);return M[0]=V*K,M[1]=W*K,M[2]=Y*K,M[3]=Z*K,M}function n0(M,Q){return M[0]*Q[0]+M[1]*Q[1]+M[2]*Q[2]+M[3]*Q[3]}function g0(M,Q,V,W){var Y=Q[0],Z=Q[1],K=Q[2],$=Q[3];return M[0]=Y+W*(V[0]-Y),M[1]=Z+W*(V[1]-Z),M[2]=K+W*(V[2]-K),M[3]=$+W*(V[3]-$),M}function d0(M,Q){return M[0]===Q[0]&&M[1]===Q[1]&&M[2]===Q[2]&&M[3]===Q[3]}function i0(M,Q){var V=M[0],W=M[1],Y=M[2],Z=M[3],K=Q[0],$=Q[1],H=Q[2],X=Q[3];return Math.abs(V-K)<=T*Math.max(1,Math.abs(V),Math.abs(K))&&Math.abs(W-$)<=T*Math.max(1,Math.abs(W),Math.abs($))&&Math.abs(Y-H)<=T*Math.max(1,Math.abs(Y),Math.abs(H))&&Math.abs(Z-X)<=T*Math.max(1,Math.abs(Z),Math.abs(X))}var FV=function(){var M=TQ();return function(Q,V,W,Y,Z,K){var $,H;if(!V)V=4;if(!W)W=0;if(Y)H=Math.min(Y*V+W,Q.length);else H=Q.length;for($=W;$<H;$+=V)M[0]=Q[$],M[1]=Q[$+1],M[2]=Q[$+2],M[3]=Q[$+3],Z(M,M,K),Q[$]=M[0],Q[$+1]=M[1],Q[$+2]=M[2],Q[$+3]=M[3];return Q}}();function Z0(){var M=new I(4);if(I!=Float32Array)M[0]=0,M[1]=0,M[2]=0;return M[3]=1,M}function OQ(M){return M[0]=0,M[1]=0,M[2]=0,M[3]=1,M}function f0(M,Q,V){V=V*0.5;var W=Math.sin(V);return M[0]=W*Q[0],M[1]=W*Q[1],M[2]=W*Q[2],M[3]=Math.cos(V),M}function IQ(M,Q){var V=Math.acos(Q[3])*2,W=Math.sin(V/2);if(W>T)M[0]=Q[0]/W,M[1]=Q[1]/W,M[2]=Q[2]/W;else M[0]=1,M[1]=0,M[2]=0;return V}function GQ(M,Q){var V=m0(M,Q);return Math.acos(2*V*V-1)}function c0(M,Q,V){var W=Q[0],Y=Q[1],Z=Q[2],K=Q[3],$=V[0],H=V[1],X=V[2],J=V[3];return M[0]=W*J+K*$+Y*X-Z*H,M[1]=Y*J+K*H+Z*$-W*X,M[2]=Z*J+K*X+W*H-Y*$,M[3]=K*J-W*$-Y*H-Z*X,M}function _Q(M,Q,V){V*=0.5;var W=Q[0],Y=Q[1],Z=Q[2],K=Q[3],$=Math.sin(V),H=Math.cos(V);return M[0]=W*H+K*$,M[1]=Y*H+Z*$,M[2]=Z*H-Y*$,M[3]=K*H-W*$,M}function SQ(M,Q,V){V*=0.5;var W=Q[0],Y=Q[1],Z=Q[2],K=Q[3],$=Math.sin(V),H=Math.cos(V);return M[0]=W*H-Z*$,M[1]=Y*H+K*$,M[2]=Z*H+W*$,M[3]=K*H-Y*$,M}function LQ(M,Q,V){V*=0.5;var W=Q[0],Y=Q[1],Z=Q[2],K=Q[3],$=Math.sin(V),H=Math.cos(V);return M[0]=W*H+Y*$,M[1]=Y*H-W*$,M[2]=Z*H+K*$,M[3]=K*H-Z*$,M}function qQ(M,Q){var V=Q[0],W=Q[1],Y=Q[2];return M[0]=V,M[1]=W,M[2]=Y,M[3]=Math.sqrt(Math.abs(1-V*V-W*W-Y*Y)),M}function l0(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=Math.sqrt(V*V+W*W+Y*Y),$=Math.exp(Z),H=K>0?$*Math.sin(K)/K:0;return M[0]=V*H,M[1]=W*H,M[2]=Y*H,M[3]=$*Math.cos(K),M}function z0(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=Math.sqrt(V*V+W*W+Y*Y),$=K>0?Math.atan2(K,Z)/K:0;return M[0]=V*$,M[1]=W*$,M[2]=Y*$,M[3]=0.5*Math.log(V*V+W*W+Y*Y+Z*Z),M}function pQ(M,Q,V){return z0(M,Q),y0(M,M,V),l0(M,M),M}function u(M,Q,V,W){var Y=Q[0],Z=Q[1],K=Q[2],$=Q[3],H=V[0],X=V[1],J=V[2],h=V[3],P,C,F,E,B;if(C=Y*H+Z*X+K*J+$*h,C<0)C=-C,H=-H,X=-X,J=-J,h=-h;if(1-C>T)P=Math.acos(C),F=Math.sin(P),E=Math.sin((1-W)*P)/F,B=Math.sin(W*P)/F;else E=1-W,B=W;return M[0]=E*Y+B*H,M[1]=E*Z+B*X,M[2]=E*K+B*J,M[3]=E*$+B*h,M}function wQ(M){var Q=d(),V=d(),W=d(),Y=Math.sqrt(1-Q),Z=Math.sqrt(Q);return M[0]=Y*Math.sin(2*Math.PI*V),M[1]=Y*Math.cos(2*Math.PI*V),M[2]=Z*Math.sin(2*Math.PI*W),M[3]=Z*Math.cos(2*Math.PI*W),M}function vQ(M,Q){var V=Q[0],W=Q[1],Y=Q[2],Z=Q[3],K=V*V+W*W+Y*Y+Z*Z,$=K?1/K:0;return M[0]=-V*$,M[1]=-W*$,M[2]=-Y*$,M[3]=Z*$,M}function nQ(M,Q){return M[0]=-Q[0],M[1]=-Q[1],M[2]=-Q[2],M[3]=Q[3],M}function x0(M,Q){var V=Q[0]+Q[4]+Q[8],W;if(V>0)W=Math.sqrt(V+1),M[3]=0.5*W,W=0.5/W,M[0]=(Q[5]-Q[7])*W,M[1]=(Q[6]-Q[2])*W,M[2]=(Q[1]-Q[3])*W;else{var Y=0;if(Q[4]>Q[0])Y=1;if(Q[8]>Q[Y*3+Y])Y=2;var Z=(Y+1)%3,K=(Y+2)%3;W=Math.sqrt(Q[Y*3+Y]-Q[Z*3+Z]-Q[K*3+K]+1),M[Y]=0.5*W,W=0.5/W,M[3]=(Q[Z*3+K]-Q[K*3+Z])*W,M[Z]=(Q[Z*3+Y]+Q[Y*3+Z])*W,M[K]=(Q[K*3+Y]+Q[Y*3+K])*W}return M}function gQ(M,Q,V,W){var Y=0.5*Math.PI/180;Q*=Y,V*=Y,W*=Y;var Z=Math.sin(Q),K=Math.cos(Q),$=Math.sin(V),H=Math.cos(V),X=Math.sin(W),J=Math.cos(W);return M[0]=Z*H*J-K*$*X,M[1]=K*$*J+Z*H*X,M[2]=K*H*X-Z*$*J,M[3]=K*H*J+Z*$*X,M}function dQ(M){return"quat("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+")"}var iQ=I0,fQ=G0,cQ=_0,lQ=S0,zQ=L0,xQ=c0,y0=q0,m0=n0,yQ=g0,s0=p0,mQ=s0,r0=w0,sQ=r0,K0=v0,rQ=d0,eQ=i0,bQ=function(){var M=r(),Q=e(1,0,0),V=e(0,1,0);return function(W,Y,Z){var K=b(Y,Z);if(K<-0.999999){if(x(M,Q,Y),Y0(M)<0.000001)x(M,V,Y);return W0(M,M),f0(W,M,Math.PI),W}else if(K>0.999999)return W[0]=0,W[1]=0,W[2]=0,W[3]=1,W;else return x(M,Y,Z),W[0]=M[0],W[1]=M[1],W[2]=M[2],W[3]=1+K,K0(W,W)}}(),uQ=function(){var M=Z0(),Q=Z0();return function(V,W,Y,Z,K,$){return u(M,W,K,$),u(Q,Y,Z,$),u(V,M,Q,2*$*(1-$)),V}}(),oQ=function(){var M=B0();return function(Q,V,W,Y){return M[0]=W[0],M[3]=W[1],M[6]=W[2],M[1]=Y[0],M[4]=Y[1],M[7]=Y[2],M[2]=-V[0],M[5]=-V[1],M[8]=-V[2],K0(Q,x0(Q,M))}}();var MV=function(M){if(!aQ)return M;return new Proxy(M,{get(V,W){const Y=V,Z=Y[W];if(typeof Z==="function")return(...$)=>{const H=Z.apply(Y,$);return console.log(`gl.${String(W)}(`,$,") = ",H),H};else return console.log(`gl.${String(W)} = `,Z),Z}})},tQ={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},G=WebGL2RenderingContext;var aQ=!1;class $0 extends n{gl;programs;attributeBuffers;uniforms;cameraMatrix;camTurnMatrix;perspectiveMatrix;orthoMatrix;projectionMatrix;constructor(M,Q){super();this.gl=MV(M.getContext("webgl2",{...tQ,...Q})),this.programs=this.own(new a(this.gl)),this.attributeBuffers=this.own(new Q0(this.gl,this.programs)),this.uniforms=this.own(new V0(this.gl,this.programs)),this.cameraMatrix=A.translate(A.create(),A.identity(A.create()),i.fromValues(0,0,-1)),this.camTurnMatrix=A.identity(A.create()),this.perspectiveMatrix=A.identity(A.create()),this.orthoMatrix=A.identity(A.create()),this.projectionMatrix=A.identity(A.create())}initialize(){this.gl.enable(G.DEPTH_TEST),this.gl.depthFunc(G.LEQUAL),this.gl.enable(G.BLEND),this.gl.blendFunc(G.SRC_ALPHA,G.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);{this.attributeBuffers.createBuffer(m);const Q=this.attributeBuffers.getAttributeBuffer(m);this.attributeBuffers.bindBuffer(G.ELEMENT_ARRAY_BUFFER,Q),this.attributeBuffers.bufferData(G.ELEMENT_ARRAY_BUFFER,m,Uint16Array.from([0,1,2,3,0,2]),0,G.STATIC_DRAW)}{this.attributeBuffers.createBuffer(l);const Q=this.attributeBuffers.getAttributeBuffer(l);this.attributeBuffers.bindBuffer(G.ARRAY_BUFFER,Q),this.gl.vertexAttribPointer(Q.location,3,G.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(Q.location),this.attributeBuffers.bufferData(G.ARRAY_BUFFER,l,Float32Array.from([1,1,0,1,-1,0,-1,-1,0,-1,1,0]),0,G.STATIC_DRAW)}{this.attributeBuffers.createBuffer(s);const Q=this.attributeBuffers.getAttributeBuffer(s);this.attributeBuffers.bindBuffer(G.ARRAY_BUFFER,Q);for(let V=0;V<4;V++){const W=Q.location+V;this.gl.vertexAttribPointer(W,4,G.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,V*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(W),this.gl.vertexAttribDivisor(W,1)}this.attributeBuffers.bufferData(G.ARRAY_BUFFER,s,Float32Array.from([...A.fromYRotation(A.create(),Math.PI/4),...A.fromYRotation(A.create(),Math.PI/2),...A.identity(A.create())]),0,G.DYNAMIC_DRAW)}const M=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;{const Q=Math.PI/90;this.perspectiveMatrix=A.perspective(A.create(),45*Q,M,0,1e4)}this.orthoMatrix=A.ortho(A.create(),-1*M,1*M,-1,1,-100,100),this.setPerspective(1),this.refreshCam()}refreshCam(){const M=A.identity(A.create());A.mul(M,this.cameraMatrix,M),A.mul(M,this.camTurnMatrix,M),A.mul(M,this.projectionMatrix,M);const Q=this.uniforms.getUniformLocation(J0);if(Q)this.gl.uniformMatrix4fv(Q,!1,M)}updateTrianglePosition(M,Q){const V=this.attributeBuffers.getAttributeBuffer(l);this.attributeBuffers.bindBuffer(G.ARRAY_BUFFER,V),this.attributeBuffers.bufferSubData(G.ARRAY_BUFFER,Float32Array.from(Q),M*4*3*Float32Array.BYTES_PER_ELEMENT)}setPerspective(M){const Q=A.create();A.multiplyScalar(Q,this.orthoMatrix,1-M);const V=A.create();A.multiplyScalar(V,this.perspectiveMatrix,M),A.copy(this.projectionMatrix,Q),A.add(this.projectionMatrix,this.projectionMatrix,V),this.refreshCam()}moveCam(M,Q){const V=y.create();A.getRotation(V,this.camTurnMatrix),y.invert(V,V);const W=i.fromValues(-M,0,Q);i.transformQuat(W,W,V),A.translate(this.cameraMatrix,this.cameraMatrix,W),this.refreshCam()}turnCam(M){A.rotateY(this.camTurnMatrix,this.camTurnMatrix,M),this.refreshCam()}drawArrays(M){this.gl.drawArrays(G.TRIANGLES,0,M)}drawElementsInstanced(M,Q){this.gl.clear(G.COLOR_BUFFER_BIT|G.DEPTH_BUFFER_BIT),this.gl.drawElementsInstanced(G.TRIANGLES,M,G.UNSIGNED_SHORT,0,Q)}bindVertexArray(){this.own(new M0(this.gl))}}function GV(){console.log("Hello World!")}function _V(M){M.style.border=".5px solid silver";const Q=new $0(M);window.engine=Q,Q.programs.addProgram("test",`
            #version 300 es

            precision highp float;
            
            layout (location=0) in vec4 position;
            layout (location=1) in mat4 transform;

            uniform mat4 cam;

            void main() {
                gl_Position = cam * transform * position;
            }
        `,`
            #version 300 es

            precision highp float;
            out vec4 fragColor;
            
            void main() {
                fragColor = vec4(1.0, 0.0, 0.0, 0.5);
            }
        `),Q.programs.useProgram("test"),Q.initialize(),Q.drawElementsInstanced(6,2);const V={};document.addEventListener("keydown",(Y)=>{V[Y.code]=!0}),document.addEventListener("keyup",(Y)=>{V[Y.code]=!1});function W(){if(V.KeyW)Q.moveCam(0,0.25);if(V.KeyS)Q.moveCam(0,-0.25);if(V.KeyA)Q.moveCam(-0.25,0);if(V.KeyD)Q.moveCam(0.25,0);if(V.KeyQ)Q.turnCam(-0.05);if(V.KeyE)Q.turnCam(0.05);Q.drawElementsInstanced(6,3),requestAnimationFrame(W)}return W(),Q}export{_V as testCanvas,GV as hello};

//# debugId=67A26C447F750CD564756e2164756e21
