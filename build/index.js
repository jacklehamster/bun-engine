var t0=Object.defineProperty;var b=(Q,K)=>{for(var $ in K)t0(Q,$,{get:K[$],enumerable:!0,configurable:!0,set:(Z)=>K[$]=()=>Z})};class n{disposables;own(Q){if(!this.disposables)this.disposables=new Set;return this.disposables.add(Q),Q}addOnDestroy(Q){this.disposables?.add({destroy:Q})}destroy(){this.disposables?.forEach((Q)=>Q.destroy())}}var a0=function(Q,K,$){function Z(X,B){function E(H){return H===Q?.VERTEX_SHADER?"vertex":H===Q?.FRAGMENT_SHADER?"fragment":void 0}if(B!==Q.VERTEX_SHADER&&B!==Q.FRAGMENT_SHADER)throw new Error(`Shader error in ${E(B)}`);const P=Q.createShader(B);if(!P)throw new Error(`Unable to generate ${E(B)} shader.`);if(Q.shaderSource(P,X),Q.compileShader(P),!Q.getShaderParameter(P,Q.COMPILE_STATUS))console.error(`Shader compile error in ${E(B)}:`+Q.getShaderInfoLog(P));return P}const C=Q.createProgram();if(!C)throw new Error("Unable to create program.");const J=Z(K,Q.VERTEX_SHADER),Y=Z($,Q.FRAGMENT_SHADER),N=Q.getShaderInfoLog(J),V=Q.getShaderInfoLog(Y);if(N)console.log("VERTEX",N);if(V)console.log("FRAGMENT",V);Q.attachShader(C,J),Q.attachShader(C,Y),Q.linkProgram(C);const M=Q.getProgramInfoLog(C);if(M)console.log("PROGRAM",M);if(Q.detachShader(C,J),Q.detachShader(C,Y),Q.deleteShader(J),Q.deleteShader(Y),Q.validateProgram(C),Object.entries(WebGL2RenderingContext).forEach(([X,B])=>{if(B&&Q.getError()===B)console.log(`gl.${X}`)}),!Q.getProgramParameter(C,Q.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+Q.getProgramInfoLog(C));return C},QQ=function(Q,K){Q.deleteProgram(K)};class u extends n{gl;program;constructor(Q,K,$){super();this.gl=Q,this.program=a0(Q,K.trim(),$.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),QQ(this.gl,this.program)}}class o extends n{activeProgramId="";gl;programs={};constructor(Q){super();this.gl=Q}addProgram(Q,K,$){if(this.programs[Q])this.removeProgram(Q);this.programs[Q]=this.own(new u(this.gl,K,$))}useProgram(Q){if(this.activeProgramId!==Q)this.activeProgramId=Q,this.programs[Q].use()}removeProgram(Q){this.programs[Q].destroy(),delete this.programs[Q]}getProgram(Q){return this.programs[Q??this.activeProgramId]?.program}}class t extends n{gl;triangleArray;constructor(Q){super();this.gl=Q,this.triangleArray=Q.createVertexArray(),Q.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class a extends n{bufferRecord={};lastBoundBuffer;gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getAttributeLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getAttribLocation($,Q)??-1:-1}createBuffer(Q){this.deleteBuffer(Q);const K=this.gl?.createBuffer();if(!K)throw new Error(`Unable to create buffer "${Q}"`);const $={buffer:K,location:this.getAttributeLocation(Q)};return this.bufferRecord[Q]=$,$}deleteBuffer(Q){if(this.bufferRecord[Q])this.gl.deleteBuffer(this.bufferRecord[Q].buffer),delete this.bufferRecord[Q]}getAttributeBuffer(Q,K){const $=this.bufferRecord[Q];if(!$){if(K)return this.createBuffer(Q);throw new Error(`Attribute "${Q}" not created. Make sure "createBuffer" is called.`)}return $}bufferData(Q,K,$,Z,C){const J=this.getAttributeBuffer(K);if($)this.gl.bufferData(Q,$,C);else this.gl.bufferData(Q,Z,C);J.bufferSize=Z||$?.length,J.bufferArray=$??new Float32Array(J.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),J.usage=C,J.target=Q}bufferSubData(Q,K,$,Z,C){if(Z)this.gl.bufferSubData(Q,$,K,Z,C);else this.gl.bufferSubData(Q,$,K)}bindBuffer(Q,K){if(this.lastBoundBuffer!==K)this.lastBoundBuffer=K,this.gl.bindBuffer(Q,K.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((Q)=>this.deleteBuffer(Q))}}class Q0 extends n{gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getUniformLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getUniformLocation($,Q)??void 0:void 0}}var K0="position",X0="index",B0="transform",F0="tex",P0="cam";var R=0.000001,G=typeof Float32Array!=="undefined"?Float32Array:Array,f=Math.random,T$=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var Q=0,K=arguments.length;while(K--)Q+=arguments[K]*arguments[K];return Math.sqrt(Q)};function E0(){var Q=new G(9);if(G!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[5]=0,Q[6]=0,Q[7]=0;return Q[0]=1,Q[4]=1,Q[8]=1,Q}var k={};b(k,{transpose:()=>{{return NQ}},translate:()=>{{return BQ}},targetTo:()=>{{return gQ}},subtract:()=>{{return A0}},sub:()=>{{return mQ}},str:()=>{{return fQ}},set:()=>{{return YQ}},scale:()=>{{return FQ}},rotateZ:()=>{{return HQ}},rotateY:()=>{{return WQ}},rotateX:()=>{{return EQ}},rotate:()=>{{return PQ}},perspectiveZO:()=>{{return qQ}},perspectiveNO:()=>{{return O0}},perspectiveFromFieldOfView:()=>{{return pQ}},perspective:()=>{{return IQ}},orthoZO:()=>{{return vQ}},orthoNO:()=>{{return T0}},ortho:()=>{{return wQ}},multiplyScalarAndAdd:()=>{{return lQ}},multiplyScalar:()=>{{return iQ}},multiply:()=>{{return H0}},mul:()=>{{return cQ}},lookAt:()=>{{return nQ}},invert:()=>{{return VQ}},identity:()=>{{return W0}},getTranslation:()=>{{return hQ}},getScaling:()=>{{return D0}},getRotation:()=>{{return jQ}},frustum:()=>{{return LQ}},fromZRotation:()=>{{return kQ}},fromYRotation:()=>{{return AQ}},fromXRotation:()=>{{return TQ}},fromValues:()=>{{return JQ}},fromTranslation:()=>{{return UQ}},fromScaling:()=>{{return DQ}},fromRotationTranslationScaleOrigin:()=>{{return GQ}},fromRotationTranslationScale:()=>{{return _Q}},fromRotationTranslation:()=>{{return U0}},fromRotation:()=>{{return OQ}},fromQuat2:()=>{{return RQ}},fromQuat:()=>{{return SQ}},frob:()=>{{return zQ}},exactEquals:()=>{{return yQ}},equals:()=>{{return xQ}},determinant:()=>{{return XQ}},create:()=>{{return $Q}},copy:()=>{{return CQ}},clone:()=>{{return ZQ}},adjoint:()=>{{return MQ}},add:()=>{{return dQ}}});function $Q(){var Q=new G(16);if(G!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0;return Q[0]=1,Q[5]=1,Q[10]=1,Q[15]=1,Q}function ZQ(Q){var K=new G(16);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function CQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function JQ(Q,K,$,Z,C,J,Y,N,V,M,X,B,E,P,H,W){var F=new G(16);return F[0]=Q,F[1]=K,F[2]=$,F[3]=Z,F[4]=C,F[5]=J,F[6]=Y,F[7]=N,F[8]=V,F[9]=M,F[10]=X,F[11]=B,F[12]=E,F[13]=P,F[14]=H,F[15]=W,F}function YQ(Q,K,$,Z,C,J,Y,N,V,M,X,B,E,P,H,W,F){return Q[0]=K,Q[1]=$,Q[2]=Z,Q[3]=C,Q[4]=J,Q[5]=Y,Q[6]=N,Q[7]=V,Q[8]=M,Q[9]=X,Q[10]=B,Q[11]=E,Q[12]=P,Q[13]=H,Q[14]=W,Q[15]=F,Q}function W0(Q){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function NQ(Q,K){if(Q===K){var $=K[1],Z=K[2],C=K[3],J=K[6],Y=K[7],N=K[11];Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=$,Q[6]=K[9],Q[7]=K[13],Q[8]=Z,Q[9]=J,Q[11]=K[14],Q[12]=C,Q[13]=Y,Q[14]=N}else Q[0]=K[0],Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=K[1],Q[5]=K[5],Q[6]=K[9],Q[7]=K[13],Q[8]=K[2],Q[9]=K[6],Q[10]=K[10],Q[11]=K[14],Q[12]=K[3],Q[13]=K[7],Q[14]=K[11],Q[15]=K[15];return Q}function VQ(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=K[4],N=K[5],V=K[6],M=K[7],X=K[8],B=K[9],E=K[10],P=K[11],H=K[12],W=K[13],F=K[14],U=K[15],h=$*N-Z*Y,A=$*V-C*Y,T=$*M-J*Y,D=Z*V-C*N,O=Z*M-J*N,q=C*M-J*V,S=X*W-B*H,L=X*F-E*H,I=X*U-P*H,p=B*F-E*W,w=B*U-P*W,v=E*U-P*F,j=h*v-A*w+T*p+D*I-O*L+q*S;if(!j)return null;return j=1/j,Q[0]=(N*v-V*w+M*p)*j,Q[1]=(C*w-Z*v-J*p)*j,Q[2]=(W*q-F*O+U*D)*j,Q[3]=(E*O-B*q-P*D)*j,Q[4]=(V*I-Y*v-M*L)*j,Q[5]=($*v-C*I+J*L)*j,Q[6]=(F*T-H*q-U*A)*j,Q[7]=(X*q-E*T+P*A)*j,Q[8]=(Y*w-N*I+M*S)*j,Q[9]=(Z*I-$*w-J*S)*j,Q[10]=(H*O-W*T+U*h)*j,Q[11]=(B*T-X*O-P*h)*j,Q[12]=(N*L-Y*p-V*S)*j,Q[13]=($*p-Z*L+C*S)*j,Q[14]=(W*A-H*D-F*h)*j,Q[15]=(X*D-B*A+E*h)*j,Q}function MQ(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=K[4],N=K[5],V=K[6],M=K[7],X=K[8],B=K[9],E=K[10],P=K[11],H=K[12],W=K[13],F=K[14],U=K[15];return Q[0]=N*(E*U-P*F)-B*(V*U-M*F)+W*(V*P-M*E),Q[1]=-(Z*(E*U-P*F)-B*(C*U-J*F)+W*(C*P-J*E)),Q[2]=Z*(V*U-M*F)-N*(C*U-J*F)+W*(C*M-J*V),Q[3]=-(Z*(V*P-M*E)-N*(C*P-J*E)+B*(C*M-J*V)),Q[4]=-(Y*(E*U-P*F)-X*(V*U-M*F)+H*(V*P-M*E)),Q[5]=$*(E*U-P*F)-X*(C*U-J*F)+H*(C*P-J*E),Q[6]=-($*(V*U-M*F)-Y*(C*U-J*F)+H*(C*M-J*V)),Q[7]=$*(V*P-M*E)-Y*(C*P-J*E)+X*(C*M-J*V),Q[8]=Y*(B*U-P*W)-X*(N*U-M*W)+H*(N*P-M*B),Q[9]=-($*(B*U-P*W)-X*(Z*U-J*W)+H*(Z*P-J*B)),Q[10]=$*(N*U-M*W)-Y*(Z*U-J*W)+H*(Z*M-J*N),Q[11]=-($*(N*P-M*B)-Y*(Z*P-J*B)+X*(Z*M-J*N)),Q[12]=-(Y*(B*F-E*W)-X*(N*F-V*W)+H*(N*E-V*B)),Q[13]=$*(B*F-E*W)-X*(Z*F-C*W)+H*(Z*E-C*B),Q[14]=-($*(N*F-V*W)-Y*(Z*F-C*W)+H*(Z*V-C*N)),Q[15]=$*(N*E-V*B)-Y*(Z*E-C*B)+X*(Z*V-C*N),Q}function XQ(Q){var K=Q[0],$=Q[1],Z=Q[2],C=Q[3],J=Q[4],Y=Q[5],N=Q[6],V=Q[7],M=Q[8],X=Q[9],B=Q[10],E=Q[11],P=Q[12],H=Q[13],W=Q[14],F=Q[15],U=K*Y-$*J,h=K*N-Z*J,A=K*V-C*J,T=$*N-Z*Y,D=$*V-C*Y,O=Z*V-C*N,q=M*H-X*P,S=M*W-B*P,L=M*F-E*P,I=X*W-B*H,p=X*F-E*H,w=B*F-E*W;return U*w-h*p+A*I+T*L-D*S+O*q}function H0(Q,K,$){var Z=K[0],C=K[1],J=K[2],Y=K[3],N=K[4],V=K[5],M=K[6],X=K[7],B=K[8],E=K[9],P=K[10],H=K[11],W=K[12],F=K[13],U=K[14],h=K[15],A=$[0],T=$[1],D=$[2],O=$[3];return Q[0]=A*Z+T*N+D*B+O*W,Q[1]=A*C+T*V+D*E+O*F,Q[2]=A*J+T*M+D*P+O*U,Q[3]=A*Y+T*X+D*H+O*h,A=$[4],T=$[5],D=$[6],O=$[7],Q[4]=A*Z+T*N+D*B+O*W,Q[5]=A*C+T*V+D*E+O*F,Q[6]=A*J+T*M+D*P+O*U,Q[7]=A*Y+T*X+D*H+O*h,A=$[8],T=$[9],D=$[10],O=$[11],Q[8]=A*Z+T*N+D*B+O*W,Q[9]=A*C+T*V+D*E+O*F,Q[10]=A*J+T*M+D*P+O*U,Q[11]=A*Y+T*X+D*H+O*h,A=$[12],T=$[13],D=$[14],O=$[15],Q[12]=A*Z+T*N+D*B+O*W,Q[13]=A*C+T*V+D*E+O*F,Q[14]=A*J+T*M+D*P+O*U,Q[15]=A*Y+T*X+D*H+O*h,Q}function BQ(Q,K,$){var Z=$[0],C=$[1],J=$[2],Y,N,V,M,X,B,E,P,H,W,F,U;if(K===Q)Q[12]=K[0]*Z+K[4]*C+K[8]*J+K[12],Q[13]=K[1]*Z+K[5]*C+K[9]*J+K[13],Q[14]=K[2]*Z+K[6]*C+K[10]*J+K[14],Q[15]=K[3]*Z+K[7]*C+K[11]*J+K[15];else Y=K[0],N=K[1],V=K[2],M=K[3],X=K[4],B=K[5],E=K[6],P=K[7],H=K[8],W=K[9],F=K[10],U=K[11],Q[0]=Y,Q[1]=N,Q[2]=V,Q[3]=M,Q[4]=X,Q[5]=B,Q[6]=E,Q[7]=P,Q[8]=H,Q[9]=W,Q[10]=F,Q[11]=U,Q[12]=Y*Z+X*C+H*J+K[12],Q[13]=N*Z+B*C+W*J+K[13],Q[14]=V*Z+E*C+F*J+K[14],Q[15]=M*Z+P*C+U*J+K[15];return Q}function FQ(Q,K,$){var Z=$[0],C=$[1],J=$[2];return Q[0]=K[0]*Z,Q[1]=K[1]*Z,Q[2]=K[2]*Z,Q[3]=K[3]*Z,Q[4]=K[4]*C,Q[5]=K[5]*C,Q[6]=K[6]*C,Q[7]=K[7]*C,Q[8]=K[8]*J,Q[9]=K[9]*J,Q[10]=K[10]*J,Q[11]=K[11]*J,Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function PQ(Q,K,$,Z){var C=Z[0],J=Z[1],Y=Z[2],N=Math.hypot(C,J,Y),V,M,X,B,E,P,H,W,F,U,h,A,T,D,O,q,S,L,I,p,w,v,j,g;if(N<R)return null;if(N=1/N,C*=N,J*=N,Y*=N,V=Math.sin($),M=Math.cos($),X=1-M,B=K[0],E=K[1],P=K[2],H=K[3],W=K[4],F=K[5],U=K[6],h=K[7],A=K[8],T=K[9],D=K[10],O=K[11],q=C*C*X+M,S=J*C*X+Y*V,L=Y*C*X-J*V,I=C*J*X-Y*V,p=J*J*X+M,w=Y*J*X+C*V,v=C*Y*X+J*V,j=J*Y*X-C*V,g=Y*Y*X+M,Q[0]=B*q+W*S+A*L,Q[1]=E*q+F*S+T*L,Q[2]=P*q+U*S+D*L,Q[3]=H*q+h*S+O*L,Q[4]=B*I+W*p+A*w,Q[5]=E*I+F*p+T*w,Q[6]=P*I+U*p+D*w,Q[7]=H*I+h*p+O*w,Q[8]=B*v+W*j+A*g,Q[9]=E*v+F*j+T*g,Q[10]=P*v+U*j+D*g,Q[11]=H*v+h*j+O*g,K!==Q)Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q}function EQ(Q,K,$){var Z=Math.sin($),C=Math.cos($),J=K[4],Y=K[5],N=K[6],V=K[7],M=K[8],X=K[9],B=K[10],E=K[11];if(K!==Q)Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[4]=J*C+M*Z,Q[5]=Y*C+X*Z,Q[6]=N*C+B*Z,Q[7]=V*C+E*Z,Q[8]=M*C-J*Z,Q[9]=X*C-Y*Z,Q[10]=B*C-N*Z,Q[11]=E*C-V*Z,Q}function WQ(Q,K,$){var Z=Math.sin($),C=Math.cos($),J=K[0],Y=K[1],N=K[2],V=K[3],M=K[8],X=K[9],B=K[10],E=K[11];if(K!==Q)Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=J*C-M*Z,Q[1]=Y*C-X*Z,Q[2]=N*C-B*Z,Q[3]=V*C-E*Z,Q[8]=J*Z+M*C,Q[9]=Y*Z+X*C,Q[10]=N*Z+B*C,Q[11]=V*Z+E*C,Q}function HQ(Q,K,$){var Z=Math.sin($),C=Math.cos($),J=K[0],Y=K[1],N=K[2],V=K[3],M=K[4],X=K[5],B=K[6],E=K[7];if(K!==Q)Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=J*C+M*Z,Q[1]=Y*C+X*Z,Q[2]=N*C+B*Z,Q[3]=V*C+E*Z,Q[4]=M*C-J*Z,Q[5]=X*C-Y*Z,Q[6]=B*C-N*Z,Q[7]=E*C-V*Z,Q}function UQ(Q,K){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=K[0],Q[13]=K[1],Q[14]=K[2],Q[15]=1,Q}function DQ(Q,K){return Q[0]=K[0],Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=K[1],Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=K[2],Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function OQ(Q,K,$){var Z=$[0],C=$[1],J=$[2],Y=Math.hypot(Z,C,J),N,V,M;if(Y<R)return null;return Y=1/Y,Z*=Y,C*=Y,J*=Y,N=Math.sin(K),V=Math.cos(K),M=1-V,Q[0]=Z*Z*M+V,Q[1]=C*Z*M+J*N,Q[2]=J*Z*M-C*N,Q[3]=0,Q[4]=Z*C*M-J*N,Q[5]=C*C*M+V,Q[6]=J*C*M+Z*N,Q[7]=0,Q[8]=Z*J*M+C*N,Q[9]=C*J*M-Z*N,Q[10]=J*J*M+V,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function TQ(Q,K){var $=Math.sin(K),Z=Math.cos(K);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z,Q[6]=$,Q[7]=0,Q[8]=0,Q[9]=-$,Q[10]=Z,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function AQ(Q,K){var $=Math.sin(K),Z=Math.cos(K);return Q[0]=Z,Q[1]=0,Q[2]=-$,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=$,Q[9]=0,Q[10]=Z,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function kQ(Q,K){var $=Math.sin(K),Z=Math.cos(K);return Q[0]=Z,Q[1]=$,Q[2]=0,Q[3]=0,Q[4]=-$,Q[5]=Z,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function U0(Q,K,$){var Z=K[0],C=K[1],J=K[2],Y=K[3],N=Z+Z,V=C+C,M=J+J,X=Z*N,B=Z*V,E=Z*M,P=C*V,H=C*M,W=J*M,F=Y*N,U=Y*V,h=Y*M;return Q[0]=1-(P+W),Q[1]=B+h,Q[2]=E-U,Q[3]=0,Q[4]=B-h,Q[5]=1-(X+W),Q[6]=H+F,Q[7]=0,Q[8]=E+U,Q[9]=H-F,Q[10]=1-(X+P),Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function RQ(Q,K){var $=new G(3),Z=-K[0],C=-K[1],J=-K[2],Y=K[3],N=K[4],V=K[5],M=K[6],X=K[7],B=Z*Z+C*C+J*J+Y*Y;if(B>0)$[0]=(N*Y+X*Z+V*J-M*C)*2/B,$[1]=(V*Y+X*C+M*Z-N*J)*2/B,$[2]=(M*Y+X*J+N*C-V*Z)*2/B;else $[0]=(N*Y+X*Z+V*J-M*C)*2,$[1]=(V*Y+X*C+M*Z-N*J)*2,$[2]=(M*Y+X*J+N*C-V*Z)*2;return U0(Q,K,$),Q}function hQ(Q,K){return Q[0]=K[12],Q[1]=K[13],Q[2]=K[14],Q}function D0(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[4],Y=K[5],N=K[6],V=K[8],M=K[9],X=K[10];return Q[0]=Math.hypot($,Z,C),Q[1]=Math.hypot(J,Y,N),Q[2]=Math.hypot(V,M,X),Q}function jQ(Q,K){var $=new G(3);D0($,K);var Z=1/$[0],C=1/$[1],J=1/$[2],Y=K[0]*Z,N=K[1]*C,V=K[2]*J,M=K[4]*Z,X=K[5]*C,B=K[6]*J,E=K[8]*Z,P=K[9]*C,H=K[10]*J,W=Y+X+H,F=0;if(W>0)F=Math.sqrt(W+1)*2,Q[3]=0.25*F,Q[0]=(B-P)/F,Q[1]=(E-V)/F,Q[2]=(N-M)/F;else if(Y>X&&Y>H)F=Math.sqrt(1+Y-X-H)*2,Q[3]=(B-P)/F,Q[0]=0.25*F,Q[1]=(N+M)/F,Q[2]=(E+V)/F;else if(X>H)F=Math.sqrt(1+X-Y-H)*2,Q[3]=(E-V)/F,Q[0]=(N+M)/F,Q[1]=0.25*F,Q[2]=(B+P)/F;else F=Math.sqrt(1+H-Y-X)*2,Q[3]=(N-M)/F,Q[0]=(E+V)/F,Q[1]=(B+P)/F,Q[2]=0.25*F;return Q}function _Q(Q,K,$,Z){var C=K[0],J=K[1],Y=K[2],N=K[3],V=C+C,M=J+J,X=Y+Y,B=C*V,E=C*M,P=C*X,H=J*M,W=J*X,F=Y*X,U=N*V,h=N*M,A=N*X,T=Z[0],D=Z[1],O=Z[2];return Q[0]=(1-(H+F))*T,Q[1]=(E+A)*T,Q[2]=(P-h)*T,Q[3]=0,Q[4]=(E-A)*D,Q[5]=(1-(B+F))*D,Q[6]=(W+U)*D,Q[7]=0,Q[8]=(P+h)*O,Q[9]=(W-U)*O,Q[10]=(1-(B+H))*O,Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function GQ(Q,K,$,Z,C){var J=K[0],Y=K[1],N=K[2],V=K[3],M=J+J,X=Y+Y,B=N+N,E=J*M,P=J*X,H=J*B,W=Y*X,F=Y*B,U=N*B,h=V*M,A=V*X,T=V*B,D=Z[0],O=Z[1],q=Z[2],S=C[0],L=C[1],I=C[2],p=(1-(W+U))*D,w=(P+T)*D,v=(H-A)*D,j=(P-T)*O,g=(1-(E+U))*O,i=(F+h)*O,l=(H+A)*q,V0=(F-h)*q,M0=(1-(E+W))*q;return Q[0]=p,Q[1]=w,Q[2]=v,Q[3]=0,Q[4]=j,Q[5]=g,Q[6]=i,Q[7]=0,Q[8]=l,Q[9]=V0,Q[10]=M0,Q[11]=0,Q[12]=$[0]+S-(p*S+j*L+l*I),Q[13]=$[1]+L-(w*S+g*L+V0*I),Q[14]=$[2]+I-(v*S+i*L+M0*I),Q[15]=1,Q}function SQ(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=$+$,N=Z+Z,V=C+C,M=$*Y,X=Z*Y,B=Z*N,E=C*Y,P=C*N,H=C*V,W=J*Y,F=J*N,U=J*V;return Q[0]=1-B-H,Q[1]=X+U,Q[2]=E-F,Q[3]=0,Q[4]=X-U,Q[5]=1-M-H,Q[6]=P+W,Q[7]=0,Q[8]=E+F,Q[9]=P-W,Q[10]=1-M-B,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function LQ(Q,K,$,Z,C,J,Y){var N=1/($-K),V=1/(C-Z),M=1/(J-Y);return Q[0]=J*2*N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=J*2*V,Q[6]=0,Q[7]=0,Q[8]=($+K)*N,Q[9]=(C+Z)*V,Q[10]=(Y+J)*M,Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=Y*J*2*M,Q[15]=0,Q}function O0(Q,K,$,Z,C){var J=1/Math.tan(K/2),Y;if(Q[0]=J/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=J,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,C!=null&&C!==Infinity)Y=1/(Z-C),Q[10]=(C+Z)*Y,Q[14]=2*C*Z*Y;else Q[10]=-1,Q[14]=-2*Z;return Q}function qQ(Q,K,$,Z,C){var J=1/Math.tan(K/2),Y;if(Q[0]=J/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=J,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,C!=null&&C!==Infinity)Y=1/(Z-C),Q[10]=C*Y,Q[14]=C*Z*Y;else Q[10]=-1,Q[14]=-Z;return Q}function pQ(Q,K,$,Z){var C=Math.tan(K.upDegrees*Math.PI/180),J=Math.tan(K.downDegrees*Math.PI/180),Y=Math.tan(K.leftDegrees*Math.PI/180),N=Math.tan(K.rightDegrees*Math.PI/180),V=2/(Y+N),M=2/(C+J);return Q[0]=V,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=M,Q[6]=0,Q[7]=0,Q[8]=-((Y-N)*V*0.5),Q[9]=(C-J)*M*0.5,Q[10]=Z/($-Z),Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=Z*$/($-Z),Q[15]=0,Q}function T0(Q,K,$,Z,C,J,Y){var N=1/(K-$),V=1/(Z-C),M=1/(J-Y);return Q[0]=-2*N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*V,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=2*M,Q[11]=0,Q[12]=(K+$)*N,Q[13]=(C+Z)*V,Q[14]=(Y+J)*M,Q[15]=1,Q}function vQ(Q,K,$,Z,C,J,Y){var N=1/(K-$),V=1/(Z-C),M=1/(J-Y);return Q[0]=-2*N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*V,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=M,Q[11]=0,Q[12]=(K+$)*N,Q[13]=(C+Z)*V,Q[14]=J*M,Q[15]=1,Q}function nQ(Q,K,$,Z){var C,J,Y,N,V,M,X,B,E,P,H=K[0],W=K[1],F=K[2],U=Z[0],h=Z[1],A=Z[2],T=$[0],D=$[1],O=$[2];if(Math.abs(H-T)<R&&Math.abs(W-D)<R&&Math.abs(F-O)<R)return W0(Q);if(X=H-T,B=W-D,E=F-O,P=1/Math.hypot(X,B,E),X*=P,B*=P,E*=P,C=h*E-A*B,J=A*X-U*E,Y=U*B-h*X,P=Math.hypot(C,J,Y),!P)C=0,J=0,Y=0;else P=1/P,C*=P,J*=P,Y*=P;if(N=B*Y-E*J,V=E*C-X*Y,M=X*J-B*C,P=Math.hypot(N,V,M),!P)N=0,V=0,M=0;else P=1/P,N*=P,V*=P,M*=P;return Q[0]=C,Q[1]=N,Q[2]=X,Q[3]=0,Q[4]=J,Q[5]=V,Q[6]=B,Q[7]=0,Q[8]=Y,Q[9]=M,Q[10]=E,Q[11]=0,Q[12]=-(C*H+J*W+Y*F),Q[13]=-(N*H+V*W+M*F),Q[14]=-(X*H+B*W+E*F),Q[15]=1,Q}function gQ(Q,K,$,Z){var C=K[0],J=K[1],Y=K[2],N=Z[0],V=Z[1],M=Z[2],X=C-$[0],B=J-$[1],E=Y-$[2],P=X*X+B*B+E*E;if(P>0)P=1/Math.sqrt(P),X*=P,B*=P,E*=P;var H=V*E-M*B,W=M*X-N*E,F=N*B-V*X;if(P=H*H+W*W+F*F,P>0)P=1/Math.sqrt(P),H*=P,W*=P,F*=P;return Q[0]=H,Q[1]=W,Q[2]=F,Q[3]=0,Q[4]=B*F-E*W,Q[5]=E*H-X*F,Q[6]=X*W-B*H,Q[7]=0,Q[8]=X,Q[9]=B,Q[10]=E,Q[11]=0,Q[12]=C,Q[13]=J,Q[14]=Y,Q[15]=1,Q}function fQ(Q){return"mat4("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+", "+Q[4]+", "+Q[5]+", "+Q[6]+", "+Q[7]+", "+Q[8]+", "+Q[9]+", "+Q[10]+", "+Q[11]+", "+Q[12]+", "+Q[13]+", "+Q[14]+", "+Q[15]+")"}function zQ(Q){return Math.hypot(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7],Q[8],Q[9],Q[10],Q[11],Q[12],Q[13],Q[14],Q[15])}function dQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q[4]=K[4]+$[4],Q[5]=K[5]+$[5],Q[6]=K[6]+$[6],Q[7]=K[7]+$[7],Q[8]=K[8]+$[8],Q[9]=K[9]+$[9],Q[10]=K[10]+$[10],Q[11]=K[11]+$[11],Q[12]=K[12]+$[12],Q[13]=K[13]+$[13],Q[14]=K[14]+$[14],Q[15]=K[15]+$[15],Q}function A0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q[3]=K[3]-$[3],Q[4]=K[4]-$[4],Q[5]=K[5]-$[5],Q[6]=K[6]-$[6],Q[7]=K[7]-$[7],Q[8]=K[8]-$[8],Q[9]=K[9]-$[9],Q[10]=K[10]-$[10],Q[11]=K[11]-$[11],Q[12]=K[12]-$[12],Q[13]=K[13]-$[13],Q[14]=K[14]-$[14],Q[15]=K[15]-$[15],Q}function iQ(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q[4]=K[4]*$,Q[5]=K[5]*$,Q[6]=K[6]*$,Q[7]=K[7]*$,Q[8]=K[8]*$,Q[9]=K[9]*$,Q[10]=K[10]*$,Q[11]=K[11]*$,Q[12]=K[12]*$,Q[13]=K[13]*$,Q[14]=K[14]*$,Q[15]=K[15]*$,Q}function lQ(Q,K,$,Z){return Q[0]=K[0]+$[0]*Z,Q[1]=K[1]+$[1]*Z,Q[2]=K[2]+$[2]*Z,Q[3]=K[3]+$[3]*Z,Q[4]=K[4]+$[4]*Z,Q[5]=K[5]+$[5]*Z,Q[6]=K[6]+$[6]*Z,Q[7]=K[7]+$[7]*Z,Q[8]=K[8]+$[8]*Z,Q[9]=K[9]+$[9]*Z,Q[10]=K[10]+$[10]*Z,Q[11]=K[11]+$[11]*Z,Q[12]=K[12]+$[12]*Z,Q[13]=K[13]+$[13]*Z,Q[14]=K[14]+$[14]*Z,Q[15]=K[15]+$[15]*Z,Q}function yQ(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]&&Q[4]===K[4]&&Q[5]===K[5]&&Q[6]===K[6]&&Q[7]===K[7]&&Q[8]===K[8]&&Q[9]===K[9]&&Q[10]===K[10]&&Q[11]===K[11]&&Q[12]===K[12]&&Q[13]===K[13]&&Q[14]===K[14]&&Q[15]===K[15]}function xQ(Q,K){var $=Q[0],Z=Q[1],C=Q[2],J=Q[3],Y=Q[4],N=Q[5],V=Q[6],M=Q[7],X=Q[8],B=Q[9],E=Q[10],P=Q[11],H=Q[12],W=Q[13],F=Q[14],U=Q[15],h=K[0],A=K[1],T=K[2],D=K[3],O=K[4],q=K[5],S=K[6],L=K[7],I=K[8],p=K[9],w=K[10],v=K[11],j=K[12],g=K[13],i=K[14],l=K[15];return Math.abs($-h)<=R*Math.max(1,Math.abs($),Math.abs(h))&&Math.abs(Z-A)<=R*Math.max(1,Math.abs(Z),Math.abs(A))&&Math.abs(C-T)<=R*Math.max(1,Math.abs(C),Math.abs(T))&&Math.abs(J-D)<=R*Math.max(1,Math.abs(J),Math.abs(D))&&Math.abs(Y-O)<=R*Math.max(1,Math.abs(Y),Math.abs(O))&&Math.abs(N-q)<=R*Math.max(1,Math.abs(N),Math.abs(q))&&Math.abs(V-S)<=R*Math.max(1,Math.abs(V),Math.abs(S))&&Math.abs(M-L)<=R*Math.max(1,Math.abs(M),Math.abs(L))&&Math.abs(X-I)<=R*Math.max(1,Math.abs(X),Math.abs(I))&&Math.abs(B-p)<=R*Math.max(1,Math.abs(B),Math.abs(p))&&Math.abs(E-w)<=R*Math.max(1,Math.abs(E),Math.abs(w))&&Math.abs(P-v)<=R*Math.max(1,Math.abs(P),Math.abs(v))&&Math.abs(H-j)<=R*Math.max(1,Math.abs(H),Math.abs(j))&&Math.abs(W-g)<=R*Math.max(1,Math.abs(W),Math.abs(g))&&Math.abs(F-i)<=R*Math.max(1,Math.abs(F),Math.abs(i))&&Math.abs(U-l)<=R*Math.max(1,Math.abs(U),Math.abs(l))}var IQ=O0,wQ=T0,cQ=H0,mQ=A0;var c={};b(c,{str:()=>{{return lK}},squaredLength:()=>{{return u0}},sqrLen:()=>{{return uK}},sqlerp:()=>{{return Q$}},slerp:()=>{{return e}},setAxisAngle:()=>{{return y0}},setAxes:()=>{{return K$}},set:()=>{{return mK}},scale:()=>{{return r0}},rotationTo:()=>{{return aK}},rotateZ:()=>{{return vK}},rotateY:()=>{{return wK}},rotateX:()=>{{return pK}},random:()=>{{return fK}},pow:()=>{{return gK}},normalize:()=>{{return J0}},multiply:()=>{{return x0}},mul:()=>{{return rK}},ln:()=>{{return m0}},lerp:()=>{{return eK}},length:()=>{{return b0}},len:()=>{{return bK}},invert:()=>{{return zK}},identity:()=>{{return LK}},getAxisAngle:()=>{{return IK}},getAngle:()=>{{return qK}},fromValues:()=>{{return xK}},fromMat3:()=>{{return s0}},fromEuler:()=>{{return iK}},exp:()=>{{return c0}},exactEquals:()=>{{return oK}},equals:()=>{{return tK}},dot:()=>{{return e0}},create:()=>{{return C0}},copy:()=>{{return cK}},conjugate:()=>{{return dK}},clone:()=>{{return yK}},calculateW:()=>{{return nK}},add:()=>{{return sK}}});var d={};b(d,{zero:()=>{{return HK}},transformQuat:()=>{{return BK}},transformMat4:()=>{{return MK}},transformMat3:()=>{{return XK}},subtract:()=>{{return R0}},sub:()=>{{return TK}},str:()=>{{return UK}},squaredLength:()=>{{return S0}},squaredDistance:()=>{{return G0}},sqrLen:()=>{{return jK}},sqrDist:()=>{{return hK}},set:()=>{{return eQ}},scaleAndAdd:()=>{{return $K}},scale:()=>{{return KK}},round:()=>{{return QK}},rotateZ:()=>{{return EK}},rotateY:()=>{{return PK}},rotateX:()=>{{return FK}},random:()=>{{return VK}},normalize:()=>{{return $0}},negate:()=>{{return ZK}},multiply:()=>{{return h0}},mul:()=>{{return AK}},min:()=>{{return tQ}},max:()=>{{return aQ}},lerp:()=>{{return JK}},length:()=>{{return k0}},len:()=>{{return Z0}},inverse:()=>{{return CK}},hermite:()=>{{return YK}},fromValues:()=>{{return s}},forEach:()=>{{return _K}},floor:()=>{{return oQ}},exactEquals:()=>{{return DK}},equals:()=>{{return OK}},dot:()=>{{return r}},divide:()=>{{return j0}},div:()=>{{return kK}},distance:()=>{{return _0}},dist:()=>{{return RK}},cross:()=>{{return x}},create:()=>{{return m}},copy:()=>{{return rQ}},clone:()=>{{return sQ}},ceil:()=>{{return uQ}},bezier:()=>{{return NK}},angle:()=>{{return WK}},add:()=>{{return bQ}}});function m(){var Q=new G(3);if(G!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q}function sQ(Q){var K=new G(3);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K}function k0(Q){var K=Q[0],$=Q[1],Z=Q[2];return Math.hypot(K,$,Z)}function s(Q,K,$){var Z=new G(3);return Z[0]=Q,Z[1]=K,Z[2]=$,Z}function rQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q}function eQ(Q,K,$,Z){return Q[0]=K,Q[1]=$,Q[2]=Z,Q}function bQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q}function R0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q}function h0(Q,K,$){return Q[0]=K[0]*$[0],Q[1]=K[1]*$[1],Q[2]=K[2]*$[2],Q}function j0(Q,K,$){return Q[0]=K[0]/$[0],Q[1]=K[1]/$[1],Q[2]=K[2]/$[2],Q}function uQ(Q,K){return Q[0]=Math.ceil(K[0]),Q[1]=Math.ceil(K[1]),Q[2]=Math.ceil(K[2]),Q}function oQ(Q,K){return Q[0]=Math.floor(K[0]),Q[1]=Math.floor(K[1]),Q[2]=Math.floor(K[2]),Q}function tQ(Q,K,$){return Q[0]=Math.min(K[0],$[0]),Q[1]=Math.min(K[1],$[1]),Q[2]=Math.min(K[2],$[2]),Q}function aQ(Q,K,$){return Q[0]=Math.max(K[0],$[0]),Q[1]=Math.max(K[1],$[1]),Q[2]=Math.max(K[2],$[2]),Q}function QK(Q,K){return Q[0]=Math.round(K[0]),Q[1]=Math.round(K[1]),Q[2]=Math.round(K[2]),Q}function KK(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q}function $K(Q,K,$,Z){return Q[0]=K[0]+$[0]*Z,Q[1]=K[1]+$[1]*Z,Q[2]=K[2]+$[2]*Z,Q}function _0(Q,K){var $=K[0]-Q[0],Z=K[1]-Q[1],C=K[2]-Q[2];return Math.hypot($,Z,C)}function G0(Q,K){var $=K[0]-Q[0],Z=K[1]-Q[1],C=K[2]-Q[2];return $*$+Z*Z+C*C}function S0(Q){var K=Q[0],$=Q[1],Z=Q[2];return K*K+$*$+Z*Z}function ZK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q}function CK(Q,K){return Q[0]=1/K[0],Q[1]=1/K[1],Q[2]=1/K[2],Q}function $0(Q,K){var $=K[0],Z=K[1],C=K[2],J=$*$+Z*Z+C*C;if(J>0)J=1/Math.sqrt(J);return Q[0]=K[0]*J,Q[1]=K[1]*J,Q[2]=K[2]*J,Q}function r(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]}function x(Q,K,$){var Z=K[0],C=K[1],J=K[2],Y=$[0],N=$[1],V=$[2];return Q[0]=C*V-J*N,Q[1]=J*Y-Z*V,Q[2]=Z*N-C*Y,Q}function JK(Q,K,$,Z){var C=K[0],J=K[1],Y=K[2];return Q[0]=C+Z*($[0]-C),Q[1]=J+Z*($[1]-J),Q[2]=Y+Z*($[2]-Y),Q}function YK(Q,K,$,Z,C,J){var Y=J*J,N=Y*(2*J-3)+1,V=Y*(J-2)+J,M=Y*(J-1),X=Y*(3-2*J);return Q[0]=K[0]*N+$[0]*V+Z[0]*M+C[0]*X,Q[1]=K[1]*N+$[1]*V+Z[1]*M+C[1]*X,Q[2]=K[2]*N+$[2]*V+Z[2]*M+C[2]*X,Q}function NK(Q,K,$,Z,C,J){var Y=1-J,N=Y*Y,V=J*J,M=N*Y,X=3*J*N,B=3*V*Y,E=V*J;return Q[0]=K[0]*M+$[0]*X+Z[0]*B+C[0]*E,Q[1]=K[1]*M+$[1]*X+Z[1]*B+C[1]*E,Q[2]=K[2]*M+$[2]*X+Z[2]*B+C[2]*E,Q}function VK(Q,K){K=K||1;var $=f()*2*Math.PI,Z=f()*2-1,C=Math.sqrt(1-Z*Z)*K;return Q[0]=Math.cos($)*C,Q[1]=Math.sin($)*C,Q[2]=Z*K,Q}function MK(Q,K,$){var Z=K[0],C=K[1],J=K[2],Y=$[3]*Z+$[7]*C+$[11]*J+$[15];return Y=Y||1,Q[0]=($[0]*Z+$[4]*C+$[8]*J+$[12])/Y,Q[1]=($[1]*Z+$[5]*C+$[9]*J+$[13])/Y,Q[2]=($[2]*Z+$[6]*C+$[10]*J+$[14])/Y,Q}function XK(Q,K,$){var Z=K[0],C=K[1],J=K[2];return Q[0]=Z*$[0]+C*$[3]+J*$[6],Q[1]=Z*$[1]+C*$[4]+J*$[7],Q[2]=Z*$[2]+C*$[5]+J*$[8],Q}function BK(Q,K,$){var Z=$[0],C=$[1],J=$[2],Y=$[3],N=K[0],V=K[1],M=K[2],X=C*M-J*V,B=J*N-Z*M,E=Z*V-C*N,P=C*E-J*B,H=J*X-Z*E,W=Z*B-C*X,F=Y*2;return X*=F,B*=F,E*=F,P*=2,H*=2,W*=2,Q[0]=N+X+P,Q[1]=V+B+H,Q[2]=M+E+W,Q}function FK(Q,K,$,Z){var C=[],J=[];return C[0]=K[0]-$[0],C[1]=K[1]-$[1],C[2]=K[2]-$[2],J[0]=C[0],J[1]=C[1]*Math.cos(Z)-C[2]*Math.sin(Z),J[2]=C[1]*Math.sin(Z)+C[2]*Math.cos(Z),Q[0]=J[0]+$[0],Q[1]=J[1]+$[1],Q[2]=J[2]+$[2],Q}function PK(Q,K,$,Z){var C=[],J=[];return C[0]=K[0]-$[0],C[1]=K[1]-$[1],C[2]=K[2]-$[2],J[0]=C[2]*Math.sin(Z)+C[0]*Math.cos(Z),J[1]=C[1],J[2]=C[2]*Math.cos(Z)-C[0]*Math.sin(Z),Q[0]=J[0]+$[0],Q[1]=J[1]+$[1],Q[2]=J[2]+$[2],Q}function EK(Q,K,$,Z){var C=[],J=[];return C[0]=K[0]-$[0],C[1]=K[1]-$[1],C[2]=K[2]-$[2],J[0]=C[0]*Math.cos(Z)-C[1]*Math.sin(Z),J[1]=C[0]*Math.sin(Z)+C[1]*Math.cos(Z),J[2]=C[2],Q[0]=J[0]+$[0],Q[1]=J[1]+$[1],Q[2]=J[2]+$[2],Q}function WK(Q,K){var $=Q[0],Z=Q[1],C=Q[2],J=K[0],Y=K[1],N=K[2],V=Math.sqrt($*$+Z*Z+C*C),M=Math.sqrt(J*J+Y*Y+N*N),X=V*M,B=X&&r(Q,K)/X;return Math.acos(Math.min(Math.max(B,-1),1))}function HK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q}function UK(Q){return"vec3("+Q[0]+", "+Q[1]+", "+Q[2]+")"}function DK(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]}function OK(Q,K){var $=Q[0],Z=Q[1],C=Q[2],J=K[0],Y=K[1],N=K[2];return Math.abs($-J)<=R*Math.max(1,Math.abs($),Math.abs(J))&&Math.abs(Z-Y)<=R*Math.max(1,Math.abs(Z),Math.abs(Y))&&Math.abs(C-N)<=R*Math.max(1,Math.abs(C),Math.abs(N))}var TK=R0,AK=h0,kK=j0,RK=_0,hK=G0,Z0=k0,jK=S0,_K=function(){var Q=m();return function(K,$,Z,C,J,Y){var N,V;if(!$)$=3;if(!Z)Z=0;if(C)V=Math.min(C*$+Z,K.length);else V=K.length;for(N=Z;N<V;N+=$)Q[0]=K[N],Q[1]=K[N+1],Q[2]=K[N+2],J(Q,Q,Y),K[N]=Q[0],K[N+1]=Q[1],K[N+2]=Q[2];return K}}();function GK(){var Q=new G(4);if(G!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=0;return Q}function L0(Q){var K=new G(4);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K}function I0(Q,K,$,Z){var C=new G(4);return C[0]=Q,C[1]=K,C[2]=$,C[3]=Z,C}function q0(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q}function p0(Q,K,$,Z,C){return Q[0]=K,Q[1]=$,Q[2]=Z,Q[3]=C,Q}function w0(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q}function v0(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q}function n0(Q){var K=Q[0],$=Q[1],Z=Q[2],C=Q[3];return Math.hypot(K,$,Z,C)}function g0(Q){var K=Q[0],$=Q[1],Z=Q[2],C=Q[3];return K*K+$*$+Z*Z+C*C}function f0(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=$*$+Z*Z+C*C+J*J;if(Y>0)Y=1/Math.sqrt(Y);return Q[0]=$*Y,Q[1]=Z*Y,Q[2]=C*Y,Q[3]=J*Y,Q}function z0(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]+Q[3]*K[3]}function d0(Q,K,$,Z){var C=K[0],J=K[1],Y=K[2],N=K[3];return Q[0]=C+Z*($[0]-C),Q[1]=J+Z*($[1]-J),Q[2]=Y+Z*($[2]-Y),Q[3]=N+Z*($[3]-N),Q}function i0(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]}function l0(Q,K){var $=Q[0],Z=Q[1],C=Q[2],J=Q[3],Y=K[0],N=K[1],V=K[2],M=K[3];return Math.abs($-Y)<=R*Math.max(1,Math.abs($),Math.abs(Y))&&Math.abs(Z-N)<=R*Math.max(1,Math.abs(Z),Math.abs(N))&&Math.abs(C-V)<=R*Math.max(1,Math.abs(C),Math.abs(V))&&Math.abs(J-M)<=R*Math.max(1,Math.abs(J),Math.abs(M))}var A$=function(){var Q=GK();return function(K,$,Z,C,J,Y){var N,V;if(!$)$=4;if(!Z)Z=0;if(C)V=Math.min(C*$+Z,K.length);else V=K.length;for(N=Z;N<V;N+=$)Q[0]=K[N],Q[1]=K[N+1],Q[2]=K[N+2],Q[3]=K[N+3],J(Q,Q,Y),K[N]=Q[0],K[N+1]=Q[1],K[N+2]=Q[2],K[N+3]=Q[3];return K}}();function C0(){var Q=new G(4);if(G!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q[3]=1,Q}function LK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=1,Q}function y0(Q,K,$){$=$*0.5;var Z=Math.sin($);return Q[0]=Z*K[0],Q[1]=Z*K[1],Q[2]=Z*K[2],Q[3]=Math.cos($),Q}function IK(Q,K){var $=Math.acos(K[3])*2,Z=Math.sin($/2);if(Z>R)Q[0]=K[0]/Z,Q[1]=K[1]/Z,Q[2]=K[2]/Z;else Q[0]=1,Q[1]=0,Q[2]=0;return $}function qK(Q,K){var $=e0(Q,K);return Math.acos(2*$*$-1)}function x0(Q,K,$){var Z=K[0],C=K[1],J=K[2],Y=K[3],N=$[0],V=$[1],M=$[2],X=$[3];return Q[0]=Z*X+Y*N+C*M-J*V,Q[1]=C*X+Y*V+J*N-Z*M,Q[2]=J*X+Y*M+Z*V-C*N,Q[3]=Y*X-Z*N-C*V-J*M,Q}function pK(Q,K,$){$*=0.5;var Z=K[0],C=K[1],J=K[2],Y=K[3],N=Math.sin($),V=Math.cos($);return Q[0]=Z*V+Y*N,Q[1]=C*V+J*N,Q[2]=J*V-C*N,Q[3]=Y*V-Z*N,Q}function wK(Q,K,$){$*=0.5;var Z=K[0],C=K[1],J=K[2],Y=K[3],N=Math.sin($),V=Math.cos($);return Q[0]=Z*V-J*N,Q[1]=C*V+Y*N,Q[2]=J*V+Z*N,Q[3]=Y*V-C*N,Q}function vK(Q,K,$){$*=0.5;var Z=K[0],C=K[1],J=K[2],Y=K[3],N=Math.sin($),V=Math.cos($);return Q[0]=Z*V+C*N,Q[1]=C*V-Z*N,Q[2]=J*V+Y*N,Q[3]=Y*V-J*N,Q}function nK(Q,K){var $=K[0],Z=K[1],C=K[2];return Q[0]=$,Q[1]=Z,Q[2]=C,Q[3]=Math.sqrt(Math.abs(1-$*$-Z*Z-C*C)),Q}function c0(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=Math.sqrt($*$+Z*Z+C*C),N=Math.exp(J),V=Y>0?N*Math.sin(Y)/Y:0;return Q[0]=$*V,Q[1]=Z*V,Q[2]=C*V,Q[3]=N*Math.cos(Y),Q}function m0(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=Math.sqrt($*$+Z*Z+C*C),N=Y>0?Math.atan2(Y,J)/Y:0;return Q[0]=$*N,Q[1]=Z*N,Q[2]=C*N,Q[3]=0.5*Math.log($*$+Z*Z+C*C+J*J),Q}function gK(Q,K,$){return m0(Q,K),r0(Q,Q,$),c0(Q,Q),Q}function e(Q,K,$,Z){var C=K[0],J=K[1],Y=K[2],N=K[3],V=$[0],M=$[1],X=$[2],B=$[3],E,P,H,W,F;if(P=C*V+J*M+Y*X+N*B,P<0)P=-P,V=-V,M=-M,X=-X,B=-B;if(1-P>R)E=Math.acos(P),H=Math.sin(E),W=Math.sin((1-Z)*E)/H,F=Math.sin(Z*E)/H;else W=1-Z,F=Z;return Q[0]=W*C+F*V,Q[1]=W*J+F*M,Q[2]=W*Y+F*X,Q[3]=W*N+F*B,Q}function fK(Q){var K=f(),$=f(),Z=f(),C=Math.sqrt(1-K),J=Math.sqrt(K);return Q[0]=C*Math.sin(2*Math.PI*$),Q[1]=C*Math.cos(2*Math.PI*$),Q[2]=J*Math.sin(2*Math.PI*Z),Q[3]=J*Math.cos(2*Math.PI*Z),Q}function zK(Q,K){var $=K[0],Z=K[1],C=K[2],J=K[3],Y=$*$+Z*Z+C*C+J*J,N=Y?1/Y:0;return Q[0]=-$*N,Q[1]=-Z*N,Q[2]=-C*N,Q[3]=J*N,Q}function dK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q[3]=K[3],Q}function s0(Q,K){var $=K[0]+K[4]+K[8],Z;if($>0)Z=Math.sqrt($+1),Q[3]=0.5*Z,Z=0.5/Z,Q[0]=(K[5]-K[7])*Z,Q[1]=(K[6]-K[2])*Z,Q[2]=(K[1]-K[3])*Z;else{var C=0;if(K[4]>K[0])C=1;if(K[8]>K[C*3+C])C=2;var J=(C+1)%3,Y=(C+2)%3;Z=Math.sqrt(K[C*3+C]-K[J*3+J]-K[Y*3+Y]+1),Q[C]=0.5*Z,Z=0.5/Z,Q[3]=(K[J*3+Y]-K[Y*3+J])*Z,Q[J]=(K[J*3+C]+K[C*3+J])*Z,Q[Y]=(K[Y*3+C]+K[C*3+Y])*Z}return Q}function iK(Q,K,$,Z){var C=0.5*Math.PI/180;K*=C,$*=C,Z*=C;var J=Math.sin(K),Y=Math.cos(K),N=Math.sin($),V=Math.cos($),M=Math.sin(Z),X=Math.cos(Z);return Q[0]=J*V*X-Y*N*M,Q[1]=Y*N*X+J*V*M,Q[2]=Y*V*M-J*N*X,Q[3]=Y*V*X+J*N*M,Q}function lK(Q){return"quat("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+")"}var yK=L0,xK=I0,cK=q0,mK=p0,sK=w0,rK=x0,r0=v0,e0=z0,eK=d0,b0=n0,bK=b0,u0=g0,uK=u0,J0=f0,oK=i0,tK=l0,aK=function(){var Q=m(),K=s(1,0,0),$=s(0,1,0);return function(Z,C,J){var Y=r(C,J);if(Y<-0.999999){if(x(Q,K,C),Z0(Q)<0.000001)x(Q,$,C);return $0(Q,Q),y0(Z,Q,Math.PI),Z}else if(Y>0.999999)return Z[0]=0,Z[1]=0,Z[2]=0,Z[3]=1,Z;else return x(Q,C,J),Z[0]=Q[0],Z[1]=Q[1],Z[2]=Q[2],Z[3]=1+Y,J0(Z,Z)}}(),Q$=function(){var Q=C0(),K=C0();return function($,Z,C,J,Y,N){return e(Q,Z,Y,N),e(K,C,J,N),e($,Q,K,2*N*(1-N)),$}}(),K$=function(){var Q=E0();return function(K,$,Z,C){return Q[0]=Z[0],Q[3]=Z[1],Q[6]=Z[2],Q[1]=C[0],Q[4]=C[1],Q[7]=C[2],Q[2]=-$[0],Q[5]=-$[1],Q[8]=-$[2],J0(K,s0(K,Q))}}();var o0=4096,$$=!1;class z extends n{texImgSrc;activated=!1;width;height;constructor(Q){super();this.texImgSrc=Q,this.width=Q instanceof HTMLImageElement?Q.naturalWidth:Q instanceof VideoFrame?Q.displayWidth:Q.width,this.height=Q instanceof HTMLImageElement?Q.naturalHeight:Q instanceof VideoFrame?Q.displayHeight:Q.width}static async loadImage(Q){return new Promise((K,$)=>{const Z=new Image,C=new z(Z),J=()=>K(C),Y=(N)=>$(N.error);Z.addEventListener("error",Y),Z.addEventListener("load",J,{once:!0}),C.addOnDestroy(()=>Z.removeEventListener("load",J)),Z.src=Q})}static async loadVideo(Q,K){return new Promise(($,Z)=>{const C=document.createElement("video"),J=new z(C);if(C.loop=!0,K!==void 0)C.volume=K;const Y=()=>C.play(),N=()=>$(J);C.addEventListener("loadedmetadata",Y),C.addEventListener("playing",N,{once:!0}),C.addEventListener("error",(V)=>Z(V.error)),C.src=Q,J.addOnDestroy(()=>{C.pause(),C.removeEventListener("playing",N),C.removeEventListener("loadmetadata",Y)})})}static async loadWebcam(Q){return new Promise((K,$)=>{const Z=document.createElement("video"),C=new z(Z);Z.loop=!0;const J=()=>Z.play(),Y=()=>K(C);Z.addEventListener("loadedmetadata",J),Z.addEventListener("playing",Y,{once:!0}),Z.addEventListener("error",(V)=>$(V.error));let N=!1;navigator.mediaDevices.getUserMedia({video:{deviceId:Q}}).then((V)=>{if(!N)Z.srcObject=V,C.addOnDestroy(()=>V.getTracks().forEach((M)=>M.stop()))}),C.addOnDestroy(()=>{N=!0,Z.pause(),Z.removeEventListener("playing",Y),Z.removeEventListener("loadmetadata",J)})})}}class Y0 extends n{gl;textureBuffers={};images={};tempCanvas=document.createElement("canvas");tempContext=this.tempCanvas.getContext("2d");constructor(Q){super();if(this.gl=Q,this.tempContext.imageSmoothingEnabled=!0,$$)this.tempCanvas.style.width="400px",this.tempCanvas.style.height="400px",document.body.appendChild(this.tempCanvas)}getTexture(Q){if(!this.textureBuffers[Q]){const K=this.gl.createTexture();if(!K)return;this.gl.bindTexture(this.gl.TEXTURE_2D,K),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,o0,o0,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.textureBuffers[Q]=K,this.addOnDestroy(()=>this.gl.deleteTexture(K))}return this.textureBuffers[Q]}loadTexture(Q,K,$,Z,C){this.gl.activeTexture(this.gl[K]),this.gl.bindTexture(this.gl.TEXTURE_2D,$),this.applyTexImage2d(Q,Z,C),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR)}applyTexImage2d(Q,[K,$,Z,C],[J,Y,N,V]){if(!Z&&!C&&!N&&!V)this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,Q),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE);else{const M=this.tempContext.canvas;if(Q instanceof ImageData){if(M.width=N||Q.width,M.height=V||Q.height,this.tempContext.putImageData(Q,0,0),K||$)console.warn("Offset not available when sending imageData")}else{const X=Z||Q.width,B=C||Q.height;M.width=N||X,M.height=V||B,this.tempContext.drawImage(Q,K,$,X,B,0,0,M.width,M.height)}this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,J,Y,M.width,M.height,this.gl.RGBA,this.gl.UNSIGNED_BYTE,M)}}hasImageId(Q){return!!this.images[Q]}loadCanvas(Q,K){const $=new z(Q);return this.images[K]=this.own($),$}async loadImage(Q,K){const $=await z.loadImage(Q);return this.images[K]=this.own($),$}async loadVideo(Q,K,$){const Z=await z.loadVideo(Q,$);return this.images[K]=this.own(Z),Z}async loadWebCam(Q,K){const $=await z.loadWebcam(Q);return this.images[K]=this.own($),$}assignImageToTexture(Q,K,$,Z){if(!K){console.warn("Invalid texture Id");return}const C=this.images[Q];if(C){const J=this.getTexture(K);if(J){const Y=$??[0,0,C.width,C.height],N=Z??[0,0,Y[2],Y[3]];if(C.activated)this.gl.bindTexture(this.gl.TEXTURE_2D,J),this.applyTexImage2d(C.texImgSrc,Y,N);else this.loadTexture(C.texImgSrc,K,J,Y,N),C.activated=!0}}}}var J$=function(Q){if(!C$)return Q;return new Proxy(Q,{get($,Z){const C=$,J=C[Z];if(typeof J==="function")return(...N)=>{const V=J.apply(C,N);return console.log(`gl.${String(Z)}(`,N,") = ",V),V};else return console.log(`gl.${String(Z)} = `,J),J}})},Z$={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},_=WebGL2RenderingContext,C$=!1;class N0 extends n{gl;perspectiveLevel=1;programs;attributeBuffers;uniforms;cameraMatrix;camTurnMatrix;perspectiveMatrix;orthoMatrix;projectionMatrix;canvas;textureManager;constructor(Q,K){super();this.gl=J$(Q.getContext("webgl2",{...Z$,...K})),this.canvas=Q,this.textureManager=new Y0(this.gl),this.programs=this.own(new o(this.gl)),this.attributeBuffers=this.own(new a(this.gl,this.programs)),this.uniforms=this.own(new Q0(this.gl,this.programs)),this.cameraMatrix=k.translate(k.create(),k.identity(k.create()),d.fromValues(0,0,-1)),this.camTurnMatrix=k.identity(k.create()),this.perspectiveMatrix=k.identity(k.create()),this.orthoMatrix=k.identity(k.create()),this.projectionMatrix=k.identity(k.create()),window.addEventListener("resize",this.checkCanvasSize.bind(this))}checkCanvasSize(){this.canvas.width=this.canvas.offsetWidth*2,this.canvas.height=this.canvas.offsetHeight*2,this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const Q=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;this.configOrthoMatrix(Q),this.configPerspectiveMatrix(Q)}initialize(){this.gl.enable(_.DEPTH_TEST),this.gl.depthFunc(_.LEQUAL),this.gl.enable(_.BLEND),this.gl.blendFunc(_.SRC_ALPHA,_.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);{const Q=X0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(_.ELEMENT_ARRAY_BUFFER,K),this.attributeBuffers.bufferData(_.ELEMENT_ARRAY_BUFFER,Q,Uint16Array.from([0,1,2,2,3,0]),0,_.STATIC_DRAW)}{const Q=K0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(_.ARRAY_BUFFER,K),this.gl.vertexAttribPointer(K.location,3,_.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(K.location),this.attributeBuffers.bufferData(_.ARRAY_BUFFER,Q,Float32Array.from([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),0,_.STATIC_DRAW)}{const Q=B0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(_.ARRAY_BUFFER,K);for(let $=0;$<4;$++){const Z=K.location+$;this.gl.vertexAttribPointer(Z,4,_.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,$*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(Z),this.gl.vertexAttribDivisor(Z,1)}this.attributeBuffers.bufferData(_.ARRAY_BUFFER,Q,Float32Array.from([...k.identity(k.create()),...k.fromYRotation(k.create(),Math.PI/4),...k.fromYRotation(k.create(),Math.PI/2)]),0,_.DYNAMIC_DRAW)}{const Q=F0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(_.ARRAY_BUFFER,K),this.gl.vertexAttribPointer(K.location,2,_.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(K.location),this.attributeBuffers.bufferData(_.ARRAY_BUFFER,Q,Float32Array.from([0,1,1,1,1,0,0,0]),0,_.DYNAMIC_DRAW)}{const Q=document.createElement("canvas");Q.width=200,Q.height=200;const K=Q.getContext("2d");K.fillStyle="red",K.strokeStyle="black",K.fillRect(0,0,200,200),K.beginPath(),K.arc(100,100,80,0,2*Math.PI),K.moveTo(0,0),K.lineTo(200,200),K.moveTo(0,200),K.lineTo(200,0),K.stroke(),this.textureManager.loadCanvas(Q,"test"),this.textureManager.assignImageToTexture("test","TEXTURE0",[0,0,200,200],[0,0,256,256])}this.checkCanvasSize(),this.refreshCamera()}configPerspectiveMatrix(Q){const K=Math.PI/90;this.perspectiveMatrix=k.perspective(k.create(),45*K,Q,0,1e4),this.setPerspective()}configOrthoMatrix(Q){this.orthoMatrix=k.ortho(k.create(),-1*Q,1*Q,-1,1,-100,100),this.setPerspective()}refreshCamera(){const Q=k.identity(k.create());k.mul(Q,this.cameraMatrix,Q),k.mul(Q,this.camTurnMatrix,Q),k.mul(Q,this.projectionMatrix,Q);const K=this.uniforms.getUniformLocation(P0);if(K)this.gl.uniformMatrix4fv(K,!1,Q)}updateTrianglePosition(Q,K){const $=this.attributeBuffers.getAttributeBuffer(K0);this.attributeBuffers.bindBuffer(_.ARRAY_BUFFER,$),this.attributeBuffers.bufferSubData(_.ARRAY_BUFFER,Float32Array.from(K),Q*4*3*Float32Array.BYTES_PER_ELEMENT)}setPerspective(Q){if(Q!==void 0)this.perspectiveLevel=Q;const K=k.create();k.multiplyScalar(K,this.orthoMatrix,1-this.perspectiveLevel);const $=k.create();k.multiplyScalar($,this.perspectiveMatrix,this.perspectiveLevel),k.copy(this.projectionMatrix,K),k.add(this.projectionMatrix,this.projectionMatrix,$),this.refreshCamera()}moveCam(Q,K){const $=c.create();k.getRotation($,this.camTurnMatrix),c.invert($,$);const Z=d.fromValues(-Q,0,K);d.transformQuat(Z,Z,$),k.translate(this.cameraMatrix,this.cameraMatrix,Z),this.refreshCamera()}turnCam(Q){k.rotateY(this.camTurnMatrix,this.camTurnMatrix,Q),this.refreshCamera()}drawArrays(Q){this.gl.drawArrays(_.TRIANGLES,0,Q)}drawElementsInstanced(Q,K){this.gl.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT),this.gl.drawElementsInstanced(_.TRIANGLES,Q,_.UNSIGNED_SHORT,0,K)}bindVertexArray(){return this.own(new t(this.gl))}}function n$(){console.log("Hello World!")}function g$(Q){Q.style.border=".5px solid silver";const K=new N0(Q);window.engine=K,K.programs.addProgram("test",`
            #version 300 es

            precision highp float;
            
            const float TEXTURE_SIZE = 4096.;
            const float SLOT_SIZE = 256.;
            const float SLOT_SIDE_COUNT = TEXTURE_SIZE / SLOT_SIZE;
            const float SLOT_TEX_SIZE = 1. / SLOT_SIDE_COUNT;

            //  IN
            //  shape
            layout (location=0) in vec4 position;
            layout (location=1) in mat4 transform;
            //  2, 3, 4
            //  animation
            layout (location=5) in vec2 tex;

            uniform mat4 cam;

            //  OUT
            out vec2 vTex;
            out float textureIndex;
            out float opacity;

            void main() {
                gl_Position = cam * transform * position;
                vTex = tex * SLOT_TEX_SIZE;
                textureIndex = 0.;
                opacity = 1.;
            }
        `,`
            #version 300 es

            precision highp float;

            //  CONST
            const int NUM_TEXTURES = 16;
            const float threshold = 0.00001;

            //  IN
            //  texture
            uniform sampler2D uTextures[NUM_TEXTURES];
            in float textureIndex;
            in vec2 vTex;
            in float opacity;
            
            //  OUT
            out vec4 fragColor;
            
            //  FUNCTIONS
            vec4 getTextureColor(float textureSlot, vec2 vTexturePoint);

            void main() {
                vec4 color = getTextureColor(textureIndex, vTex);
                if (color.a <= .01) {
                  discard;
                };
                fragColor = vec4(color.rgb, 1.);
            }

            vec4 getTextureColor(float textureSlot, vec2 vTexturePoint) {
                if (abs(0.0 - textureSlot) < threshold) {
                  return texture(uTextures[0], vTexturePoint);
                }
                if (abs(1.0 - textureSlot) < threshold) {
                  return texture(uTextures[1], vTexturePoint);
                }
                if (abs(2.0 - textureSlot) < threshold) {
                  return texture(uTextures[2], vTexturePoint);
                }
                if (abs(3.0 - textureSlot) < threshold) {
                  return texture(uTextures[3], vTexturePoint);
                }
                if (abs(4.0 - textureSlot) < threshold) {
                  return texture(uTextures[4], vTexturePoint);
                }
                if (abs(5.0 - textureSlot) < threshold) {
                  return texture(uTextures[5], vTexturePoint);
                }
                if (abs(6.0 - textureSlot) < threshold) {
                  return texture(uTextures[6], vTexturePoint);
                }
                if (abs(7.0 - textureSlot) < threshold) {
                  return texture(uTextures[7], vTexturePoint);
                }
                if (abs(8.0 - textureSlot) < threshold) {
                  return texture(uTextures[8], vTexturePoint);
                }
                if (abs(9.0 - textureSlot) < threshold) {
                  return texture(uTextures[9], vTexturePoint);
                }
                if (abs(10.0 - textureSlot) < threshold) {
                  return texture(uTextures[10], vTexturePoint);
                }
                if (abs(11.0 - textureSlot) < threshold) {
                  return texture(uTextures[11], vTexturePoint);
                }
                if (abs(12.0 - textureSlot) < threshold) {
                  return texture(uTextures[12], vTexturePoint);
                }
                if (abs(13.0 - textureSlot) < threshold) {
                  return texture(uTextures[13], vTexturePoint);
                }
                if (abs(14.0 - textureSlot) < threshold) {
                  return texture(uTextures[14], vTexturePoint);
                }
                if (abs(15.0 - textureSlot) < threshold) {
                  return texture(uTextures[15], vTexturePoint);
                }
                return texture(uTextures[0], vTexturePoint);
            }            
        `),K.programs.useProgram("test"),K.initialize();const $={};document.addEventListener("keydown",(C)=>{$[C.code]=!0}),document.addEventListener("keyup",(C)=>{$[C.code]=!1});function Z(){if($.KeyW)K.moveCam(0,0.25);if($.KeyS)K.moveCam(0,-0.25);if($.KeyA)K.moveCam(-0.25,0);if($.KeyD)K.moveCam(0.25,0);if($.KeyQ)K.turnCam(-0.05);if($.KeyE)K.turnCam(0.05);const Y=6,N=1;K.drawElementsInstanced(Y,N),requestAnimationFrame(Z)}return Z(),K}export{g$ as testCanvas,n$ as hello};

//# debugId=1A0FA51D34FACE5564756e2164756e21
