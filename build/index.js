var FQ=Object.defineProperty;var u=(Q,K)=>{for(var $ in K)FQ(Q,$,{get:K[$],enumerable:!0,configurable:!0,set:(Z)=>K[$]=()=>Z})};class g{disposables;own(Q){if(!this.disposables)this.disposables=new Set;return this.disposables.add(Q),Q}addOnDestroy(Q){this.disposables?.add({destroy:Q})}destroy(){this.disposables?.forEach((Q)=>Q.destroy())}}var NQ=function(Q,K,$){function Z(Y,P){function X(U){return U===Q?.VERTEX_SHADER?"vertex":U===Q?.FRAGMENT_SHADER?"fragment":void 0}if(P!==Q.VERTEX_SHADER&&P!==Q.FRAGMENT_SHADER)throw new Error(`Shader error in ${X(P)}`);const W=Q.createShader(P);if(!W)throw new Error(`Unable to generate ${X(P)} shader.`);if(Q.shaderSource(W,Y),Q.compileShader(W),!Q.getShaderParameter(W,Q.COMPILE_STATUS))console.error(`Shader compile error in ${X(P)}:`+Q.getShaderInfoLog(W));return W}const J=Q.createProgram();if(!J)throw new Error("Unable to create program.");const V=Z(K,Q.VERTEX_SHADER),F=Z($,Q.FRAGMENT_SHADER),N=Q.getShaderInfoLog(V),B=Q.getShaderInfoLog(F);if(N)console.log("VERTEX",N);if(B)console.log("FRAGMENT",B);Q.attachShader(J,V),Q.attachShader(J,F),Q.linkProgram(J);const C=Q.getProgramInfoLog(J);if(C)console.log("PROGRAM",C);if(Q.detachShader(J,V),Q.detachShader(J,F),Q.deleteShader(V),Q.deleteShader(F),Q.validateProgram(J),Object.entries(WebGL2RenderingContext).forEach(([Y,P])=>{if(P&&Q.getError()===P)console.log(`gl.${Y}`)}),!Q.getProgramParameter(J,Q.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+Q.getProgramInfoLog(J));return J},BQ=function(Q,K){Q.deleteProgram(K)};class o extends g{gl;program;constructor(Q,K,$){super();this.gl=Q,this.program=NQ(Q,K.trim(),$.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),BQ(this.gl,this.program)}}class t extends g{activeProgramId="";gl;programs={};constructor(Q){super();this.gl=Q}addProgram(Q,K,$){if(this.programs[Q])this.removeProgram(Q);this.programs[Q]=this.own(new o(this.gl,K,$))}useProgram(Q){if(this.activeProgramId!==Q)this.activeProgramId=Q,this.programs[Q].use()}removeProgram(Q){this.programs[Q].destroy(),delete this.programs[Q]}getProgram(Q){return this.programs[Q??this.activeProgramId]?.program}}class a extends g{gl;triangleArray;constructor(Q){super();this.gl=Q,this.triangleArray=Q.createVertexArray(),Q.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class Q0 extends g{bufferRecord={};lastBoundBuffer;gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getAttributeLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getAttribLocation($,Q)??-1:-1}createBuffer(Q){this.deleteBuffer(Q);const K=this.gl?.createBuffer();if(!K)throw new Error(`Unable to create buffer "${Q}"`);const $={buffer:K,location:this.getAttributeLocation(Q)};return this.bufferRecord[Q]=$,$}deleteBuffer(Q){if(this.bufferRecord[Q])this.gl.deleteBuffer(this.bufferRecord[Q].buffer),delete this.bufferRecord[Q]}getAttributeBuffer(Q,K){const $=this.bufferRecord[Q];if(!$){if(K)return this.createBuffer(Q);throw new Error(`Attribute "${Q}" not created. Make sure "createBuffer" is called.`)}return $}bufferData(Q,K,$,Z,J){const V=this.getAttributeBuffer(K);if($)this.gl.bufferData(Q,$,J);else this.gl.bufferData(Q,Z,J);V.bufferSize=Z||$?.length,V.bufferArray=$??new Float32Array(V.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),V.usage=J,V.target=Q}bufferSubData(Q,K,$,Z,J){if(Z)this.gl.bufferSubData(Q,$,K,Z,J);else this.gl.bufferSubData(Q,$,K)}bindBuffer(Q,K){if(this.lastBoundBuffer!==K)this.lastBoundBuffer=K,this.gl.bindBuffer(Q,K.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((Q)=>this.deleteBuffer(Q))}}class K0 extends g{gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getUniformLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getUniformLocation($,Q)??void 0:void 0}}var O=WebGL2RenderingContext,$0="position",X0="index",H0="transform",U0="tex",D0="slotSize",O0="cam",A0="projection";class n extends g{texImgSrc;activated=!1;width;height;constructor(Q){super();this.texImgSrc=Q,this.width=Q instanceof HTMLImageElement?Q.naturalWidth:Q instanceof VideoFrame?Q.displayWidth:Q.width,this.height=Q instanceof HTMLImageElement?Q.naturalHeight:Q instanceof VideoFrame?Q.displayHeight:Q.width}static async loadImage(Q){return new Promise((K,$)=>{const Z=new Image,J=new n(Z),V=()=>K(J),F=(N)=>$(N.error);Z.addEventListener("error",F),Z.addEventListener("load",V,{once:!0}),J.addOnDestroy(()=>Z.removeEventListener("load",V)),Z.src=Q})}static async loadVideo(Q,K){return new Promise(($,Z)=>{const J=document.createElement("video"),V=new n(J);if(J.loop=!0,K!==void 0)J.volume=K;const F=()=>J.play(),N=()=>$(V);J.addEventListener("loadedmetadata",F),J.addEventListener("playing",N,{once:!0}),J.addEventListener("error",(B)=>Z(B.error)),J.src=Q,V.addOnDestroy(()=>{J.pause(),J.removeEventListener("playing",N),J.removeEventListener("loadmetadata",F)})})}static async loadWebcam(Q){return new Promise((K,$)=>{const Z=document.createElement("video"),J=new n(Z);Z.loop=!0;const V=()=>Z.play(),F=()=>K(J);Z.addEventListener("loadedmetadata",V),Z.addEventListener("playing",F,{once:!0}),Z.addEventListener("error",(B)=>$(B.error));let N=!1;navigator.mediaDevices.getUserMedia({video:{deviceId:Q}}).then((B)=>{if(!N)Z.srcObject=B,J.addOnDestroy(()=>B.getTracks().forEach((C)=>C.stop()))}),J.addOnDestroy(()=>{N=!0,Z.pause(),Z.removeEventListener("playing",F),Z.removeEventListener("loadmetadata",V)})})}}var R0=4096;class Z0 extends g{gl;textureBuffers={};images={};tempCanvas=new OffscreenCanvas(1,1);tempContext=this.tempCanvas.getContext("2d");constructor(Q){super();this.gl=Q,this.tempContext.imageSmoothingEnabled=!0}getTexture(Q){if(!this.textureBuffers[Q]){const K=this.gl.createTexture();if(!K)return;this.gl.bindTexture(O.TEXTURE_2D,K),this.gl.texImage2D(O.TEXTURE_2D,0,O.RGBA,R0,R0,0,O.RGBA,O.UNSIGNED_BYTE,null),this.gl.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR),this.textureBuffers[Q]=K,this.addOnDestroy(()=>this.gl.deleteTexture(K))}return this.textureBuffers[Q]}loadTexture(Q,K,$,Z,J){this.gl.activeTexture(O[K]),this.gl.bindTexture(O.TEXTURE_2D,$),this.applyTexImage2d(Q,Z,J),this.gl.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR)}applyTexImage2d(Q,[K,$,Z,J],[V,F,N,B]){if(Z===N&&J===B&&!K&&!$)this.gl.texSubImage2D(O.TEXTURE_2D,0,V,F,Z,J,O.RGBA,O.UNSIGNED_BYTE,Q.texImgSrc);else{console.log("Used canvas");const C=this.tempContext.canvas;if(Q.texImgSrc instanceof ImageData){if(C.width=N||Q.width,C.height=B||Q.height,this.tempContext.putImageData(Q.texImgSrc,0,0),K||$)console.warn("Offset not available when sending imageData")}else{const Y=Z||Q.width,P=J||Q.height;C.width=N||Y,C.height=B||P,this.tempContext.drawImage(Q.texImgSrc,K,$,Y,P,0,0,C.width,C.height)}this.gl.texSubImage2D(O.TEXTURE_2D,0,V,F,C.width,C.height,O.RGBA,O.UNSIGNED_BYTE,C)}}hasImageId(Q){return!!this.images[Q]}async drawImage(Q,K){const $=new OffscreenCanvas(1,1);K($.getContext("2d"));const Z=new n($);return this.images[Q]=this.own(Z),Z}async loadCanvas(Q,K){const $=new n(K);return K.getContext("2d"),this.images[Q]=this.own($),$}async loadImage(Q,K){const $=await n.loadImage(K);return this.images[Q]=this.own($),$}async loadVideo(Q,K,$){const Z=await n.loadVideo(K,$);return this.images[Q]=this.own(Z),Z}async loadWebCam(Q,K){const $=await n.loadWebcam(K);return this.images[Q]=this.own($),$}assignImageToTexture(Q,K,$,Z){if(!this.getTexture(K)){console.warn("Invalid texture Id");return}const J=this.images[Q];if(J){const V=this.getTexture(K);if(V){const F=$??[0,0,J.width,J.height],N=Z??[0,0,F[2],F[3]];if(J.activated)this.gl.bindTexture(O.TEXTURE_2D,V),this.applyTexImage2d(J,F,N);else this.loadTexture(J,K,V,F,N),J.activated=!0}else console.warn(`Texture not found: ${K}`)}}generateMipMap(Q){const K=this.getTexture(Q);if(K)this.gl.activeTexture(O[Q]),this.gl.bindTexture(O.TEXTURE_2D,K),this.gl.generateMipmap(O.TEXTURE_2D),console.log("GENERATED MIPMAP")}}var M0=`#version 300 es
//  ~{AUTHOR}

precision highp float;

const float TEXTURE_SIZE = 4096.;

//  IN
//  shape
layout(location = 0) in vec2 position;
layout(location = 1) in mat4 transform;
//  2, 3, 4
//  animation
layout(location = 5) in vec2 tex;
layout(location = 6) in vec2 slotSize;

//  UNIFORM
uniform mat4 cam;
uniform mat4 projection;

//  OUT
out vec2 vTex;
out float textureIndex;

void main() {
  gl_Position = projection * cam * transform * vec4(position, 0.0, 1.0);
  vTex = tex * (slotSize / TEXTURE_SIZE);
  textureIndex = 0.;
}
`;var T0=`#version 300 es
//  ~{AUTHOR}
precision highp float;

//  CONST
const int NUM_TEXTURES = 16;
const float threshold = 0.00001;

//  IN
//  texture
uniform sampler2D uTextures[NUM_TEXTURES];
in float textureIndex;
in vec2 vTex;
in float opacity;

//  OUT
out vec4 fragColor;

//  FUNCTIONS
vec4 getTextureColor(float textureSlot, vec2 vTexturePoint);

void main() {
  vec4 color = getTextureColor(textureIndex, vTex);
  if (color.a <= .01) {
    discard;
  };
  fragColor = color;
}

vec4 getTextureColor(float textureSlot, vec2 vTexturePoint) {
  if (abs(0.0 - textureSlot) < threshold) {
    return texture(uTextures[0], vTexturePoint);
  }
  if (abs(1.0 - textureSlot) < threshold) {
    return texture(uTextures[1], vTexturePoint);
  }
  if (abs(2.0 - textureSlot) < threshold) {
    return texture(uTextures[2], vTexturePoint);
  }
  if (abs(3.0 - textureSlot) < threshold) {
    return texture(uTextures[3], vTexturePoint);
  }
  if (abs(4.0 - textureSlot) < threshold) {
    return texture(uTextures[4], vTexturePoint);
  }
  if (abs(5.0 - textureSlot) < threshold) {
    return texture(uTextures[5], vTexturePoint);
  }
  if (abs(6.0 - textureSlot) < threshold) {
    return texture(uTextures[6], vTexturePoint);
  }
  if (abs(7.0 - textureSlot) < threshold) {
    return texture(uTextures[7], vTexturePoint);
  }
  if (abs(8.0 - textureSlot) < threshold) {
    return texture(uTextures[8], vTexturePoint);
  }
  if (abs(9.0 - textureSlot) < threshold) {
    return texture(uTextures[9], vTexturePoint);
  }
  if (abs(10.0 - textureSlot) < threshold) {
    return texture(uTextures[10], vTexturePoint);
  }
  if (abs(11.0 - textureSlot) < threshold) {
    return texture(uTextures[11], vTexturePoint);
  }
  if (abs(12.0 - textureSlot) < threshold) {
    return texture(uTextures[12], vTexturePoint);
  }
  if (abs(13.0 - textureSlot) < threshold) {
    return texture(uTextures[13], vTexturePoint);
  }
  if (abs(14.0 - textureSlot) < threshold) {
    return texture(uTextures[14], vTexturePoint);
  }
  if (abs(15.0 - textureSlot) < threshold) {
    return texture(uTextures[15], vTexturePoint);
  }
  return texture(uTextures[0], vTexturePoint);
}
`;function J0(Q,K){return Q.replace(/~\{(\w+)\}/g,($,Z)=>{return K?.[Z]||$})}var h=0.000001,S=typeof Float32Array!=="undefined"?Float32Array:Array,d=Math.random,d$=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var Q=0,K=arguments.length;while(K--)Q+=arguments[K]*arguments[K];return Math.sqrt(Q)};function h0(){var Q=new S(9);if(S!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[5]=0,Q[6]=0,Q[7]=0;return Q[0]=1,Q[4]=1,Q[8]=1,Q}var k={};u(k,{transpose:()=>{{return DQ}},translate:()=>{{return MQ}},targetTo:()=>{{return sQ}},subtract:()=>{{return q0}},sub:()=>{{return KK}},str:()=>{{return rQ}},set:()=>{{return UQ}},scale:()=>{{return TQ}},rotateZ:()=>{{return kQ}},rotateY:()=>{{return _Q}},rotateX:()=>{{return jQ}},rotate:()=>{{return hQ}},perspectiveZO:()=>{{return iQ}},perspectiveNO:()=>{{return G0}},perspectiveFromFieldOfView:()=>{{return lQ}},perspective:()=>{{return yQ}},orthoZO:()=>{{return cQ}},orthoNO:()=>{{return L0}},ortho:()=>{{return xQ}},multiplyScalarAndAdd:()=>{{return oQ}},multiplyScalar:()=>{{return uQ}},multiply:()=>{{return _0}},mul:()=>{{return QK}},lookAt:()=>{{return mQ}},invert:()=>{{return OQ}},identity:()=>{{return j0}},getTranslation:()=>{{return vQ}},getScaling:()=>{{return S0}},getRotation:()=>{{return gQ}},frustum:()=>{{return dQ}},fromZRotation:()=>{{return wQ}},fromYRotation:()=>{{return IQ}},fromXRotation:()=>{{return qQ}},fromValues:()=>{{return HQ}},fromTranslation:()=>{{return SQ}},fromScaling:()=>{{return GQ}},fromRotationTranslationScaleOrigin:()=>{{return fQ}},fromRotationTranslationScale:()=>{{return zQ}},fromRotationTranslation:()=>{{return k0}},fromRotation:()=>{{return LQ}},fromQuat2:()=>{{return pQ}},fromQuat:()=>{{return nQ}},frob:()=>{{return eQ}},exactEquals:()=>{{return tQ}},equals:()=>{{return aQ}},determinant:()=>{{return RQ}},create:()=>{{return EQ}},copy:()=>{{return XQ}},clone:()=>{{return WQ}},adjoint:()=>{{return AQ}},add:()=>{{return bQ}}});function EQ(){var Q=new S(16);if(S!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0;return Q[0]=1,Q[5]=1,Q[10]=1,Q[15]=1,Q}function WQ(Q){var K=new S(16);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function XQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function HQ(Q,K,$,Z,J,V,F,N,B,C,Y,P,X,W,U,H){var E=new S(16);return E[0]=Q,E[1]=K,E[2]=$,E[3]=Z,E[4]=J,E[5]=V,E[6]=F,E[7]=N,E[8]=B,E[9]=C,E[10]=Y,E[11]=P,E[12]=X,E[13]=W,E[14]=U,E[15]=H,E}function UQ(Q,K,$,Z,J,V,F,N,B,C,Y,P,X,W,U,H,E){return Q[0]=K,Q[1]=$,Q[2]=Z,Q[3]=J,Q[4]=V,Q[5]=F,Q[6]=N,Q[7]=B,Q[8]=C,Q[9]=Y,Q[10]=P,Q[11]=X,Q[12]=W,Q[13]=U,Q[14]=H,Q[15]=E,Q}function j0(Q){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function DQ(Q,K){if(Q===K){var $=K[1],Z=K[2],J=K[3],V=K[6],F=K[7],N=K[11];Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=$,Q[6]=K[9],Q[7]=K[13],Q[8]=Z,Q[9]=V,Q[11]=K[14],Q[12]=J,Q[13]=F,Q[14]=N}else Q[0]=K[0],Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=K[1],Q[5]=K[5],Q[6]=K[9],Q[7]=K[13],Q[8]=K[2],Q[9]=K[6],Q[10]=K[10],Q[11]=K[14],Q[12]=K[3],Q[13]=K[7],Q[14]=K[11],Q[15]=K[15];return Q}function OQ(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=K[4],N=K[5],B=K[6],C=K[7],Y=K[8],P=K[9],X=K[10],W=K[11],U=K[12],H=K[13],E=K[14],D=K[15],j=$*N-Z*F,T=$*B-J*F,M=$*C-V*F,A=Z*B-J*N,R=Z*C-V*N,I=J*C-V*B,G=Y*H-P*U,L=Y*E-X*U,q=Y*D-W*U,w=P*E-X*H,p=P*D-W*H,v=X*D-W*E,_=j*v-T*p+M*w+A*q-R*L+I*G;if(!_)return null;return _=1/_,Q[0]=(N*v-B*p+C*w)*_,Q[1]=(J*p-Z*v-V*w)*_,Q[2]=(H*I-E*R+D*A)*_,Q[3]=(X*R-P*I-W*A)*_,Q[4]=(B*q-F*v-C*L)*_,Q[5]=($*v-J*q+V*L)*_,Q[6]=(E*M-U*I-D*T)*_,Q[7]=(Y*I-X*M+W*T)*_,Q[8]=(F*p-N*q+C*G)*_,Q[9]=(Z*q-$*p-V*G)*_,Q[10]=(U*R-H*M+D*j)*_,Q[11]=(P*M-Y*R-W*j)*_,Q[12]=(N*L-F*w-B*G)*_,Q[13]=($*w-Z*L+J*G)*_,Q[14]=(H*T-U*A-E*j)*_,Q[15]=(Y*A-P*T+X*j)*_,Q}function AQ(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=K[4],N=K[5],B=K[6],C=K[7],Y=K[8],P=K[9],X=K[10],W=K[11],U=K[12],H=K[13],E=K[14],D=K[15];return Q[0]=N*(X*D-W*E)-P*(B*D-C*E)+H*(B*W-C*X),Q[1]=-(Z*(X*D-W*E)-P*(J*D-V*E)+H*(J*W-V*X)),Q[2]=Z*(B*D-C*E)-N*(J*D-V*E)+H*(J*C-V*B),Q[3]=-(Z*(B*W-C*X)-N*(J*W-V*X)+P*(J*C-V*B)),Q[4]=-(F*(X*D-W*E)-Y*(B*D-C*E)+U*(B*W-C*X)),Q[5]=$*(X*D-W*E)-Y*(J*D-V*E)+U*(J*W-V*X),Q[6]=-($*(B*D-C*E)-F*(J*D-V*E)+U*(J*C-V*B)),Q[7]=$*(B*W-C*X)-F*(J*W-V*X)+Y*(J*C-V*B),Q[8]=F*(P*D-W*H)-Y*(N*D-C*H)+U*(N*W-C*P),Q[9]=-($*(P*D-W*H)-Y*(Z*D-V*H)+U*(Z*W-V*P)),Q[10]=$*(N*D-C*H)-F*(Z*D-V*H)+U*(Z*C-V*N),Q[11]=-($*(N*W-C*P)-F*(Z*W-V*P)+Y*(Z*C-V*N)),Q[12]=-(F*(P*E-X*H)-Y*(N*E-B*H)+U*(N*X-B*P)),Q[13]=$*(P*E-X*H)-Y*(Z*E-J*H)+U*(Z*X-J*P),Q[14]=-($*(N*E-B*H)-F*(Z*E-J*H)+U*(Z*B-J*N)),Q[15]=$*(N*X-B*P)-F*(Z*X-J*P)+Y*(Z*B-J*N),Q}function RQ(Q){var K=Q[0],$=Q[1],Z=Q[2],J=Q[3],V=Q[4],F=Q[5],N=Q[6],B=Q[7],C=Q[8],Y=Q[9],P=Q[10],X=Q[11],W=Q[12],U=Q[13],H=Q[14],E=Q[15],D=K*F-$*V,j=K*N-Z*V,T=K*B-J*V,M=$*N-Z*F,A=$*B-J*F,R=Z*B-J*N,I=C*U-Y*W,G=C*H-P*W,L=C*E-X*W,q=Y*H-P*U,w=Y*E-X*U,p=P*E-X*H;return D*p-j*w+T*q+M*L-A*G+R*I}function _0(Q,K,$){var Z=K[0],J=K[1],V=K[2],F=K[3],N=K[4],B=K[5],C=K[6],Y=K[7],P=K[8],X=K[9],W=K[10],U=K[11],H=K[12],E=K[13],D=K[14],j=K[15],T=$[0],M=$[1],A=$[2],R=$[3];return Q[0]=T*Z+M*N+A*P+R*H,Q[1]=T*J+M*B+A*X+R*E,Q[2]=T*V+M*C+A*W+R*D,Q[3]=T*F+M*Y+A*U+R*j,T=$[4],M=$[5],A=$[6],R=$[7],Q[4]=T*Z+M*N+A*P+R*H,Q[5]=T*J+M*B+A*X+R*E,Q[6]=T*V+M*C+A*W+R*D,Q[7]=T*F+M*Y+A*U+R*j,T=$[8],M=$[9],A=$[10],R=$[11],Q[8]=T*Z+M*N+A*P+R*H,Q[9]=T*J+M*B+A*X+R*E,Q[10]=T*V+M*C+A*W+R*D,Q[11]=T*F+M*Y+A*U+R*j,T=$[12],M=$[13],A=$[14],R=$[15],Q[12]=T*Z+M*N+A*P+R*H,Q[13]=T*J+M*B+A*X+R*E,Q[14]=T*V+M*C+A*W+R*D,Q[15]=T*F+M*Y+A*U+R*j,Q}function MQ(Q,K,$){var Z=$[0],J=$[1],V=$[2],F,N,B,C,Y,P,X,W,U,H,E,D;if(K===Q)Q[12]=K[0]*Z+K[4]*J+K[8]*V+K[12],Q[13]=K[1]*Z+K[5]*J+K[9]*V+K[13],Q[14]=K[2]*Z+K[6]*J+K[10]*V+K[14],Q[15]=K[3]*Z+K[7]*J+K[11]*V+K[15];else F=K[0],N=K[1],B=K[2],C=K[3],Y=K[4],P=K[5],X=K[6],W=K[7],U=K[8],H=K[9],E=K[10],D=K[11],Q[0]=F,Q[1]=N,Q[2]=B,Q[3]=C,Q[4]=Y,Q[5]=P,Q[6]=X,Q[7]=W,Q[8]=U,Q[9]=H,Q[10]=E,Q[11]=D,Q[12]=F*Z+Y*J+U*V+K[12],Q[13]=N*Z+P*J+H*V+K[13],Q[14]=B*Z+X*J+E*V+K[14],Q[15]=C*Z+W*J+D*V+K[15];return Q}function TQ(Q,K,$){var Z=$[0],J=$[1],V=$[2];return Q[0]=K[0]*Z,Q[1]=K[1]*Z,Q[2]=K[2]*Z,Q[3]=K[3]*Z,Q[4]=K[4]*J,Q[5]=K[5]*J,Q[6]=K[6]*J,Q[7]=K[7]*J,Q[8]=K[8]*V,Q[9]=K[9]*V,Q[10]=K[10]*V,Q[11]=K[11]*V,Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function hQ(Q,K,$,Z){var J=Z[0],V=Z[1],F=Z[2],N=Math.hypot(J,V,F),B,C,Y,P,X,W,U,H,E,D,j,T,M,A,R,I,G,L,q,w,p,v,_,f;if(N<h)return null;if(N=1/N,J*=N,V*=N,F*=N,B=Math.sin($),C=Math.cos($),Y=1-C,P=K[0],X=K[1],W=K[2],U=K[3],H=K[4],E=K[5],D=K[6],j=K[7],T=K[8],M=K[9],A=K[10],R=K[11],I=J*J*Y+C,G=V*J*Y+F*B,L=F*J*Y-V*B,q=J*V*Y-F*B,w=V*V*Y+C,p=F*V*Y+J*B,v=J*F*Y+V*B,_=V*F*Y-J*B,f=F*F*Y+C,Q[0]=P*I+H*G+T*L,Q[1]=X*I+E*G+M*L,Q[2]=W*I+D*G+A*L,Q[3]=U*I+j*G+R*L,Q[4]=P*q+H*w+T*p,Q[5]=X*q+E*w+M*p,Q[6]=W*q+D*w+A*p,Q[7]=U*q+j*w+R*p,Q[8]=P*v+H*_+T*f,Q[9]=X*v+E*_+M*f,Q[10]=W*v+D*_+A*f,Q[11]=U*v+j*_+R*f,K!==Q)Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q}function jQ(Q,K,$){var Z=Math.sin($),J=Math.cos($),V=K[4],F=K[5],N=K[6],B=K[7],C=K[8],Y=K[9],P=K[10],X=K[11];if(K!==Q)Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[4]=V*J+C*Z,Q[5]=F*J+Y*Z,Q[6]=N*J+P*Z,Q[7]=B*J+X*Z,Q[8]=C*J-V*Z,Q[9]=Y*J-F*Z,Q[10]=P*J-N*Z,Q[11]=X*J-B*Z,Q}function _Q(Q,K,$){var Z=Math.sin($),J=Math.cos($),V=K[0],F=K[1],N=K[2],B=K[3],C=K[8],Y=K[9],P=K[10],X=K[11];if(K!==Q)Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=V*J-C*Z,Q[1]=F*J-Y*Z,Q[2]=N*J-P*Z,Q[3]=B*J-X*Z,Q[8]=V*Z+C*J,Q[9]=F*Z+Y*J,Q[10]=N*Z+P*J,Q[11]=B*Z+X*J,Q}function kQ(Q,K,$){var Z=Math.sin($),J=Math.cos($),V=K[0],F=K[1],N=K[2],B=K[3],C=K[4],Y=K[5],P=K[6],X=K[7];if(K!==Q)Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=V*J+C*Z,Q[1]=F*J+Y*Z,Q[2]=N*J+P*Z,Q[3]=B*J+X*Z,Q[4]=C*J-V*Z,Q[5]=Y*J-F*Z,Q[6]=P*J-N*Z,Q[7]=X*J-B*Z,Q}function SQ(Q,K){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=K[0],Q[13]=K[1],Q[14]=K[2],Q[15]=1,Q}function GQ(Q,K){return Q[0]=K[0],Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=K[1],Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=K[2],Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function LQ(Q,K,$){var Z=$[0],J=$[1],V=$[2],F=Math.hypot(Z,J,V),N,B,C;if(F<h)return null;return F=1/F,Z*=F,J*=F,V*=F,N=Math.sin(K),B=Math.cos(K),C=1-B,Q[0]=Z*Z*C+B,Q[1]=J*Z*C+V*N,Q[2]=V*Z*C-J*N,Q[3]=0,Q[4]=Z*J*C-V*N,Q[5]=J*J*C+B,Q[6]=V*J*C+Z*N,Q[7]=0,Q[8]=Z*V*C+J*N,Q[9]=J*V*C-Z*N,Q[10]=V*V*C+B,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function qQ(Q,K){var $=Math.sin(K),Z=Math.cos(K);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z,Q[6]=$,Q[7]=0,Q[8]=0,Q[9]=-$,Q[10]=Z,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function IQ(Q,K){var $=Math.sin(K),Z=Math.cos(K);return Q[0]=Z,Q[1]=0,Q[2]=-$,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=$,Q[9]=0,Q[10]=Z,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function wQ(Q,K){var $=Math.sin(K),Z=Math.cos(K);return Q[0]=Z,Q[1]=$,Q[2]=0,Q[3]=0,Q[4]=-$,Q[5]=Z,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function k0(Q,K,$){var Z=K[0],J=K[1],V=K[2],F=K[3],N=Z+Z,B=J+J,C=V+V,Y=Z*N,P=Z*B,X=Z*C,W=J*B,U=J*C,H=V*C,E=F*N,D=F*B,j=F*C;return Q[0]=1-(W+H),Q[1]=P+j,Q[2]=X-D,Q[3]=0,Q[4]=P-j,Q[5]=1-(Y+H),Q[6]=U+E,Q[7]=0,Q[8]=X+D,Q[9]=U-E,Q[10]=1-(Y+W),Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function pQ(Q,K){var $=new S(3),Z=-K[0],J=-K[1],V=-K[2],F=K[3],N=K[4],B=K[5],C=K[6],Y=K[7],P=Z*Z+J*J+V*V+F*F;if(P>0)$[0]=(N*F+Y*Z+B*V-C*J)*2/P,$[1]=(B*F+Y*J+C*Z-N*V)*2/P,$[2]=(C*F+Y*V+N*J-B*Z)*2/P;else $[0]=(N*F+Y*Z+B*V-C*J)*2,$[1]=(B*F+Y*J+C*Z-N*V)*2,$[2]=(C*F+Y*V+N*J-B*Z)*2;return k0(Q,K,$),Q}function vQ(Q,K){return Q[0]=K[12],Q[1]=K[13],Q[2]=K[14],Q}function S0(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[4],F=K[5],N=K[6],B=K[8],C=K[9],Y=K[10];return Q[0]=Math.hypot($,Z,J),Q[1]=Math.hypot(V,F,N),Q[2]=Math.hypot(B,C,Y),Q}function gQ(Q,K){var $=new S(3);S0($,K);var Z=1/$[0],J=1/$[1],V=1/$[2],F=K[0]*Z,N=K[1]*J,B=K[2]*V,C=K[4]*Z,Y=K[5]*J,P=K[6]*V,X=K[8]*Z,W=K[9]*J,U=K[10]*V,H=F+Y+U,E=0;if(H>0)E=Math.sqrt(H+1)*2,Q[3]=0.25*E,Q[0]=(P-W)/E,Q[1]=(X-B)/E,Q[2]=(N-C)/E;else if(F>Y&&F>U)E=Math.sqrt(1+F-Y-U)*2,Q[3]=(P-W)/E,Q[0]=0.25*E,Q[1]=(N+C)/E,Q[2]=(X+B)/E;else if(Y>U)E=Math.sqrt(1+Y-F-U)*2,Q[3]=(X-B)/E,Q[0]=(N+C)/E,Q[1]=0.25*E,Q[2]=(P+W)/E;else E=Math.sqrt(1+U-F-Y)*2,Q[3]=(N-C)/E,Q[0]=(X+B)/E,Q[1]=(P+W)/E,Q[2]=0.25*E;return Q}function zQ(Q,K,$,Z){var J=K[0],V=K[1],F=K[2],N=K[3],B=J+J,C=V+V,Y=F+F,P=J*B,X=J*C,W=J*Y,U=V*C,H=V*Y,E=F*Y,D=N*B,j=N*C,T=N*Y,M=Z[0],A=Z[1],R=Z[2];return Q[0]=(1-(U+E))*M,Q[1]=(X+T)*M,Q[2]=(W-j)*M,Q[3]=0,Q[4]=(X-T)*A,Q[5]=(1-(P+E))*A,Q[6]=(H+D)*A,Q[7]=0,Q[8]=(W+j)*R,Q[9]=(H-D)*R,Q[10]=(1-(P+U))*R,Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function fQ(Q,K,$,Z,J){var V=K[0],F=K[1],N=K[2],B=K[3],C=V+V,Y=F+F,P=N+N,X=V*C,W=V*Y,U=V*P,H=F*Y,E=F*P,D=N*P,j=B*C,T=B*Y,M=B*P,A=Z[0],R=Z[1],I=Z[2],G=J[0],L=J[1],q=J[2],w=(1-(H+D))*A,p=(W+M)*A,v=(U-T)*A,_=(W-M)*R,f=(1-(X+D))*R,i=(E+j)*R,l=(U+T)*I,E0=(E-j)*I,W0=(1-(X+H))*I;return Q[0]=w,Q[1]=p,Q[2]=v,Q[3]=0,Q[4]=_,Q[5]=f,Q[6]=i,Q[7]=0,Q[8]=l,Q[9]=E0,Q[10]=W0,Q[11]=0,Q[12]=$[0]+G-(w*G+_*L+l*q),Q[13]=$[1]+L-(p*G+f*L+E0*q),Q[14]=$[2]+q-(v*G+i*L+W0*q),Q[15]=1,Q}function nQ(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=$+$,N=Z+Z,B=J+J,C=$*F,Y=Z*F,P=Z*N,X=J*F,W=J*N,U=J*B,H=V*F,E=V*N,D=V*B;return Q[0]=1-P-U,Q[1]=Y+D,Q[2]=X-E,Q[3]=0,Q[4]=Y-D,Q[5]=1-C-U,Q[6]=W+H,Q[7]=0,Q[8]=X+E,Q[9]=W-H,Q[10]=1-C-P,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function dQ(Q,K,$,Z,J,V,F){var N=1/($-K),B=1/(J-Z),C=1/(V-F);return Q[0]=V*2*N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=V*2*B,Q[6]=0,Q[7]=0,Q[8]=($+K)*N,Q[9]=(J+Z)*B,Q[10]=(F+V)*C,Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=F*V*2*C,Q[15]=0,Q}function G0(Q,K,$,Z,J){var V=1/Math.tan(K/2),F;if(Q[0]=V/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=V,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,J!=null&&J!==Infinity)F=1/(Z-J),Q[10]=(J+Z)*F,Q[14]=2*J*Z*F;else Q[10]=-1,Q[14]=-2*Z;return Q}function iQ(Q,K,$,Z,J){var V=1/Math.tan(K/2),F;if(Q[0]=V/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=V,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,J!=null&&J!==Infinity)F=1/(Z-J),Q[10]=J*F,Q[14]=J*Z*F;else Q[10]=-1,Q[14]=-Z;return Q}function lQ(Q,K,$,Z){var J=Math.tan(K.upDegrees*Math.PI/180),V=Math.tan(K.downDegrees*Math.PI/180),F=Math.tan(K.leftDegrees*Math.PI/180),N=Math.tan(K.rightDegrees*Math.PI/180),B=2/(F+N),C=2/(J+V);return Q[0]=B,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=C,Q[6]=0,Q[7]=0,Q[8]=-((F-N)*B*0.5),Q[9]=(J-V)*C*0.5,Q[10]=Z/($-Z),Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=Z*$/($-Z),Q[15]=0,Q}function L0(Q,K,$,Z,J,V,F){var N=1/(K-$),B=1/(Z-J),C=1/(V-F);return Q[0]=-2*N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*B,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=2*C,Q[11]=0,Q[12]=(K+$)*N,Q[13]=(J+Z)*B,Q[14]=(F+V)*C,Q[15]=1,Q}function cQ(Q,K,$,Z,J,V,F){var N=1/(K-$),B=1/(Z-J),C=1/(V-F);return Q[0]=-2*N,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*B,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=C,Q[11]=0,Q[12]=(K+$)*N,Q[13]=(J+Z)*B,Q[14]=V*C,Q[15]=1,Q}function mQ(Q,K,$,Z){var J,V,F,N,B,C,Y,P,X,W,U=K[0],H=K[1],E=K[2],D=Z[0],j=Z[1],T=Z[2],M=$[0],A=$[1],R=$[2];if(Math.abs(U-M)<h&&Math.abs(H-A)<h&&Math.abs(E-R)<h)return j0(Q);if(Y=U-M,P=H-A,X=E-R,W=1/Math.hypot(Y,P,X),Y*=W,P*=W,X*=W,J=j*X-T*P,V=T*Y-D*X,F=D*P-j*Y,W=Math.hypot(J,V,F),!W)J=0,V=0,F=0;else W=1/W,J*=W,V*=W,F*=W;if(N=P*F-X*V,B=X*J-Y*F,C=Y*V-P*J,W=Math.hypot(N,B,C),!W)N=0,B=0,C=0;else W=1/W,N*=W,B*=W,C*=W;return Q[0]=J,Q[1]=N,Q[2]=Y,Q[3]=0,Q[4]=V,Q[5]=B,Q[6]=P,Q[7]=0,Q[8]=F,Q[9]=C,Q[10]=X,Q[11]=0,Q[12]=-(J*U+V*H+F*E),Q[13]=-(N*U+B*H+C*E),Q[14]=-(Y*U+P*H+X*E),Q[15]=1,Q}function sQ(Q,K,$,Z){var J=K[0],V=K[1],F=K[2],N=Z[0],B=Z[1],C=Z[2],Y=J-$[0],P=V-$[1],X=F-$[2],W=Y*Y+P*P+X*X;if(W>0)W=1/Math.sqrt(W),Y*=W,P*=W,X*=W;var U=B*X-C*P,H=C*Y-N*X,E=N*P-B*Y;if(W=U*U+H*H+E*E,W>0)W=1/Math.sqrt(W),U*=W,H*=W,E*=W;return Q[0]=U,Q[1]=H,Q[2]=E,Q[3]=0,Q[4]=P*E-X*H,Q[5]=X*U-Y*E,Q[6]=Y*H-P*U,Q[7]=0,Q[8]=Y,Q[9]=P,Q[10]=X,Q[11]=0,Q[12]=J,Q[13]=V,Q[14]=F,Q[15]=1,Q}function rQ(Q){return"mat4("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+", "+Q[4]+", "+Q[5]+", "+Q[6]+", "+Q[7]+", "+Q[8]+", "+Q[9]+", "+Q[10]+", "+Q[11]+", "+Q[12]+", "+Q[13]+", "+Q[14]+", "+Q[15]+")"}function eQ(Q){return Math.hypot(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7],Q[8],Q[9],Q[10],Q[11],Q[12],Q[13],Q[14],Q[15])}function bQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q[4]=K[4]+$[4],Q[5]=K[5]+$[5],Q[6]=K[6]+$[6],Q[7]=K[7]+$[7],Q[8]=K[8]+$[8],Q[9]=K[9]+$[9],Q[10]=K[10]+$[10],Q[11]=K[11]+$[11],Q[12]=K[12]+$[12],Q[13]=K[13]+$[13],Q[14]=K[14]+$[14],Q[15]=K[15]+$[15],Q}function q0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q[3]=K[3]-$[3],Q[4]=K[4]-$[4],Q[5]=K[5]-$[5],Q[6]=K[6]-$[6],Q[7]=K[7]-$[7],Q[8]=K[8]-$[8],Q[9]=K[9]-$[9],Q[10]=K[10]-$[10],Q[11]=K[11]-$[11],Q[12]=K[12]-$[12],Q[13]=K[13]-$[13],Q[14]=K[14]-$[14],Q[15]=K[15]-$[15],Q}function uQ(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q[4]=K[4]*$,Q[5]=K[5]*$,Q[6]=K[6]*$,Q[7]=K[7]*$,Q[8]=K[8]*$,Q[9]=K[9]*$,Q[10]=K[10]*$,Q[11]=K[11]*$,Q[12]=K[12]*$,Q[13]=K[13]*$,Q[14]=K[14]*$,Q[15]=K[15]*$,Q}function oQ(Q,K,$,Z){return Q[0]=K[0]+$[0]*Z,Q[1]=K[1]+$[1]*Z,Q[2]=K[2]+$[2]*Z,Q[3]=K[3]+$[3]*Z,Q[4]=K[4]+$[4]*Z,Q[5]=K[5]+$[5]*Z,Q[6]=K[6]+$[6]*Z,Q[7]=K[7]+$[7]*Z,Q[8]=K[8]+$[8]*Z,Q[9]=K[9]+$[9]*Z,Q[10]=K[10]+$[10]*Z,Q[11]=K[11]+$[11]*Z,Q[12]=K[12]+$[12]*Z,Q[13]=K[13]+$[13]*Z,Q[14]=K[14]+$[14]*Z,Q[15]=K[15]+$[15]*Z,Q}function tQ(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]&&Q[4]===K[4]&&Q[5]===K[5]&&Q[6]===K[6]&&Q[7]===K[7]&&Q[8]===K[8]&&Q[9]===K[9]&&Q[10]===K[10]&&Q[11]===K[11]&&Q[12]===K[12]&&Q[13]===K[13]&&Q[14]===K[14]&&Q[15]===K[15]}function aQ(Q,K){var $=Q[0],Z=Q[1],J=Q[2],V=Q[3],F=Q[4],N=Q[5],B=Q[6],C=Q[7],Y=Q[8],P=Q[9],X=Q[10],W=Q[11],U=Q[12],H=Q[13],E=Q[14],D=Q[15],j=K[0],T=K[1],M=K[2],A=K[3],R=K[4],I=K[5],G=K[6],L=K[7],q=K[8],w=K[9],p=K[10],v=K[11],_=K[12],f=K[13],i=K[14],l=K[15];return Math.abs($-j)<=h*Math.max(1,Math.abs($),Math.abs(j))&&Math.abs(Z-T)<=h*Math.max(1,Math.abs(Z),Math.abs(T))&&Math.abs(J-M)<=h*Math.max(1,Math.abs(J),Math.abs(M))&&Math.abs(V-A)<=h*Math.max(1,Math.abs(V),Math.abs(A))&&Math.abs(F-R)<=h*Math.max(1,Math.abs(F),Math.abs(R))&&Math.abs(N-I)<=h*Math.max(1,Math.abs(N),Math.abs(I))&&Math.abs(B-G)<=h*Math.max(1,Math.abs(B),Math.abs(G))&&Math.abs(C-L)<=h*Math.max(1,Math.abs(C),Math.abs(L))&&Math.abs(Y-q)<=h*Math.max(1,Math.abs(Y),Math.abs(q))&&Math.abs(P-w)<=h*Math.max(1,Math.abs(P),Math.abs(w))&&Math.abs(X-p)<=h*Math.max(1,Math.abs(X),Math.abs(p))&&Math.abs(W-v)<=h*Math.max(1,Math.abs(W),Math.abs(v))&&Math.abs(U-_)<=h*Math.max(1,Math.abs(U),Math.abs(_))&&Math.abs(H-f)<=h*Math.max(1,Math.abs(H),Math.abs(f))&&Math.abs(E-i)<=h*Math.max(1,Math.abs(E),Math.abs(i))&&Math.abs(D-l)<=h*Math.max(1,Math.abs(D),Math.abs(l))}var yQ=G0,xQ=L0,QK=_0,KK=q0;var m={};u(m,{str:()=>{{return oK}},squaredLength:()=>{{return VQ}},sqrLen:()=>{{return F$}},sqlerp:()=>{{return Y$}},slerp:()=>{{return b}},setAxisAngle:()=>{{return o0}},setAxes:()=>{{return P$}},set:()=>{{return K$}},scale:()=>{{return $Q}},rotationTo:()=>{{return C$}},rotateZ:()=>{{return cK}},rotateY:()=>{{return xK}},rotateX:()=>{{return lK}},random:()=>{{return rK}},pow:()=>{{return sK}},normalize:()=>{{return B0}},multiply:()=>{{return t0}},mul:()=>{{return Z$}},ln:()=>{{return QQ}},lerp:()=>{{return J$}},length:()=>{{return JQ}},len:()=>{{return V$}},invert:()=>{{return eK}},identity:()=>{{return dK}},getAxisAngle:()=>{{return yK}},getAngle:()=>{{return iK}},fromValues:()=>{{return aK}},fromMat3:()=>{{return KQ}},fromEuler:()=>{{return uK}},exp:()=>{{return a0}},exactEquals:()=>{{return N$}},equals:()=>{{return B$}},dot:()=>{{return ZQ}},create:()=>{{return N0}},copy:()=>{{return Q$}},conjugate:()=>{{return bK}},clone:()=>{{return tK}},calculateW:()=>{{return mK}},add:()=>{{return $$}}});var y={};u(y,{zero:()=>{{return kK}},transformQuat:()=>{{return MK}},transformMat4:()=>{{return AK}},transformMat3:()=>{{return RK}},subtract:()=>{{return w0}},sub:()=>{{return qK}},str:()=>{{return SK}},squaredLength:()=>{{return f0}},squaredDistance:()=>{{return z0}},sqrLen:()=>{{return gK}},sqrDist:()=>{{return vK}},set:()=>{{return JK}},scaleAndAdd:()=>{{return EK}},scale:()=>{{return PK}},round:()=>{{return YK}},rotateZ:()=>{{return jK}},rotateY:()=>{{return hK}},rotateX:()=>{{return TK}},random:()=>{{return OK}},normalize:()=>{{return V0}},negate:()=>{{return WK}},multiply:()=>{{return p0}},mul:()=>{{return IK}},min:()=>{{return BK}},max:()=>{{return CK}},lerp:()=>{{return HK}},length:()=>{{return I0}},len:()=>{{return F0}},inverse:()=>{{return XK}},hermite:()=>{{return UK}},fromValues:()=>{{return r}},forEach:()=>{{return zK}},floor:()=>{{return NK}},exactEquals:()=>{{return GK}},equals:()=>{{return LK}},dot:()=>{{return e}},divide:()=>{{return v0}},div:()=>{{return wK}},distance:()=>{{return g0}},dist:()=>{{return pK}},cross:()=>{{return c}},create:()=>{{return s}},copy:()=>{{return ZK}},clone:()=>{{return $K}},ceil:()=>{{return FK}},bezier:()=>{{return DK}},angle:()=>{{return _K}},add:()=>{{return VK}}});function s(){var Q=new S(3);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q}function $K(Q){var K=new S(3);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K}function I0(Q){var K=Q[0],$=Q[1],Z=Q[2];return Math.hypot(K,$,Z)}function r(Q,K,$){var Z=new S(3);return Z[0]=Q,Z[1]=K,Z[2]=$,Z}function ZK(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q}function JK(Q,K,$,Z){return Q[0]=K,Q[1]=$,Q[2]=Z,Q}function VK(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q}function w0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q}function p0(Q,K,$){return Q[0]=K[0]*$[0],Q[1]=K[1]*$[1],Q[2]=K[2]*$[2],Q}function v0(Q,K,$){return Q[0]=K[0]/$[0],Q[1]=K[1]/$[1],Q[2]=K[2]/$[2],Q}function FK(Q,K){return Q[0]=Math.ceil(K[0]),Q[1]=Math.ceil(K[1]),Q[2]=Math.ceil(K[2]),Q}function NK(Q,K){return Q[0]=Math.floor(K[0]),Q[1]=Math.floor(K[1]),Q[2]=Math.floor(K[2]),Q}function BK(Q,K,$){return Q[0]=Math.min(K[0],$[0]),Q[1]=Math.min(K[1],$[1]),Q[2]=Math.min(K[2],$[2]),Q}function CK(Q,K,$){return Q[0]=Math.max(K[0],$[0]),Q[1]=Math.max(K[1],$[1]),Q[2]=Math.max(K[2],$[2]),Q}function YK(Q,K){return Q[0]=Math.round(K[0]),Q[1]=Math.round(K[1]),Q[2]=Math.round(K[2]),Q}function PK(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q}function EK(Q,K,$,Z){return Q[0]=K[0]+$[0]*Z,Q[1]=K[1]+$[1]*Z,Q[2]=K[2]+$[2]*Z,Q}function g0(Q,K){var $=K[0]-Q[0],Z=K[1]-Q[1],J=K[2]-Q[2];return Math.hypot($,Z,J)}function z0(Q,K){var $=K[0]-Q[0],Z=K[1]-Q[1],J=K[2]-Q[2];return $*$+Z*Z+J*J}function f0(Q){var K=Q[0],$=Q[1],Z=Q[2];return K*K+$*$+Z*Z}function WK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q}function XK(Q,K){return Q[0]=1/K[0],Q[1]=1/K[1],Q[2]=1/K[2],Q}function V0(Q,K){var $=K[0],Z=K[1],J=K[2],V=$*$+Z*Z+J*J;if(V>0)V=1/Math.sqrt(V);return Q[0]=K[0]*V,Q[1]=K[1]*V,Q[2]=K[2]*V,Q}function e(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]}function c(Q,K,$){var Z=K[0],J=K[1],V=K[2],F=$[0],N=$[1],B=$[2];return Q[0]=J*B-V*N,Q[1]=V*F-Z*B,Q[2]=Z*N-J*F,Q}function HK(Q,K,$,Z){var J=K[0],V=K[1],F=K[2];return Q[0]=J+Z*($[0]-J),Q[1]=V+Z*($[1]-V),Q[2]=F+Z*($[2]-F),Q}function UK(Q,K,$,Z,J,V){var F=V*V,N=F*(2*V-3)+1,B=F*(V-2)+V,C=F*(V-1),Y=F*(3-2*V);return Q[0]=K[0]*N+$[0]*B+Z[0]*C+J[0]*Y,Q[1]=K[1]*N+$[1]*B+Z[1]*C+J[1]*Y,Q[2]=K[2]*N+$[2]*B+Z[2]*C+J[2]*Y,Q}function DK(Q,K,$,Z,J,V){var F=1-V,N=F*F,B=V*V,C=N*F,Y=3*V*N,P=3*B*F,X=B*V;return Q[0]=K[0]*C+$[0]*Y+Z[0]*P+J[0]*X,Q[1]=K[1]*C+$[1]*Y+Z[1]*P+J[1]*X,Q[2]=K[2]*C+$[2]*Y+Z[2]*P+J[2]*X,Q}function OK(Q,K){K=K||1;var $=d()*2*Math.PI,Z=d()*2-1,J=Math.sqrt(1-Z*Z)*K;return Q[0]=Math.cos($)*J,Q[1]=Math.sin($)*J,Q[2]=Z*K,Q}function AK(Q,K,$){var Z=K[0],J=K[1],V=K[2],F=$[3]*Z+$[7]*J+$[11]*V+$[15];return F=F||1,Q[0]=($[0]*Z+$[4]*J+$[8]*V+$[12])/F,Q[1]=($[1]*Z+$[5]*J+$[9]*V+$[13])/F,Q[2]=($[2]*Z+$[6]*J+$[10]*V+$[14])/F,Q}function RK(Q,K,$){var Z=K[0],J=K[1],V=K[2];return Q[0]=Z*$[0]+J*$[3]+V*$[6],Q[1]=Z*$[1]+J*$[4]+V*$[7],Q[2]=Z*$[2]+J*$[5]+V*$[8],Q}function MK(Q,K,$){var Z=$[0],J=$[1],V=$[2],F=$[3],N=K[0],B=K[1],C=K[2],Y=J*C-V*B,P=V*N-Z*C,X=Z*B-J*N,W=J*X-V*P,U=V*Y-Z*X,H=Z*P-J*Y,E=F*2;return Y*=E,P*=E,X*=E,W*=2,U*=2,H*=2,Q[0]=N+Y+W,Q[1]=B+P+U,Q[2]=C+X+H,Q}function TK(Q,K,$,Z){var J=[],V=[];return J[0]=K[0]-$[0],J[1]=K[1]-$[1],J[2]=K[2]-$[2],V[0]=J[0],V[1]=J[1]*Math.cos(Z)-J[2]*Math.sin(Z),V[2]=J[1]*Math.sin(Z)+J[2]*Math.cos(Z),Q[0]=V[0]+$[0],Q[1]=V[1]+$[1],Q[2]=V[2]+$[2],Q}function hK(Q,K,$,Z){var J=[],V=[];return J[0]=K[0]-$[0],J[1]=K[1]-$[1],J[2]=K[2]-$[2],V[0]=J[2]*Math.sin(Z)+J[0]*Math.cos(Z),V[1]=J[1],V[2]=J[2]*Math.cos(Z)-J[0]*Math.sin(Z),Q[0]=V[0]+$[0],Q[1]=V[1]+$[1],Q[2]=V[2]+$[2],Q}function jK(Q,K,$,Z){var J=[],V=[];return J[0]=K[0]-$[0],J[1]=K[1]-$[1],J[2]=K[2]-$[2],V[0]=J[0]*Math.cos(Z)-J[1]*Math.sin(Z),V[1]=J[0]*Math.sin(Z)+J[1]*Math.cos(Z),V[2]=J[2],Q[0]=V[0]+$[0],Q[1]=V[1]+$[1],Q[2]=V[2]+$[2],Q}function _K(Q,K){var $=Q[0],Z=Q[1],J=Q[2],V=K[0],F=K[1],N=K[2],B=Math.sqrt($*$+Z*Z+J*J),C=Math.sqrt(V*V+F*F+N*N),Y=B*C,P=Y&&e(Q,K)/Y;return Math.acos(Math.min(Math.max(P,-1),1))}function kK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q}function SK(Q){return"vec3("+Q[0]+", "+Q[1]+", "+Q[2]+")"}function GK(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]}function LK(Q,K){var $=Q[0],Z=Q[1],J=Q[2],V=K[0],F=K[1],N=K[2];return Math.abs($-V)<=h*Math.max(1,Math.abs($),Math.abs(V))&&Math.abs(Z-F)<=h*Math.max(1,Math.abs(Z),Math.abs(F))&&Math.abs(J-N)<=h*Math.max(1,Math.abs(J),Math.abs(N))}var qK=w0,IK=p0,wK=v0,pK=g0,vK=z0,F0=I0,gK=f0,zK=function(){var Q=s();return function(K,$,Z,J,V,F){var N,B;if(!$)$=3;if(!Z)Z=0;if(J)B=Math.min(J*$+Z,K.length);else B=K.length;for(N=Z;N<B;N+=$)Q[0]=K[N],Q[1]=K[N+1],Q[2]=K[N+2],V(Q,Q,F),K[N]=Q[0],K[N+1]=Q[1],K[N+2]=Q[2];return K}}();function fK(){var Q=new S(4);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=0;return Q}function n0(Q){var K=new S(4);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K}function d0(Q,K,$,Z){var J=new S(4);return J[0]=Q,J[1]=K,J[2]=$,J[3]=Z,J}function y0(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q}function i0(Q,K,$,Z,J){return Q[0]=K,Q[1]=$,Q[2]=Z,Q[3]=J,Q}function l0(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q}function x0(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q}function c0(Q){var K=Q[0],$=Q[1],Z=Q[2],J=Q[3];return Math.hypot(K,$,Z,J)}function m0(Q){var K=Q[0],$=Q[1],Z=Q[2],J=Q[3];return K*K+$*$+Z*Z+J*J}function s0(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=$*$+Z*Z+J*J+V*V;if(F>0)F=1/Math.sqrt(F);return Q[0]=$*F,Q[1]=Z*F,Q[2]=J*F,Q[3]=V*F,Q}function r0(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]+Q[3]*K[3]}function e0(Q,K,$,Z){var J=K[0],V=K[1],F=K[2],N=K[3];return Q[0]=J+Z*($[0]-J),Q[1]=V+Z*($[1]-V),Q[2]=F+Z*($[2]-F),Q[3]=N+Z*($[3]-N),Q}function b0(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]}function u0(Q,K){var $=Q[0],Z=Q[1],J=Q[2],V=Q[3],F=K[0],N=K[1],B=K[2],C=K[3];return Math.abs($-F)<=h*Math.max(1,Math.abs($),Math.abs(F))&&Math.abs(Z-N)<=h*Math.max(1,Math.abs(Z),Math.abs(N))&&Math.abs(J-B)<=h*Math.max(1,Math.abs(J),Math.abs(B))&&Math.abs(V-C)<=h*Math.max(1,Math.abs(V),Math.abs(C))}var y$=function(){var Q=fK();return function(K,$,Z,J,V,F){var N,B;if(!$)$=4;if(!Z)Z=0;if(J)B=Math.min(J*$+Z,K.length);else B=K.length;for(N=Z;N<B;N+=$)Q[0]=K[N],Q[1]=K[N+1],Q[2]=K[N+2],Q[3]=K[N+3],V(Q,Q,F),K[N]=Q[0],K[N+1]=Q[1],K[N+2]=Q[2],K[N+3]=Q[3];return K}}();function N0(){var Q=new S(4);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q[3]=1,Q}function dK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=1,Q}function o0(Q,K,$){$=$*0.5;var Z=Math.sin($);return Q[0]=Z*K[0],Q[1]=Z*K[1],Q[2]=Z*K[2],Q[3]=Math.cos($),Q}function yK(Q,K){var $=Math.acos(K[3])*2,Z=Math.sin($/2);if(Z>h)Q[0]=K[0]/Z,Q[1]=K[1]/Z,Q[2]=K[2]/Z;else Q[0]=1,Q[1]=0,Q[2]=0;return $}function iK(Q,K){var $=ZQ(Q,K);return Math.acos(2*$*$-1)}function t0(Q,K,$){var Z=K[0],J=K[1],V=K[2],F=K[3],N=$[0],B=$[1],C=$[2],Y=$[3];return Q[0]=Z*Y+F*N+J*C-V*B,Q[1]=J*Y+F*B+V*N-Z*C,Q[2]=V*Y+F*C+Z*B-J*N,Q[3]=F*Y-Z*N-J*B-V*C,Q}function lK(Q,K,$){$*=0.5;var Z=K[0],J=K[1],V=K[2],F=K[3],N=Math.sin($),B=Math.cos($);return Q[0]=Z*B+F*N,Q[1]=J*B+V*N,Q[2]=V*B-J*N,Q[3]=F*B-Z*N,Q}function xK(Q,K,$){$*=0.5;var Z=K[0],J=K[1],V=K[2],F=K[3],N=Math.sin($),B=Math.cos($);return Q[0]=Z*B-V*N,Q[1]=J*B+F*N,Q[2]=V*B+Z*N,Q[3]=F*B-J*N,Q}function cK(Q,K,$){$*=0.5;var Z=K[0],J=K[1],V=K[2],F=K[3],N=Math.sin($),B=Math.cos($);return Q[0]=Z*B+J*N,Q[1]=J*B-Z*N,Q[2]=V*B+F*N,Q[3]=F*B-V*N,Q}function mK(Q,K){var $=K[0],Z=K[1],J=K[2];return Q[0]=$,Q[1]=Z,Q[2]=J,Q[3]=Math.sqrt(Math.abs(1-$*$-Z*Z-J*J)),Q}function a0(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=Math.sqrt($*$+Z*Z+J*J),N=Math.exp(V),B=F>0?N*Math.sin(F)/F:0;return Q[0]=$*B,Q[1]=Z*B,Q[2]=J*B,Q[3]=N*Math.cos(F),Q}function QQ(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=Math.sqrt($*$+Z*Z+J*J),N=F>0?Math.atan2(F,V)/F:0;return Q[0]=$*N,Q[1]=Z*N,Q[2]=J*N,Q[3]=0.5*Math.log($*$+Z*Z+J*J+V*V),Q}function sK(Q,K,$){return QQ(Q,K),$Q(Q,Q,$),a0(Q,Q),Q}function b(Q,K,$,Z){var J=K[0],V=K[1],F=K[2],N=K[3],B=$[0],C=$[1],Y=$[2],P=$[3],X,W,U,H,E;if(W=J*B+V*C+F*Y+N*P,W<0)W=-W,B=-B,C=-C,Y=-Y,P=-P;if(1-W>h)X=Math.acos(W),U=Math.sin(X),H=Math.sin((1-Z)*X)/U,E=Math.sin(Z*X)/U;else H=1-Z,E=Z;return Q[0]=H*J+E*B,Q[1]=H*V+E*C,Q[2]=H*F+E*Y,Q[3]=H*N+E*P,Q}function rK(Q){var K=d(),$=d(),Z=d(),J=Math.sqrt(1-K),V=Math.sqrt(K);return Q[0]=J*Math.sin(2*Math.PI*$),Q[1]=J*Math.cos(2*Math.PI*$),Q[2]=V*Math.sin(2*Math.PI*Z),Q[3]=V*Math.cos(2*Math.PI*Z),Q}function eK(Q,K){var $=K[0],Z=K[1],J=K[2],V=K[3],F=$*$+Z*Z+J*J+V*V,N=F?1/F:0;return Q[0]=-$*N,Q[1]=-Z*N,Q[2]=-J*N,Q[3]=V*N,Q}function bK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q[3]=K[3],Q}function KQ(Q,K){var $=K[0]+K[4]+K[8],Z;if($>0)Z=Math.sqrt($+1),Q[3]=0.5*Z,Z=0.5/Z,Q[0]=(K[5]-K[7])*Z,Q[1]=(K[6]-K[2])*Z,Q[2]=(K[1]-K[3])*Z;else{var J=0;if(K[4]>K[0])J=1;if(K[8]>K[J*3+J])J=2;var V=(J+1)%3,F=(J+2)%3;Z=Math.sqrt(K[J*3+J]-K[V*3+V]-K[F*3+F]+1),Q[J]=0.5*Z,Z=0.5/Z,Q[3]=(K[V*3+F]-K[F*3+V])*Z,Q[V]=(K[V*3+J]+K[J*3+V])*Z,Q[F]=(K[F*3+J]+K[J*3+F])*Z}return Q}function uK(Q,K,$,Z){var J=0.5*Math.PI/180;K*=J,$*=J,Z*=J;var V=Math.sin(K),F=Math.cos(K),N=Math.sin($),B=Math.cos($),C=Math.sin(Z),Y=Math.cos(Z);return Q[0]=V*B*Y-F*N*C,Q[1]=F*N*Y+V*B*C,Q[2]=F*B*C-V*N*Y,Q[3]=F*B*Y+V*N*C,Q}function oK(Q){return"quat("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+")"}var tK=n0,aK=d0,Q$=y0,K$=i0,$$=l0,Z$=t0,$Q=x0,ZQ=r0,J$=e0,JQ=c0,V$=JQ,VQ=m0,F$=VQ,B0=s0,N$=b0,B$=u0,C$=function(){var Q=s(),K=r(1,0,0),$=r(0,1,0);return function(Z,J,V){var F=e(J,V);if(F<-0.999999){if(c(Q,K,J),F0(Q)<0.000001)c(Q,$,J);return V0(Q,Q),o0(Z,Q,Math.PI),Z}else if(F>0.999999)return Z[0]=0,Z[1]=0,Z[2]=0,Z[3]=1,Z;else return c(Q,J,V),Z[0]=Q[0],Z[1]=Q[1],Z[2]=Q[2],Z[3]=1+F,B0(Z,Z)}}(),Y$=function(){var Q=N0(),K=N0();return function($,Z,J,V,F,N){return b(Q,Z,F,N),b(K,J,V,N),b($,Q,K,2*N*(1-N)),$}}(),P$=function(){var Q=h0();return function(K,$,Z,J){return Q[0]=Z[0],Q[3]=Z[1],Q[6]=Z[2],Q[1]=J[0],Q[4]=J[1],Q[7]=J[2],Q[2]=-$[0],Q[5]=-$[1],Q[8]=-$[2],B0(K,KQ(K,Q))}}();var E$=Math.PI/90;class C0{matrix;constructor(){this.matrix=k.create()}static create(){return new C0}translate(Q,K,$){return k.translate(this.matrix,this.matrix,[Q,K,$]),this}rotateX(Q){return k.rotateX(this.matrix,this.matrix,Q),this}rotateY(Q){return k.rotateY(this.matrix,this.matrix,Q),this}rotateZ(Q){return k.rotateZ(this.matrix,this.matrix,Q),this}scale(Q,K,$){return k.scale(this.matrix,this.matrix,[Q,K,$]),this}perspective(Q,K,$,Z){return k.perspective(this.matrix,Q*E$,K,$,Z),this}ortho(Q,K,$,Z,J,V){return k.ortho(this.matrix,Q,K,$,Z,J,V),this}static aTemp=k.create();static bTemp=k.create();static combineMat4(Q,K,$,Z=0.5){k.multiplyScalar(this.aTemp,K,1-Z),k.multiplyScalar(this.bTemp,$,Z),k.add(Q,this.aTemp,this.bTemp)}static tempQuat=m.create();static moveMatrix(Q,K,$,Z,J=null){const V=y.fromValues(-K,$,Z);if(J)k.getRotation(this.tempQuat,J),m.invert(this.tempQuat,this.tempQuat),y.transformQuat(V,V,this.tempQuat);k.translate(Q,Q,V)}getMatrix(){return this.matrix}}var z=C0;class Y0{gl;uniforms;cameraMatrix=z.create().translate(0,0,-1).getMatrix();perspectiveMatrix=z.create().getMatrix();orthoMatrix=z.create().getMatrix();projectionMatrix=z.create().getMatrix();perspectiveLevel=1;constructor(Q,K){this.gl=Q,this.uniforms=K}configPerspectiveMatrix(Q){this.perspectiveMatrix=z.create().perspective(45,Q,0.1,1000).getMatrix(),this.updatePerspective()}configOrthoMatrix(Q){this.orthoMatrix=z.create().ortho(-Q,Q,-1,1,-1000,1000).getMatrix(),this.updatePerspective()}camTiltMatrix=z.create().getMatrix();camTurnMatrix=z.create().getMatrix();camMatrix=k.create();refresh(){k.mul(this.camMatrix,this.camTiltMatrix,this.camTurnMatrix),k.mul(this.camMatrix,this.camMatrix,this.cameraMatrix);const Q=this.uniforms.getUniformLocation(O0);if(Q)this.gl.uniformMatrix4fv(Q,!1,this.camMatrix)}orthoTemp=k.create();perspectiveTemp=k.create();updatePerspective(Q){if(Q!==void 0)this.perspectiveLevel=Q;z.combineMat4(this.projectionMatrix,this.orthoMatrix,this.perspectiveMatrix,this.perspectiveLevel);const K=this.uniforms.getUniformLocation(A0);if(K)this.gl.uniformMatrix4fv(K,!1,this.projectionMatrix);this.refresh()}moveCam(Q,K,$){z.moveMatrix(this.cameraMatrix,Q,K,$,this.camTurnMatrix),this.refresh()}turnCam(Q){k.rotateY(this.camTurnMatrix,this.camTurnMatrix,Q),this.refresh()}tilt(Q){k.rotateX(this.camTiltMatrix,this.camTiltMatrix,Q),this.refresh()}}var H$=function(Q){if(!X$)return Q;return new Proxy(Q,{get($,Z){const J=$,V=J[Z];if(typeof V==="function")return(...N)=>{const B=V.apply(J,N);return console.log(`gl.${String(Z)}(`,N,") = ",B),B};else return console.log(`gl.${String(Z)} = `,V),V}})},W$={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},X$=!1;class P0 extends g{gl;programs;attributeBuffers;uniforms;canvas;textureManager;camera;constructor(Q,K){super();this.gl=H$(Q.getContext("webgl2",{...W$,...K})),this.canvas=Q,this.programs=this.own(new t(this.gl)),this.uniforms=this.own(new K0(this.gl,this.programs)),this.attributeBuffers=this.own(new Q0(this.gl,this.programs)),this.textureManager=new Z0(this.gl),this.camera=new Y0(this.gl,this.uniforms),window.addEventListener("resize",this.checkCanvasSize.bind(this))}checkCanvasSize(){this.canvas.width=this.canvas.offsetWidth*2,this.canvas.height=this.canvas.offsetHeight*2,this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const Q=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;this.camera.configOrthoMatrix(Q),this.camera.configPerspectiveMatrix(Q)}async initialize(){const K={AUTHOR:"Jack le hamster"};this.programs.addProgram("main",J0(M0,K),J0(T0,K)),this.programs.useProgram("main"),this.gl.enable(O.DEPTH_TEST),this.gl.depthFunc(O.LESS),this.gl.enable(O.BLEND),this.gl.blendFunc(O.SRC_ALPHA,O.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);{const $=X0;this.attributeBuffers.createBuffer($);const Z=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(O.ELEMENT_ARRAY_BUFFER,Z),this.attributeBuffers.bufferData(O.ELEMENT_ARRAY_BUFFER,$,Uint16Array.from([0,1,2,2,3,0]),0,O.STATIC_DRAW)}{const $=$0;this.attributeBuffers.createBuffer($);const Z=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(O.ARRAY_BUFFER,Z),this.gl.vertexAttribPointer(Z.location,2,O.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(Z.location),this.attributeBuffers.bufferData(O.ARRAY_BUFFER,$,Float32Array.from([-1,-1,1,-1,1,1,-1,1]),0,O.STATIC_DRAW)}{const $=H0;this.attributeBuffers.createBuffer($);const Z=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(O.ARRAY_BUFFER,Z);for(let J=0;J<4;J++){const V=Z.location+J;this.gl.vertexAttribPointer(V,4,O.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,J*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(V),this.gl.vertexAttribDivisor(V,1)}this.attributeBuffers.bufferData(O.ARRAY_BUFFER,$,Float32Array.from([...z.create().getMatrix(),...z.create().translate(-1,0,1).rotateY(Math.PI/2).getMatrix(),...z.create().translate(1,0,1).rotateY(-Math.PI/2).getMatrix()]),0,O.DYNAMIC_DRAW)}{const $=U0;this.attributeBuffers.createBuffer($);const Z=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(O.ARRAY_BUFFER,Z),this.gl.vertexAttribPointer(Z.location,2,O.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(Z.location),this.attributeBuffers.bufferData(O.ARRAY_BUFFER,$,Float32Array.from([0,1,1,1,1,0,0,0]),0,O.STATIC_DRAW)}await this.loadLogoTexture(),this.checkCanvasSize(),this.camera.refresh()}async loadLogoTexture(){{const $=D0;this.attributeBuffers.createBuffer($);const Z=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(O.ARRAY_BUFFER,Z);const J=Z.location;this.gl.vertexAttribPointer(J,2,O.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT,0),this.gl.enableVertexAttribArray(J),this.gl.vertexAttribDivisor(J,1),this.attributeBuffers.bufferData(O.ARRAY_BUFFER,$,Float32Array.from([512,512,512,512,512,512]),0,O.DYNAMIC_DRAW)}await this.textureManager.drawImage("logo",($)=>{const{canvas:Z}=$;Z.width=2048,Z.height=2048,$.imageSmoothingEnabled=!0,$.fillStyle="#ddd",$.lineWidth=Z.width/50,$.fillRect(0,0,Z.width,Z.height),$.strokeStyle="black",$.fillStyle="gold",$.beginPath(),$.arc(Z.width/2,Z.height/2,Z.width/2*0.8,0,2*Math.PI),$.fill(),$.stroke(),$.beginPath(),$.arc(Z.width/2,Z.height/2,Z.width/2*0.5,0,Math.PI),$.stroke(),$.beginPath(),$.arc(Z.width/3,Z.height/3,Z.width/2*0.1,0,Math.PI,!0),$.stroke(),$.beginPath(),$.arc(Z.width/3*2,Z.height/3,Z.width/2*0.1,0,Math.PI*2,!0),$.stroke()}),this.textureManager.assignImageToTexture("logo","TEXTURE0",[0,0,2048,2048],[0,0,512,512]),this.textureManager.generateMipMap("TEXTURE0")}updateTrianglePosition(Q,K){const $=this.attributeBuffers.getAttributeBuffer($0);this.attributeBuffers.bindBuffer(O.ARRAY_BUFFER,$),this.attributeBuffers.bufferSubData(O.ARRAY_BUFFER,Float32Array.from(K),Q*4*3*Float32Array.BYTES_PER_ELEMENT)}drawArrays(Q){this.gl.drawArrays(O.TRIANGLES,0,Q)}drawElementsInstanced(Q,K){this.gl.clearDepth(1),this.gl.clear(O.COLOR_BUFFER_BIT|O.DEPTH_BUFFER_BIT),this.gl.drawElementsInstanced(O.TRIANGLES,Q,O.UNSIGNED_SHORT,0,K)}bindVertexArray(){return this.own(new a(this.gl))}}async function CZ(){console.log("Hello World!")}function YZ(Q){Q.style.border="2px solid silver",Q.style.cursor="grab",Q.addEventListener("mouseenter",()=>{Q.style.borderColor="black"}),Q.addEventListener("mouseleave",()=>{Q.style.borderColor="silver"});const K=new P0(Q);K.initialize();const $={};document.addEventListener("keydown",(J)=>{$[J.code]=!0,console.log($)}),document.addEventListener("keyup",(J)=>{$[J.code]=!1});function Z(){K.gl.enable(K.gl.DEPTH_TEST),K.gl.depthFunc(K.gl.LEQUAL),K.gl.clearDepth(1),K.gl.clear(K.gl.COLOR_BUFFER_BIT|K.gl.DEPTH_BUFFER_BIT);const J=0.25,V=0.05;if($.KeyW)K.camera.moveCam(0,0,J);if($.KeyS)K.camera.moveCam(0,0,-J);if($.ArrowUp&&!$.ShiftRight)K.camera.moveCam(0,-J,0);if($.ArrowDown&&!$.ShiftRight)K.camera.moveCam(0,J,0);if($.KeyA||$.ArrowLeft&&!$.ShiftRight)K.camera.moveCam(-J,0,0);if($.KeyD||$.ArrowRight&&!$.ShiftRight)K.camera.moveCam(J,0,0);if($.KeyQ||$.ArrowLeft&&$.ShiftRight)K.camera.turnCam(-V);if($.KeyE||$.ArrowRight&&$.ShiftRight)K.camera.turnCam(V);if($.ArrowUp&&$.ShiftRight)K.camera.tilt(-V);if($.ArrowDown&&$.ShiftRight)K.camera.tilt(V);const F=6,N=3;K.drawElementsInstanced(F,N),requestAnimationFrame(Z)}return Z(),K}export{YZ as testCanvas,CZ as hello};

//# debugId=3E6C412B2AC4F60764756e2164756e21
