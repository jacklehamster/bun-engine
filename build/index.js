var $Q=Object.defineProperty;var u=(Q,K)=>{for(var $ in K)$Q(Q,$,{get:K[$],enumerable:!0,configurable:!0,set:(J)=>K[$]=()=>J})};class g{disposables;own(Q){if(!this.disposables)this.disposables=new Set;return this.disposables.add(Q),Q}addOnDestroy(Q){this.disposables?.add({destroy:Q})}destroy(){this.disposables?.forEach((Q)=>Q.destroy())}}var JQ=function(Q,K,$){function J(M,Y){function H(E){return E===Q?.VERTEX_SHADER?"vertex":E===Q?.FRAGMENT_SHADER?"fragment":void 0}if(Y!==Q.VERTEX_SHADER&&Y!==Q.FRAGMENT_SHADER)throw new Error(`Shader error in ${H(Y)}`);const W=Q.createShader(Y);if(!W)throw new Error(`Unable to generate ${H(Y)} shader.`);if(Q.shaderSource(W,M),Q.compileShader(W),!Q.getShaderParameter(W,Q.COMPILE_STATUS))console.error(`Shader compile error in ${H(Y)}:`+Q.getShaderInfoLog(W));return W}const N=Q.createProgram();if(!N)throw new Error("Unable to create program.");const Z=J(K,Q.VERTEX_SHADER),C=J($,Q.FRAGMENT_SHADER),V=Q.getShaderInfoLog(Z),B=Q.getShaderInfoLog(C);if(V)console.log("VERTEX",V);if(B)console.log("FRAGMENT",B);Q.attachShader(N,Z),Q.attachShader(N,C),Q.linkProgram(N);const F=Q.getProgramInfoLog(N);if(F)console.log("PROGRAM",F);if(Q.detachShader(N,Z),Q.detachShader(N,C),Q.deleteShader(Z),Q.deleteShader(C),Q.validateProgram(N),Object.entries(WebGL2RenderingContext).forEach(([M,Y])=>{if(Y&&Q.getError()===Y)console.log(`gl.${M}`)}),!Q.getProgramParameter(N,Q.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+Q.getProgramInfoLog(N));return N},NQ=function(Q,K){Q.deleteProgram(K)};class o extends g{gl;program;constructor(Q,K,$){super();this.gl=Q,this.program=JQ(Q,K.trim(),$.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),NQ(this.gl,this.program)}}class t extends g{activeProgramId="";gl;programs={};constructor(Q){super();this.gl=Q}addProgram(Q,K,$){if(this.programs[Q])this.removeProgram(Q);this.programs[Q]=this.own(new o(this.gl,K,$))}useProgram(Q){if(this.activeProgramId!==Q)this.activeProgramId=Q,this.programs[Q].use()}removeProgram(Q){this.programs[Q].destroy(),delete this.programs[Q]}getProgram(Q){return this.programs[Q??this.activeProgramId]?.program}}class a extends g{gl;triangleArray;constructor(Q){super();this.gl=Q,this.triangleArray=Q.createVertexArray(),Q.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class Q0 extends g{bufferRecord={};lastBoundBuffer;gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getAttributeLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getAttribLocation($,Q)??-1:-1}createBuffer(Q){this.deleteBuffer(Q);const K=this.gl?.createBuffer();if(!K)throw new Error(`Unable to create buffer "${Q}"`);const $={buffer:K,location:this.getAttributeLocation(Q)};return this.bufferRecord[Q]=$,$}deleteBuffer(Q){if(this.bufferRecord[Q])this.gl.deleteBuffer(this.bufferRecord[Q].buffer),delete this.bufferRecord[Q]}getAttributeBuffer(Q,K){const $=this.bufferRecord[Q];if(!$){if(K)return this.createBuffer(Q);throw new Error(`Attribute "${Q}" not created. Make sure "createBuffer" is called.`)}return $}bufferData(Q,K,$,J,N){const Z=this.getAttributeBuffer(K);if($)this.gl.bufferData(Q,$,N);else this.gl.bufferData(Q,J,N);Z.bufferSize=J||$?.length,Z.bufferArray=$??new Float32Array(Z.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),Z.usage=N,Z.target=Q}bufferSubData(Q,K,$,J,N){if(J)this.gl.bufferSubData(Q,$,K,J,N);else this.gl.bufferSubData(Q,$,K)}bindBuffer(Q,K){if(this.lastBoundBuffer!==K)this.lastBoundBuffer=K,this.gl.bindBuffer(Q,K.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((Q)=>this.deleteBuffer(Q))}}class K0 extends g{gl;programs;constructor(Q,K){super();this.gl=Q,this.programs=K}getUniformLocation(Q,K){const $=this.programs.getProgram(K);return $?this.gl.getUniformLocation($,Q)??void 0:void 0}}var U=WebGL2RenderingContext,$0="position",P0="index",W0="transform",H0="tex",X0="cam";var h=0.000001,S=typeof Float32Array!=="undefined"?Float32Array:Array,z=Math.random,T$=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var Q=0,K=arguments.length;while(K--)Q+=arguments[K]*arguments[K];return Math.sqrt(Q)};function E0(){var Q=new S(9);if(S!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[5]=0,Q[6]=0,Q[7]=0;return Q[0]=1,Q[4]=1,Q[8]=1,Q}var j={};u(j,{transpose:()=>{{return YQ}},translate:()=>{{return XQ}},targetTo:()=>{{return yQ}},subtract:()=>{{return j0}},sub:()=>{{return bQ}},str:()=>{{return lQ}},set:()=>{{return MQ}},scale:()=>{{return EQ}},rotateZ:()=>{{return OQ}},rotateY:()=>{{return AQ}},rotateX:()=>{{return UQ}},rotate:()=>{{return DQ}},perspectiveZO:()=>{{return gQ}},perspectiveNO:()=>{{return k0}},perspectiveFromFieldOfView:()=>{{return nQ}},perspective:()=>{{return vQ}},orthoZO:()=>{{return zQ}},orthoNO:()=>{{return R0}},ortho:()=>{{return fQ}},multiplyScalarAndAdd:()=>{{return mQ}},multiplyScalar:()=>{{return cQ}},multiply:()=>{{return U0}},mul:()=>{{return eQ}},lookAt:()=>{{return dQ}},invert:()=>{{return PQ}},identity:()=>{{return D0}},getTranslation:()=>{{return GQ}},getScaling:()=>{{return O0}},getRotation:()=>{{return LQ}},frustum:()=>{{return pQ}},fromZRotation:()=>{{return _Q}},fromYRotation:()=>{{return TQ}},fromXRotation:()=>{{return hQ}},fromValues:()=>{{return FQ}},fromTranslation:()=>{{return kQ}},fromScaling:()=>{{return RQ}},fromRotationTranslationScaleOrigin:()=>{{return IQ}},fromRotationTranslationScale:()=>{{return qQ}},fromRotationTranslation:()=>{{return A0}},fromRotation:()=>{{return jQ}},fromQuat2:()=>{{return SQ}},fromQuat:()=>{{return wQ}},frob:()=>{{return iQ}},exactEquals:()=>{{return sQ}},equals:()=>{{return rQ}},determinant:()=>{{return HQ}},create:()=>{{return CQ}},copy:()=>{{return BQ}},clone:()=>{{return VQ}},adjoint:()=>{{return WQ}},add:()=>{{return xQ}}});function CQ(){var Q=new S(16);if(S!=Float32Array)Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0;return Q[0]=1,Q[5]=1,Q[10]=1,Q[15]=1,Q}function VQ(Q){var K=new S(16);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function BQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function FQ(Q,K,$,J,N,Z,C,V,B,F,M,Y,H,W,E,X){var P=new S(16);return P[0]=Q,P[1]=K,P[2]=$,P[3]=J,P[4]=N,P[5]=Z,P[6]=C,P[7]=V,P[8]=B,P[9]=F,P[10]=M,P[11]=Y,P[12]=H,P[13]=W,P[14]=E,P[15]=X,P}function MQ(Q,K,$,J,N,Z,C,V,B,F,M,Y,H,W,E,X,P){return Q[0]=K,Q[1]=$,Q[2]=J,Q[3]=N,Q[4]=Z,Q[5]=C,Q[6]=V,Q[7]=B,Q[8]=F,Q[9]=M,Q[10]=Y,Q[11]=H,Q[12]=W,Q[13]=E,Q[14]=X,Q[15]=P,Q}function D0(Q){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function YQ(Q,K){if(Q===K){var $=K[1],J=K[2],N=K[3],Z=K[6],C=K[7],V=K[11];Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=$,Q[6]=K[9],Q[7]=K[13],Q[8]=J,Q[9]=Z,Q[11]=K[14],Q[12]=N,Q[13]=C,Q[14]=V}else Q[0]=K[0],Q[1]=K[4],Q[2]=K[8],Q[3]=K[12],Q[4]=K[1],Q[5]=K[5],Q[6]=K[9],Q[7]=K[13],Q[8]=K[2],Q[9]=K[6],Q[10]=K[10],Q[11]=K[14],Q[12]=K[3],Q[13]=K[7],Q[14]=K[11],Q[15]=K[15];return Q}function PQ(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=K[4],V=K[5],B=K[6],F=K[7],M=K[8],Y=K[9],H=K[10],W=K[11],E=K[12],X=K[13],P=K[14],D=K[15],T=$*V-J*C,R=$*B-N*C,k=$*F-Z*C,A=J*B-N*V,O=J*F-Z*V,I=N*F-Z*B,G=M*X-Y*E,L=M*P-H*E,q=M*D-W*E,w=Y*P-H*X,p=Y*D-W*X,v=H*D-W*P,_=T*v-R*p+k*w+A*q-O*L+I*G;if(!_)return null;return _=1/_,Q[0]=(V*v-B*p+F*w)*_,Q[1]=(N*p-J*v-Z*w)*_,Q[2]=(X*I-P*O+D*A)*_,Q[3]=(H*O-Y*I-W*A)*_,Q[4]=(B*q-C*v-F*L)*_,Q[5]=($*v-N*q+Z*L)*_,Q[6]=(P*k-E*I-D*R)*_,Q[7]=(M*I-H*k+W*R)*_,Q[8]=(C*p-V*q+F*G)*_,Q[9]=(J*q-$*p-Z*G)*_,Q[10]=(E*O-X*k+D*T)*_,Q[11]=(Y*k-M*O-W*T)*_,Q[12]=(V*L-C*w-B*G)*_,Q[13]=($*w-J*L+N*G)*_,Q[14]=(X*R-E*A-P*T)*_,Q[15]=(M*A-Y*R+H*T)*_,Q}function WQ(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=K[4],V=K[5],B=K[6],F=K[7],M=K[8],Y=K[9],H=K[10],W=K[11],E=K[12],X=K[13],P=K[14],D=K[15];return Q[0]=V*(H*D-W*P)-Y*(B*D-F*P)+X*(B*W-F*H),Q[1]=-(J*(H*D-W*P)-Y*(N*D-Z*P)+X*(N*W-Z*H)),Q[2]=J*(B*D-F*P)-V*(N*D-Z*P)+X*(N*F-Z*B),Q[3]=-(J*(B*W-F*H)-V*(N*W-Z*H)+Y*(N*F-Z*B)),Q[4]=-(C*(H*D-W*P)-M*(B*D-F*P)+E*(B*W-F*H)),Q[5]=$*(H*D-W*P)-M*(N*D-Z*P)+E*(N*W-Z*H),Q[6]=-($*(B*D-F*P)-C*(N*D-Z*P)+E*(N*F-Z*B)),Q[7]=$*(B*W-F*H)-C*(N*W-Z*H)+M*(N*F-Z*B),Q[8]=C*(Y*D-W*X)-M*(V*D-F*X)+E*(V*W-F*Y),Q[9]=-($*(Y*D-W*X)-M*(J*D-Z*X)+E*(J*W-Z*Y)),Q[10]=$*(V*D-F*X)-C*(J*D-Z*X)+E*(J*F-Z*V),Q[11]=-($*(V*W-F*Y)-C*(J*W-Z*Y)+M*(J*F-Z*V)),Q[12]=-(C*(Y*P-H*X)-M*(V*P-B*X)+E*(V*H-B*Y)),Q[13]=$*(Y*P-H*X)-M*(J*P-N*X)+E*(J*H-N*Y),Q[14]=-($*(V*P-B*X)-C*(J*P-N*X)+E*(J*B-N*V)),Q[15]=$*(V*H-B*Y)-C*(J*H-N*Y)+M*(J*B-N*V),Q}function HQ(Q){var K=Q[0],$=Q[1],J=Q[2],N=Q[3],Z=Q[4],C=Q[5],V=Q[6],B=Q[7],F=Q[8],M=Q[9],Y=Q[10],H=Q[11],W=Q[12],E=Q[13],X=Q[14],P=Q[15],D=K*C-$*Z,T=K*V-J*Z,R=K*B-N*Z,k=$*V-J*C,A=$*B-N*C,O=J*B-N*V,I=F*E-M*W,G=F*X-Y*W,L=F*P-H*W,q=M*X-Y*E,w=M*P-H*E,p=Y*P-H*X;return D*p-T*w+R*q+k*L-A*G+O*I}function U0(Q,K,$){var J=K[0],N=K[1],Z=K[2],C=K[3],V=K[4],B=K[5],F=K[6],M=K[7],Y=K[8],H=K[9],W=K[10],E=K[11],X=K[12],P=K[13],D=K[14],T=K[15],R=$[0],k=$[1],A=$[2],O=$[3];return Q[0]=R*J+k*V+A*Y+O*X,Q[1]=R*N+k*B+A*H+O*P,Q[2]=R*Z+k*F+A*W+O*D,Q[3]=R*C+k*M+A*E+O*T,R=$[4],k=$[5],A=$[6],O=$[7],Q[4]=R*J+k*V+A*Y+O*X,Q[5]=R*N+k*B+A*H+O*P,Q[6]=R*Z+k*F+A*W+O*D,Q[7]=R*C+k*M+A*E+O*T,R=$[8],k=$[9],A=$[10],O=$[11],Q[8]=R*J+k*V+A*Y+O*X,Q[9]=R*N+k*B+A*H+O*P,Q[10]=R*Z+k*F+A*W+O*D,Q[11]=R*C+k*M+A*E+O*T,R=$[12],k=$[13],A=$[14],O=$[15],Q[12]=R*J+k*V+A*Y+O*X,Q[13]=R*N+k*B+A*H+O*P,Q[14]=R*Z+k*F+A*W+O*D,Q[15]=R*C+k*M+A*E+O*T,Q}function XQ(Q,K,$){var J=$[0],N=$[1],Z=$[2],C,V,B,F,M,Y,H,W,E,X,P,D;if(K===Q)Q[12]=K[0]*J+K[4]*N+K[8]*Z+K[12],Q[13]=K[1]*J+K[5]*N+K[9]*Z+K[13],Q[14]=K[2]*J+K[6]*N+K[10]*Z+K[14],Q[15]=K[3]*J+K[7]*N+K[11]*Z+K[15];else C=K[0],V=K[1],B=K[2],F=K[3],M=K[4],Y=K[5],H=K[6],W=K[7],E=K[8],X=K[9],P=K[10],D=K[11],Q[0]=C,Q[1]=V,Q[2]=B,Q[3]=F,Q[4]=M,Q[5]=Y,Q[6]=H,Q[7]=W,Q[8]=E,Q[9]=X,Q[10]=P,Q[11]=D,Q[12]=C*J+M*N+E*Z+K[12],Q[13]=V*J+Y*N+X*Z+K[13],Q[14]=B*J+H*N+P*Z+K[14],Q[15]=F*J+W*N+D*Z+K[15];return Q}function EQ(Q,K,$){var J=$[0],N=$[1],Z=$[2];return Q[0]=K[0]*J,Q[1]=K[1]*J,Q[2]=K[2]*J,Q[3]=K[3]*J,Q[4]=K[4]*N,Q[5]=K[5]*N,Q[6]=K[6]*N,Q[7]=K[7]*N,Q[8]=K[8]*Z,Q[9]=K[9]*Z,Q[10]=K[10]*Z,Q[11]=K[11]*Z,Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function DQ(Q,K,$,J){var N=J[0],Z=J[1],C=J[2],V=Math.hypot(N,Z,C),B,F,M,Y,H,W,E,X,P,D,T,R,k,A,O,I,G,L,q,w,p,v,_,n;if(V<h)return null;if(V=1/V,N*=V,Z*=V,C*=V,B=Math.sin($),F=Math.cos($),M=1-F,Y=K[0],H=K[1],W=K[2],E=K[3],X=K[4],P=K[5],D=K[6],T=K[7],R=K[8],k=K[9],A=K[10],O=K[11],I=N*N*M+F,G=Z*N*M+C*B,L=C*N*M-Z*B,q=N*Z*M-C*B,w=Z*Z*M+F,p=C*Z*M+N*B,v=N*C*M+Z*B,_=Z*C*M-N*B,n=C*C*M+F,Q[0]=Y*I+X*G+R*L,Q[1]=H*I+P*G+k*L,Q[2]=W*I+D*G+A*L,Q[3]=E*I+T*G+O*L,Q[4]=Y*q+X*w+R*p,Q[5]=H*q+P*w+k*p,Q[6]=W*q+D*w+A*p,Q[7]=E*q+T*w+O*p,Q[8]=Y*v+X*_+R*n,Q[9]=H*v+P*_+k*n,Q[10]=W*v+D*_+A*n,Q[11]=E*v+T*_+O*n,K!==Q)Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q}function UQ(Q,K,$){var J=Math.sin($),N=Math.cos($),Z=K[4],C=K[5],V=K[6],B=K[7],F=K[8],M=K[9],Y=K[10],H=K[11];if(K!==Q)Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[4]=Z*N+F*J,Q[5]=C*N+M*J,Q[6]=V*N+Y*J,Q[7]=B*N+H*J,Q[8]=F*N-Z*J,Q[9]=M*N-C*J,Q[10]=Y*N-V*J,Q[11]=H*N-B*J,Q}function AQ(Q,K,$){var J=Math.sin($),N=Math.cos($),Z=K[0],C=K[1],V=K[2],B=K[3],F=K[8],M=K[9],Y=K[10],H=K[11];if(K!==Q)Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=Z*N-F*J,Q[1]=C*N-M*J,Q[2]=V*N-Y*J,Q[3]=B*N-H*J,Q[8]=Z*J+F*N,Q[9]=C*J+M*N,Q[10]=V*J+Y*N,Q[11]=B*J+H*N,Q}function OQ(Q,K,$){var J=Math.sin($),N=Math.cos($),Z=K[0],C=K[1],V=K[2],B=K[3],F=K[4],M=K[5],Y=K[6],H=K[7];if(K!==Q)Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15];return Q[0]=Z*N+F*J,Q[1]=C*N+M*J,Q[2]=V*N+Y*J,Q[3]=B*N+H*J,Q[4]=F*N-Z*J,Q[5]=M*N-C*J,Q[6]=Y*N-V*J,Q[7]=H*N-B*J,Q}function kQ(Q,K){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=K[0],Q[13]=K[1],Q[14]=K[2],Q[15]=1,Q}function RQ(Q,K){return Q[0]=K[0],Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=K[1],Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=K[2],Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function jQ(Q,K,$){var J=$[0],N=$[1],Z=$[2],C=Math.hypot(J,N,Z),V,B,F;if(C<h)return null;return C=1/C,J*=C,N*=C,Z*=C,V=Math.sin(K),B=Math.cos(K),F=1-B,Q[0]=J*J*F+B,Q[1]=N*J*F+Z*V,Q[2]=Z*J*F-N*V,Q[3]=0,Q[4]=J*N*F-Z*V,Q[5]=N*N*F+B,Q[6]=Z*N*F+J*V,Q[7]=0,Q[8]=J*Z*F+N*V,Q[9]=N*Z*F-J*V,Q[10]=Z*Z*F+B,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function hQ(Q,K){var $=Math.sin(K),J=Math.cos(K);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=J,Q[6]=$,Q[7]=0,Q[8]=0,Q[9]=-$,Q[10]=J,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function TQ(Q,K){var $=Math.sin(K),J=Math.cos(K);return Q[0]=J,Q[1]=0,Q[2]=-$,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=$,Q[9]=0,Q[10]=J,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function _Q(Q,K){var $=Math.sin(K),J=Math.cos(K);return Q[0]=J,Q[1]=$,Q[2]=0,Q[3]=0,Q[4]=-$,Q[5]=J,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function A0(Q,K,$){var J=K[0],N=K[1],Z=K[2],C=K[3],V=J+J,B=N+N,F=Z+Z,M=J*V,Y=J*B,H=J*F,W=N*B,E=N*F,X=Z*F,P=C*V,D=C*B,T=C*F;return Q[0]=1-(W+X),Q[1]=Y+T,Q[2]=H-D,Q[3]=0,Q[4]=Y-T,Q[5]=1-(M+X),Q[6]=E+P,Q[7]=0,Q[8]=H+D,Q[9]=E-P,Q[10]=1-(M+W),Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function SQ(Q,K){var $=new S(3),J=-K[0],N=-K[1],Z=-K[2],C=K[3],V=K[4],B=K[5],F=K[6],M=K[7],Y=J*J+N*N+Z*Z+C*C;if(Y>0)$[0]=(V*C+M*J+B*Z-F*N)*2/Y,$[1]=(B*C+M*N+F*J-V*Z)*2/Y,$[2]=(F*C+M*Z+V*N-B*J)*2/Y;else $[0]=(V*C+M*J+B*Z-F*N)*2,$[1]=(B*C+M*N+F*J-V*Z)*2,$[2]=(F*C+M*Z+V*N-B*J)*2;return A0(Q,K,$),Q}function GQ(Q,K){return Q[0]=K[12],Q[1]=K[13],Q[2]=K[14],Q}function O0(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[4],C=K[5],V=K[6],B=K[8],F=K[9],M=K[10];return Q[0]=Math.hypot($,J,N),Q[1]=Math.hypot(Z,C,V),Q[2]=Math.hypot(B,F,M),Q}function LQ(Q,K){var $=new S(3);O0($,K);var J=1/$[0],N=1/$[1],Z=1/$[2],C=K[0]*J,V=K[1]*N,B=K[2]*Z,F=K[4]*J,M=K[5]*N,Y=K[6]*Z,H=K[8]*J,W=K[9]*N,E=K[10]*Z,X=C+M+E,P=0;if(X>0)P=Math.sqrt(X+1)*2,Q[3]=0.25*P,Q[0]=(Y-W)/P,Q[1]=(H-B)/P,Q[2]=(V-F)/P;else if(C>M&&C>E)P=Math.sqrt(1+C-M-E)*2,Q[3]=(Y-W)/P,Q[0]=0.25*P,Q[1]=(V+F)/P,Q[2]=(H+B)/P;else if(M>E)P=Math.sqrt(1+M-C-E)*2,Q[3]=(H-B)/P,Q[0]=(V+F)/P,Q[1]=0.25*P,Q[2]=(Y+W)/P;else P=Math.sqrt(1+E-C-M)*2,Q[3]=(V-F)/P,Q[0]=(H+B)/P,Q[1]=(Y+W)/P,Q[2]=0.25*P;return Q}function qQ(Q,K,$,J){var N=K[0],Z=K[1],C=K[2],V=K[3],B=N+N,F=Z+Z,M=C+C,Y=N*B,H=N*F,W=N*M,E=Z*F,X=Z*M,P=C*M,D=V*B,T=V*F,R=V*M,k=J[0],A=J[1],O=J[2];return Q[0]=(1-(E+P))*k,Q[1]=(H+R)*k,Q[2]=(W-T)*k,Q[3]=0,Q[4]=(H-R)*A,Q[5]=(1-(Y+P))*A,Q[6]=(X+D)*A,Q[7]=0,Q[8]=(W+T)*O,Q[9]=(X-D)*O,Q[10]=(1-(Y+E))*O,Q[11]=0,Q[12]=$[0],Q[13]=$[1],Q[14]=$[2],Q[15]=1,Q}function IQ(Q,K,$,J,N){var Z=K[0],C=K[1],V=K[2],B=K[3],F=Z+Z,M=C+C,Y=V+V,H=Z*F,W=Z*M,E=Z*Y,X=C*M,P=C*Y,D=V*Y,T=B*F,R=B*M,k=B*Y,A=J[0],O=J[1],I=J[2],G=N[0],L=N[1],q=N[2],w=(1-(X+D))*A,p=(W+k)*A,v=(E-R)*A,_=(W-k)*O,n=(1-(H+D))*O,y=(P+T)*O,l=(E+R)*I,M0=(P-T)*I,Y0=(1-(H+X))*I;return Q[0]=w,Q[1]=p,Q[2]=v,Q[3]=0,Q[4]=_,Q[5]=n,Q[6]=y,Q[7]=0,Q[8]=l,Q[9]=M0,Q[10]=Y0,Q[11]=0,Q[12]=$[0]+G-(w*G+_*L+l*q),Q[13]=$[1]+L-(p*G+n*L+M0*q),Q[14]=$[2]+q-(v*G+y*L+Y0*q),Q[15]=1,Q}function wQ(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=$+$,V=J+J,B=N+N,F=$*C,M=J*C,Y=J*V,H=N*C,W=N*V,E=N*B,X=Z*C,P=Z*V,D=Z*B;return Q[0]=1-Y-E,Q[1]=M+D,Q[2]=H-P,Q[3]=0,Q[4]=M-D,Q[5]=1-F-E,Q[6]=W+X,Q[7]=0,Q[8]=H+P,Q[9]=W-X,Q[10]=1-F-Y,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q}function pQ(Q,K,$,J,N,Z,C){var V=1/($-K),B=1/(N-J),F=1/(Z-C);return Q[0]=Z*2*V,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z*2*B,Q[6]=0,Q[7]=0,Q[8]=($+K)*V,Q[9]=(N+J)*B,Q[10]=(C+Z)*F,Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=C*Z*2*F,Q[15]=0,Q}function k0(Q,K,$,J,N){var Z=1/Math.tan(K/2),C;if(Q[0]=Z/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,N!=null&&N!==Infinity)C=1/(J-N),Q[10]=(N+J)*C,Q[14]=2*N*J*C;else Q[10]=-1,Q[14]=-2*J;return Q}function gQ(Q,K,$,J,N){var Z=1/Math.tan(K/2),C;if(Q[0]=Z/$,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=Z,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[11]=-1,Q[12]=0,Q[13]=0,Q[15]=0,N!=null&&N!==Infinity)C=1/(J-N),Q[10]=N*C,Q[14]=N*J*C;else Q[10]=-1,Q[14]=-J;return Q}function nQ(Q,K,$,J){var N=Math.tan(K.upDegrees*Math.PI/180),Z=Math.tan(K.downDegrees*Math.PI/180),C=Math.tan(K.leftDegrees*Math.PI/180),V=Math.tan(K.rightDegrees*Math.PI/180),B=2/(C+V),F=2/(N+Z);return Q[0]=B,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=F,Q[6]=0,Q[7]=0,Q[8]=-((C-V)*B*0.5),Q[9]=(N-Z)*F*0.5,Q[10]=J/($-J),Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=J*$/($-J),Q[15]=0,Q}function R0(Q,K,$,J,N,Z,C){var V=1/(K-$),B=1/(J-N),F=1/(Z-C);return Q[0]=-2*V,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*B,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=2*F,Q[11]=0,Q[12]=(K+$)*V,Q[13]=(N+J)*B,Q[14]=(C+Z)*F,Q[15]=1,Q}function zQ(Q,K,$,J,N,Z,C){var V=1/(K-$),B=1/(J-N),F=1/(Z-C);return Q[0]=-2*V,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*B,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=F,Q[11]=0,Q[12]=(K+$)*V,Q[13]=(N+J)*B,Q[14]=Z*F,Q[15]=1,Q}function dQ(Q,K,$,J){var N,Z,C,V,B,F,M,Y,H,W,E=K[0],X=K[1],P=K[2],D=J[0],T=J[1],R=J[2],k=$[0],A=$[1],O=$[2];if(Math.abs(E-k)<h&&Math.abs(X-A)<h&&Math.abs(P-O)<h)return D0(Q);if(M=E-k,Y=X-A,H=P-O,W=1/Math.hypot(M,Y,H),M*=W,Y*=W,H*=W,N=T*H-R*Y,Z=R*M-D*H,C=D*Y-T*M,W=Math.hypot(N,Z,C),!W)N=0,Z=0,C=0;else W=1/W,N*=W,Z*=W,C*=W;if(V=Y*C-H*Z,B=H*N-M*C,F=M*Z-Y*N,W=Math.hypot(V,B,F),!W)V=0,B=0,F=0;else W=1/W,V*=W,B*=W,F*=W;return Q[0]=N,Q[1]=V,Q[2]=M,Q[3]=0,Q[4]=Z,Q[5]=B,Q[6]=Y,Q[7]=0,Q[8]=C,Q[9]=F,Q[10]=H,Q[11]=0,Q[12]=-(N*E+Z*X+C*P),Q[13]=-(V*E+B*X+F*P),Q[14]=-(M*E+Y*X+H*P),Q[15]=1,Q}function yQ(Q,K,$,J){var N=K[0],Z=K[1],C=K[2],V=J[0],B=J[1],F=J[2],M=N-$[0],Y=Z-$[1],H=C-$[2],W=M*M+Y*Y+H*H;if(W>0)W=1/Math.sqrt(W),M*=W,Y*=W,H*=W;var E=B*H-F*Y,X=F*M-V*H,P=V*Y-B*M;if(W=E*E+X*X+P*P,W>0)W=1/Math.sqrt(W),E*=W,X*=W,P*=W;return Q[0]=E,Q[1]=X,Q[2]=P,Q[3]=0,Q[4]=Y*P-H*X,Q[5]=H*E-M*P,Q[6]=M*X-Y*E,Q[7]=0,Q[8]=M,Q[9]=Y,Q[10]=H,Q[11]=0,Q[12]=N,Q[13]=Z,Q[14]=C,Q[15]=1,Q}function lQ(Q){return"mat4("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+", "+Q[4]+", "+Q[5]+", "+Q[6]+", "+Q[7]+", "+Q[8]+", "+Q[9]+", "+Q[10]+", "+Q[11]+", "+Q[12]+", "+Q[13]+", "+Q[14]+", "+Q[15]+")"}function iQ(Q){return Math.hypot(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7],Q[8],Q[9],Q[10],Q[11],Q[12],Q[13],Q[14],Q[15])}function xQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q[4]=K[4]+$[4],Q[5]=K[5]+$[5],Q[6]=K[6]+$[6],Q[7]=K[7]+$[7],Q[8]=K[8]+$[8],Q[9]=K[9]+$[9],Q[10]=K[10]+$[10],Q[11]=K[11]+$[11],Q[12]=K[12]+$[12],Q[13]=K[13]+$[13],Q[14]=K[14]+$[14],Q[15]=K[15]+$[15],Q}function j0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q[3]=K[3]-$[3],Q[4]=K[4]-$[4],Q[5]=K[5]-$[5],Q[6]=K[6]-$[6],Q[7]=K[7]-$[7],Q[8]=K[8]-$[8],Q[9]=K[9]-$[9],Q[10]=K[10]-$[10],Q[11]=K[11]-$[11],Q[12]=K[12]-$[12],Q[13]=K[13]-$[13],Q[14]=K[14]-$[14],Q[15]=K[15]-$[15],Q}function cQ(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q[4]=K[4]*$,Q[5]=K[5]*$,Q[6]=K[6]*$,Q[7]=K[7]*$,Q[8]=K[8]*$,Q[9]=K[9]*$,Q[10]=K[10]*$,Q[11]=K[11]*$,Q[12]=K[12]*$,Q[13]=K[13]*$,Q[14]=K[14]*$,Q[15]=K[15]*$,Q}function mQ(Q,K,$,J){return Q[0]=K[0]+$[0]*J,Q[1]=K[1]+$[1]*J,Q[2]=K[2]+$[2]*J,Q[3]=K[3]+$[3]*J,Q[4]=K[4]+$[4]*J,Q[5]=K[5]+$[5]*J,Q[6]=K[6]+$[6]*J,Q[7]=K[7]+$[7]*J,Q[8]=K[8]+$[8]*J,Q[9]=K[9]+$[9]*J,Q[10]=K[10]+$[10]*J,Q[11]=K[11]+$[11]*J,Q[12]=K[12]+$[12]*J,Q[13]=K[13]+$[13]*J,Q[14]=K[14]+$[14]*J,Q[15]=K[15]+$[15]*J,Q}function sQ(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]&&Q[4]===K[4]&&Q[5]===K[5]&&Q[6]===K[6]&&Q[7]===K[7]&&Q[8]===K[8]&&Q[9]===K[9]&&Q[10]===K[10]&&Q[11]===K[11]&&Q[12]===K[12]&&Q[13]===K[13]&&Q[14]===K[14]&&Q[15]===K[15]}function rQ(Q,K){var $=Q[0],J=Q[1],N=Q[2],Z=Q[3],C=Q[4],V=Q[5],B=Q[6],F=Q[7],M=Q[8],Y=Q[9],H=Q[10],W=Q[11],E=Q[12],X=Q[13],P=Q[14],D=Q[15],T=K[0],R=K[1],k=K[2],A=K[3],O=K[4],I=K[5],G=K[6],L=K[7],q=K[8],w=K[9],p=K[10],v=K[11],_=K[12],n=K[13],y=K[14],l=K[15];return Math.abs($-T)<=h*Math.max(1,Math.abs($),Math.abs(T))&&Math.abs(J-R)<=h*Math.max(1,Math.abs(J),Math.abs(R))&&Math.abs(N-k)<=h*Math.max(1,Math.abs(N),Math.abs(k))&&Math.abs(Z-A)<=h*Math.max(1,Math.abs(Z),Math.abs(A))&&Math.abs(C-O)<=h*Math.max(1,Math.abs(C),Math.abs(O))&&Math.abs(V-I)<=h*Math.max(1,Math.abs(V),Math.abs(I))&&Math.abs(B-G)<=h*Math.max(1,Math.abs(B),Math.abs(G))&&Math.abs(F-L)<=h*Math.max(1,Math.abs(F),Math.abs(L))&&Math.abs(M-q)<=h*Math.max(1,Math.abs(M),Math.abs(q))&&Math.abs(Y-w)<=h*Math.max(1,Math.abs(Y),Math.abs(w))&&Math.abs(H-p)<=h*Math.max(1,Math.abs(H),Math.abs(p))&&Math.abs(W-v)<=h*Math.max(1,Math.abs(W),Math.abs(v))&&Math.abs(E-_)<=h*Math.max(1,Math.abs(E),Math.abs(_))&&Math.abs(X-n)<=h*Math.max(1,Math.abs(X),Math.abs(n))&&Math.abs(P-y)<=h*Math.max(1,Math.abs(P),Math.abs(y))&&Math.abs(D-l)<=h*Math.max(1,Math.abs(D),Math.abs(l))}var vQ=k0,fQ=R0,eQ=U0,bQ=j0;var c={};u(c,{str:()=>{{return mK}},squaredLength:()=>{{return t0}},sqrLen:()=>{{return Q$}},sqlerp:()=>{{return N$}},slerp:()=>{{return b}},setAxisAngle:()=>{{return c0}},setAxes:()=>{{return Z$}},set:()=>{{return bK}},scale:()=>{{return b0}},rotationTo:()=>{{return J$}},rotateZ:()=>{{return zK}},rotateY:()=>{{return fK}},rotateX:()=>{{return nK}},random:()=>{{return lK}},pow:()=>{{return yK}},normalize:()=>{{return C0}},multiply:()=>{{return m0}},mul:()=>{{return oK}},ln:()=>{{return r0}},lerp:()=>{{return tK}},length:()=>{{return o0}},len:()=>{{return aK}},invert:()=>{{return iK}},identity:()=>{{return pK}},getAxisAngle:()=>{{return vK}},getAngle:()=>{{return gK}},fromValues:()=>{{return rK}},fromMat3:()=>{{return e0}},fromEuler:()=>{{return cK}},exp:()=>{{return s0}},exactEquals:()=>{{return K$}},equals:()=>{{return $$}},dot:()=>{{return u0}},create:()=>{{return Z0}},copy:()=>{{return eK}},conjugate:()=>{{return xK}},clone:()=>{{return sK}},calculateW:()=>{{return dK}},add:()=>{{return uK}}});var d={};u(d,{zero:()=>{{return OK}},transformQuat:()=>{{return XK}},transformMat4:()=>{{return WK}},transformMat3:()=>{{return HK}},subtract:()=>{{return T0}},sub:()=>{{return hK}},str:()=>{{return kK}},squaredLength:()=>{{return q0}},squaredDistance:()=>{{return L0}},sqrLen:()=>{{return LK}},sqrDist:()=>{{return GK}},set:()=>{{return tQ}},scaleAndAdd:()=>{{return CK}},scale:()=>{{return ZK}},round:()=>{{return NK}},rotateZ:()=>{{return UK}},rotateY:()=>{{return DK}},rotateX:()=>{{return EK}},random:()=>{{return PK}},normalize:()=>{{return J0}},negate:()=>{{return VK}},multiply:()=>{{return _0}},mul:()=>{{return TK}},min:()=>{{return $K}},max:()=>{{return JK}},lerp:()=>{{return FK}},length:()=>{{return h0}},len:()=>{{return N0}},inverse:()=>{{return BK}},hermite:()=>{{return MK}},fromValues:()=>{{return r}},forEach:()=>{{return qK}},floor:()=>{{return KK}},exactEquals:()=>{{return RK}},equals:()=>{{return jK}},dot:()=>{{return e}},divide:()=>{{return S0}},div:()=>{{return _K}},distance:()=>{{return G0}},dist:()=>{{return SK}},cross:()=>{{return x}},create:()=>{{return s}},copy:()=>{{return oQ}},clone:()=>{{return uQ}},ceil:()=>{{return QK}},bezier:()=>{{return YK}},angle:()=>{{return AK}},add:()=>{{return aQ}}});function s(){var Q=new S(3);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q}function uQ(Q){var K=new S(3);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K}function h0(Q){var K=Q[0],$=Q[1],J=Q[2];return Math.hypot(K,$,J)}function r(Q,K,$){var J=new S(3);return J[0]=Q,J[1]=K,J[2]=$,J}function oQ(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q}function tQ(Q,K,$,J){return Q[0]=K,Q[1]=$,Q[2]=J,Q}function aQ(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q}function T0(Q,K,$){return Q[0]=K[0]-$[0],Q[1]=K[1]-$[1],Q[2]=K[2]-$[2],Q}function _0(Q,K,$){return Q[0]=K[0]*$[0],Q[1]=K[1]*$[1],Q[2]=K[2]*$[2],Q}function S0(Q,K,$){return Q[0]=K[0]/$[0],Q[1]=K[1]/$[1],Q[2]=K[2]/$[2],Q}function QK(Q,K){return Q[0]=Math.ceil(K[0]),Q[1]=Math.ceil(K[1]),Q[2]=Math.ceil(K[2]),Q}function KK(Q,K){return Q[0]=Math.floor(K[0]),Q[1]=Math.floor(K[1]),Q[2]=Math.floor(K[2]),Q}function $K(Q,K,$){return Q[0]=Math.min(K[0],$[0]),Q[1]=Math.min(K[1],$[1]),Q[2]=Math.min(K[2],$[2]),Q}function JK(Q,K,$){return Q[0]=Math.max(K[0],$[0]),Q[1]=Math.max(K[1],$[1]),Q[2]=Math.max(K[2],$[2]),Q}function NK(Q,K){return Q[0]=Math.round(K[0]),Q[1]=Math.round(K[1]),Q[2]=Math.round(K[2]),Q}function ZK(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q}function CK(Q,K,$,J){return Q[0]=K[0]+$[0]*J,Q[1]=K[1]+$[1]*J,Q[2]=K[2]+$[2]*J,Q}function G0(Q,K){var $=K[0]-Q[0],J=K[1]-Q[1],N=K[2]-Q[2];return Math.hypot($,J,N)}function L0(Q,K){var $=K[0]-Q[0],J=K[1]-Q[1],N=K[2]-Q[2];return $*$+J*J+N*N}function q0(Q){var K=Q[0],$=Q[1],J=Q[2];return K*K+$*$+J*J}function VK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q}function BK(Q,K){return Q[0]=1/K[0],Q[1]=1/K[1],Q[2]=1/K[2],Q}function J0(Q,K){var $=K[0],J=K[1],N=K[2],Z=$*$+J*J+N*N;if(Z>0)Z=1/Math.sqrt(Z);return Q[0]=K[0]*Z,Q[1]=K[1]*Z,Q[2]=K[2]*Z,Q}function e(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]}function x(Q,K,$){var J=K[0],N=K[1],Z=K[2],C=$[0],V=$[1],B=$[2];return Q[0]=N*B-Z*V,Q[1]=Z*C-J*B,Q[2]=J*V-N*C,Q}function FK(Q,K,$,J){var N=K[0],Z=K[1],C=K[2];return Q[0]=N+J*($[0]-N),Q[1]=Z+J*($[1]-Z),Q[2]=C+J*($[2]-C),Q}function MK(Q,K,$,J,N,Z){var C=Z*Z,V=C*(2*Z-3)+1,B=C*(Z-2)+Z,F=C*(Z-1),M=C*(3-2*Z);return Q[0]=K[0]*V+$[0]*B+J[0]*F+N[0]*M,Q[1]=K[1]*V+$[1]*B+J[1]*F+N[1]*M,Q[2]=K[2]*V+$[2]*B+J[2]*F+N[2]*M,Q}function YK(Q,K,$,J,N,Z){var C=1-Z,V=C*C,B=Z*Z,F=V*C,M=3*Z*V,Y=3*B*C,H=B*Z;return Q[0]=K[0]*F+$[0]*M+J[0]*Y+N[0]*H,Q[1]=K[1]*F+$[1]*M+J[1]*Y+N[1]*H,Q[2]=K[2]*F+$[2]*M+J[2]*Y+N[2]*H,Q}function PK(Q,K){K=K||1;var $=z()*2*Math.PI,J=z()*2-1,N=Math.sqrt(1-J*J)*K;return Q[0]=Math.cos($)*N,Q[1]=Math.sin($)*N,Q[2]=J*K,Q}function WK(Q,K,$){var J=K[0],N=K[1],Z=K[2],C=$[3]*J+$[7]*N+$[11]*Z+$[15];return C=C||1,Q[0]=($[0]*J+$[4]*N+$[8]*Z+$[12])/C,Q[1]=($[1]*J+$[5]*N+$[9]*Z+$[13])/C,Q[2]=($[2]*J+$[6]*N+$[10]*Z+$[14])/C,Q}function HK(Q,K,$){var J=K[0],N=K[1],Z=K[2];return Q[0]=J*$[0]+N*$[3]+Z*$[6],Q[1]=J*$[1]+N*$[4]+Z*$[7],Q[2]=J*$[2]+N*$[5]+Z*$[8],Q}function XK(Q,K,$){var J=$[0],N=$[1],Z=$[2],C=$[3],V=K[0],B=K[1],F=K[2],M=N*F-Z*B,Y=Z*V-J*F,H=J*B-N*V,W=N*H-Z*Y,E=Z*M-J*H,X=J*Y-N*M,P=C*2;return M*=P,Y*=P,H*=P,W*=2,E*=2,X*=2,Q[0]=V+M+W,Q[1]=B+Y+E,Q[2]=F+H+X,Q}function EK(Q,K,$,J){var N=[],Z=[];return N[0]=K[0]-$[0],N[1]=K[1]-$[1],N[2]=K[2]-$[2],Z[0]=N[0],Z[1]=N[1]*Math.cos(J)-N[2]*Math.sin(J),Z[2]=N[1]*Math.sin(J)+N[2]*Math.cos(J),Q[0]=Z[0]+$[0],Q[1]=Z[1]+$[1],Q[2]=Z[2]+$[2],Q}function DK(Q,K,$,J){var N=[],Z=[];return N[0]=K[0]-$[0],N[1]=K[1]-$[1],N[2]=K[2]-$[2],Z[0]=N[2]*Math.sin(J)+N[0]*Math.cos(J),Z[1]=N[1],Z[2]=N[2]*Math.cos(J)-N[0]*Math.sin(J),Q[0]=Z[0]+$[0],Q[1]=Z[1]+$[1],Q[2]=Z[2]+$[2],Q}function UK(Q,K,$,J){var N=[],Z=[];return N[0]=K[0]-$[0],N[1]=K[1]-$[1],N[2]=K[2]-$[2],Z[0]=N[0]*Math.cos(J)-N[1]*Math.sin(J),Z[1]=N[0]*Math.sin(J)+N[1]*Math.cos(J),Z[2]=N[2],Q[0]=Z[0]+$[0],Q[1]=Z[1]+$[1],Q[2]=Z[2]+$[2],Q}function AK(Q,K){var $=Q[0],J=Q[1],N=Q[2],Z=K[0],C=K[1],V=K[2],B=Math.sqrt($*$+J*J+N*N),F=Math.sqrt(Z*Z+C*C+V*V),M=B*F,Y=M&&e(Q,K)/M;return Math.acos(Math.min(Math.max(Y,-1),1))}function OK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q}function kK(Q){return"vec3("+Q[0]+", "+Q[1]+", "+Q[2]+")"}function RK(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]}function jK(Q,K){var $=Q[0],J=Q[1],N=Q[2],Z=K[0],C=K[1],V=K[2];return Math.abs($-Z)<=h*Math.max(1,Math.abs($),Math.abs(Z))&&Math.abs(J-C)<=h*Math.max(1,Math.abs(J),Math.abs(C))&&Math.abs(N-V)<=h*Math.max(1,Math.abs(N),Math.abs(V))}var hK=T0,TK=_0,_K=S0,SK=G0,GK=L0,N0=h0,LK=q0,qK=function(){var Q=s();return function(K,$,J,N,Z,C){var V,B;if(!$)$=3;if(!J)J=0;if(N)B=Math.min(N*$+J,K.length);else B=K.length;for(V=J;V<B;V+=$)Q[0]=K[V],Q[1]=K[V+1],Q[2]=K[V+2],Z(Q,Q,C),K[V]=Q[0],K[V+1]=Q[1],K[V+2]=Q[2];return K}}();function IK(){var Q=new S(4);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=0;return Q}function I0(Q){var K=new S(4);return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K}function w0(Q,K,$,J){var N=new S(4);return N[0]=Q,N[1]=K,N[2]=$,N[3]=J,N}function p0(Q,K){return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q}function v0(Q,K,$,J,N){return Q[0]=K,Q[1]=$,Q[2]=J,Q[3]=N,Q}function g0(Q,K,$){return Q[0]=K[0]+$[0],Q[1]=K[1]+$[1],Q[2]=K[2]+$[2],Q[3]=K[3]+$[3],Q}function n0(Q,K,$){return Q[0]=K[0]*$,Q[1]=K[1]*$,Q[2]=K[2]*$,Q[3]=K[3]*$,Q}function f0(Q){var K=Q[0],$=Q[1],J=Q[2],N=Q[3];return Math.hypot(K,$,J,N)}function z0(Q){var K=Q[0],$=Q[1],J=Q[2],N=Q[3];return K*K+$*$+J*J+N*N}function d0(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=$*$+J*J+N*N+Z*Z;if(C>0)C=1/Math.sqrt(C);return Q[0]=$*C,Q[1]=J*C,Q[2]=N*C,Q[3]=Z*C,Q}function y0(Q,K){return Q[0]*K[0]+Q[1]*K[1]+Q[2]*K[2]+Q[3]*K[3]}function l0(Q,K,$,J){var N=K[0],Z=K[1],C=K[2],V=K[3];return Q[0]=N+J*($[0]-N),Q[1]=Z+J*($[1]-Z),Q[2]=C+J*($[2]-C),Q[3]=V+J*($[3]-V),Q}function i0(Q,K){return Q[0]===K[0]&&Q[1]===K[1]&&Q[2]===K[2]&&Q[3]===K[3]}function x0(Q,K){var $=Q[0],J=Q[1],N=Q[2],Z=Q[3],C=K[0],V=K[1],B=K[2],F=K[3];return Math.abs($-C)<=h*Math.max(1,Math.abs($),Math.abs(C))&&Math.abs(J-V)<=h*Math.max(1,Math.abs(J),Math.abs(V))&&Math.abs(N-B)<=h*Math.max(1,Math.abs(N),Math.abs(B))&&Math.abs(Z-F)<=h*Math.max(1,Math.abs(Z),Math.abs(F))}var _$=function(){var Q=IK();return function(K,$,J,N,Z,C){var V,B;if(!$)$=4;if(!J)J=0;if(N)B=Math.min(N*$+J,K.length);else B=K.length;for(V=J;V<B;V+=$)Q[0]=K[V],Q[1]=K[V+1],Q[2]=K[V+2],Q[3]=K[V+3],Z(Q,Q,C),K[V]=Q[0],K[V+1]=Q[1],K[V+2]=Q[2],K[V+3]=Q[3];return K}}();function Z0(){var Q=new S(4);if(S!=Float32Array)Q[0]=0,Q[1]=0,Q[2]=0;return Q[3]=1,Q}function pK(Q){return Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=1,Q}function c0(Q,K,$){$=$*0.5;var J=Math.sin($);return Q[0]=J*K[0],Q[1]=J*K[1],Q[2]=J*K[2],Q[3]=Math.cos($),Q}function vK(Q,K){var $=Math.acos(K[3])*2,J=Math.sin($/2);if(J>h)Q[0]=K[0]/J,Q[1]=K[1]/J,Q[2]=K[2]/J;else Q[0]=1,Q[1]=0,Q[2]=0;return $}function gK(Q,K){var $=u0(Q,K);return Math.acos(2*$*$-1)}function m0(Q,K,$){var J=K[0],N=K[1],Z=K[2],C=K[3],V=$[0],B=$[1],F=$[2],M=$[3];return Q[0]=J*M+C*V+N*F-Z*B,Q[1]=N*M+C*B+Z*V-J*F,Q[2]=Z*M+C*F+J*B-N*V,Q[3]=C*M-J*V-N*B-Z*F,Q}function nK(Q,K,$){$*=0.5;var J=K[0],N=K[1],Z=K[2],C=K[3],V=Math.sin($),B=Math.cos($);return Q[0]=J*B+C*V,Q[1]=N*B+Z*V,Q[2]=Z*B-N*V,Q[3]=C*B-J*V,Q}function fK(Q,K,$){$*=0.5;var J=K[0],N=K[1],Z=K[2],C=K[3],V=Math.sin($),B=Math.cos($);return Q[0]=J*B-Z*V,Q[1]=N*B+C*V,Q[2]=Z*B+J*V,Q[3]=C*B-N*V,Q}function zK(Q,K,$){$*=0.5;var J=K[0],N=K[1],Z=K[2],C=K[3],V=Math.sin($),B=Math.cos($);return Q[0]=J*B+N*V,Q[1]=N*B-J*V,Q[2]=Z*B+C*V,Q[3]=C*B-Z*V,Q}function dK(Q,K){var $=K[0],J=K[1],N=K[2];return Q[0]=$,Q[1]=J,Q[2]=N,Q[3]=Math.sqrt(Math.abs(1-$*$-J*J-N*N)),Q}function s0(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=Math.sqrt($*$+J*J+N*N),V=Math.exp(Z),B=C>0?V*Math.sin(C)/C:0;return Q[0]=$*B,Q[1]=J*B,Q[2]=N*B,Q[3]=V*Math.cos(C),Q}function r0(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=Math.sqrt($*$+J*J+N*N),V=C>0?Math.atan2(C,Z)/C:0;return Q[0]=$*V,Q[1]=J*V,Q[2]=N*V,Q[3]=0.5*Math.log($*$+J*J+N*N+Z*Z),Q}function yK(Q,K,$){return r0(Q,K),b0(Q,Q,$),s0(Q,Q),Q}function b(Q,K,$,J){var N=K[0],Z=K[1],C=K[2],V=K[3],B=$[0],F=$[1],M=$[2],Y=$[3],H,W,E,X,P;if(W=N*B+Z*F+C*M+V*Y,W<0)W=-W,B=-B,F=-F,M=-M,Y=-Y;if(1-W>h)H=Math.acos(W),E=Math.sin(H),X=Math.sin((1-J)*H)/E,P=Math.sin(J*H)/E;else X=1-J,P=J;return Q[0]=X*N+P*B,Q[1]=X*Z+P*F,Q[2]=X*C+P*M,Q[3]=X*V+P*Y,Q}function lK(Q){var K=z(),$=z(),J=z(),N=Math.sqrt(1-K),Z=Math.sqrt(K);return Q[0]=N*Math.sin(2*Math.PI*$),Q[1]=N*Math.cos(2*Math.PI*$),Q[2]=Z*Math.sin(2*Math.PI*J),Q[3]=Z*Math.cos(2*Math.PI*J),Q}function iK(Q,K){var $=K[0],J=K[1],N=K[2],Z=K[3],C=$*$+J*J+N*N+Z*Z,V=C?1/C:0;return Q[0]=-$*V,Q[1]=-J*V,Q[2]=-N*V,Q[3]=Z*V,Q}function xK(Q,K){return Q[0]=-K[0],Q[1]=-K[1],Q[2]=-K[2],Q[3]=K[3],Q}function e0(Q,K){var $=K[0]+K[4]+K[8],J;if($>0)J=Math.sqrt($+1),Q[3]=0.5*J,J=0.5/J,Q[0]=(K[5]-K[7])*J,Q[1]=(K[6]-K[2])*J,Q[2]=(K[1]-K[3])*J;else{var N=0;if(K[4]>K[0])N=1;if(K[8]>K[N*3+N])N=2;var Z=(N+1)%3,C=(N+2)%3;J=Math.sqrt(K[N*3+N]-K[Z*3+Z]-K[C*3+C]+1),Q[N]=0.5*J,J=0.5/J,Q[3]=(K[Z*3+C]-K[C*3+Z])*J,Q[Z]=(K[Z*3+N]+K[N*3+Z])*J,Q[C]=(K[C*3+N]+K[N*3+C])*J}return Q}function cK(Q,K,$,J){var N=0.5*Math.PI/180;K*=N,$*=N,J*=N;var Z=Math.sin(K),C=Math.cos(K),V=Math.sin($),B=Math.cos($),F=Math.sin(J),M=Math.cos(J);return Q[0]=Z*B*M-C*V*F,Q[1]=C*V*M+Z*B*F,Q[2]=C*B*F-Z*V*M,Q[3]=C*B*M+Z*V*F,Q}function mK(Q){return"quat("+Q[0]+", "+Q[1]+", "+Q[2]+", "+Q[3]+")"}var sK=I0,rK=w0,eK=p0,bK=v0,uK=g0,oK=m0,b0=n0,u0=y0,tK=l0,o0=f0,aK=o0,t0=z0,Q$=t0,C0=d0,K$=i0,$$=x0,J$=function(){var Q=s(),K=r(1,0,0),$=r(0,1,0);return function(J,N,Z){var C=e(N,Z);if(C<-0.999999){if(x(Q,K,N),N0(Q)<0.000001)x(Q,$,N);return J0(Q,Q),c0(J,Q,Math.PI),J}else if(C>0.999999)return J[0]=0,J[1]=0,J[2]=0,J[3]=1,J;else return x(Q,N,Z),J[0]=Q[0],J[1]=Q[1],J[2]=Q[2],J[3]=1+C,C0(J,J)}}(),N$=function(){var Q=Z0(),K=Z0();return function($,J,N,Z,C,V){return b(Q,J,C,V),b(K,N,Z,V),b($,Q,K,2*V*(1-V)),$}}(),Z$=function(){var Q=E0();return function(K,$,J,N){return Q[0]=J[0],Q[3]=J[1],Q[6]=J[2],Q[1]=N[0],Q[4]=N[1],Q[7]=N[2],Q[2]=-$[0],Q[5]=-$[1],Q[8]=-$[2],C0(K,e0(K,Q))}}();class f extends g{texImgSrc;activated=!1;width;height;constructor(Q){super();this.texImgSrc=Q,this.width=Q instanceof HTMLImageElement?Q.naturalWidth:Q instanceof VideoFrame?Q.displayWidth:Q.width,this.height=Q instanceof HTMLImageElement?Q.naturalHeight:Q instanceof VideoFrame?Q.displayHeight:Q.width}static async loadImage(Q){return new Promise((K,$)=>{const J=new Image,N=new f(J),Z=()=>K(N),C=(V)=>$(V.error);J.addEventListener("error",C),J.addEventListener("load",Z,{once:!0}),N.addOnDestroy(()=>J.removeEventListener("load",Z)),J.src=Q})}static async loadVideo(Q,K){return new Promise(($,J)=>{const N=document.createElement("video"),Z=new f(N);if(N.loop=!0,K!==void 0)N.volume=K;const C=()=>N.play(),V=()=>$(Z);N.addEventListener("loadedmetadata",C),N.addEventListener("playing",V,{once:!0}),N.addEventListener("error",(B)=>J(B.error)),N.src=Q,Z.addOnDestroy(()=>{N.pause(),N.removeEventListener("playing",V),N.removeEventListener("loadmetadata",C)})})}static async loadWebcam(Q){return new Promise((K,$)=>{const J=document.createElement("video"),N=new f(J);J.loop=!0;const Z=()=>J.play(),C=()=>K(N);J.addEventListener("loadedmetadata",Z),J.addEventListener("playing",C,{once:!0}),J.addEventListener("error",(B)=>$(B.error));let V=!1;navigator.mediaDevices.getUserMedia({video:{deviceId:Q}}).then((B)=>{if(!V)J.srcObject=B,N.addOnDestroy(()=>B.getTracks().forEach((F)=>F.stop()))}),N.addOnDestroy(()=>{V=!0,J.pause(),J.removeEventListener("playing",C),J.removeEventListener("loadmetadata",Z)})})}}var a0=4096;class V0 extends g{gl;textureBuffers={};images={};tempCanvas=new OffscreenCanvas(1,1);tempContext=this.tempCanvas.getContext("2d");constructor(Q){super();this.gl=Q,this.tempContext.imageSmoothingEnabled=!0}getTexture(Q){if(!this.textureBuffers[Q]){const K=this.gl.createTexture();if(!K)return;this.gl.bindTexture(U.TEXTURE_2D,K),this.gl.texImage2D(U.TEXTURE_2D,0,U.RGBA,a0,a0,0,U.RGBA,U.UNSIGNED_BYTE,null),this.gl.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),this.textureBuffers[Q]=K,this.addOnDestroy(()=>this.gl.deleteTexture(K))}return this.textureBuffers[Q]}loadTexture(Q,K,$,J,N){this.gl.activeTexture(U[K]),this.gl.bindTexture(U.TEXTURE_2D,$),this.applyTexImage2d(Q,J,N),this.gl.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR)}applyTexImage2d(Q,[K,$,J,N],[Z,C,V,B]){if(J===V&&N===B&&!K&&!$)this.gl.texSubImage2D(U.TEXTURE_2D,0,Z,C,J,N,U.RGBA,U.UNSIGNED_BYTE,Q.texImgSrc);else{console.log("Used canvas");const F=this.tempContext.canvas;if(Q.texImgSrc instanceof ImageData){if(F.width=V||Q.width,F.height=B||Q.height,this.tempContext.putImageData(Q.texImgSrc,0,0),K||$)console.warn("Offset not available when sending imageData")}else{const M=J||Q.width,Y=N||Q.height;F.width=V||M,F.height=B||Y,this.tempContext.drawImage(Q.texImgSrc,K,$,M,Y,0,0,F.width,F.height)}this.gl.texSubImage2D(U.TEXTURE_2D,0,Z,C,F.width,F.height,U.RGBA,U.UNSIGNED_BYTE,F)}}hasImageId(Q){return!!this.images[Q]}async drawImage(Q,K){const $=new OffscreenCanvas(1,1);K($.getContext("2d"));const J=new f($);return this.images[Q]=this.own(J),J}async loadCanvas(Q,K){const $=new f(K);return K.getContext("2d"),this.images[Q]=this.own($),$}async loadImage(Q,K){const $=await f.loadImage(K);return this.images[Q]=this.own($),$}async loadVideo(Q,K,$){const J=await f.loadVideo(K,$);return this.images[Q]=this.own(J),J}async loadWebCam(Q,K){const $=await f.loadWebcam(K);return this.images[Q]=this.own($),$}assignImageToTexture(Q,K,$,J){if(!this.getTexture(K)){console.warn("Invalid texture Id");return}const N=this.images[Q];if(N){const Z=this.getTexture(K);if(Z){const C=$??[0,0,N.width,N.height],V=J??[0,0,C[2],C[3]];if(N.activated)this.gl.bindTexture(U.TEXTURE_2D,Z),this.applyTexImage2d(N,C,V);else this.loadTexture(N,K,Z,C,V),N.activated=!0}else console.warn(`Texture not found: ${K}`)}}generateMipMap(Q){const K=this.getTexture(Q);if(K)this.gl.activeTexture(U[Q]),this.gl.bindTexture(U.TEXTURE_2D,K),this.gl.generateMipmap(U.TEXTURE_2D),console.log("GENERATED MIPMAP")}}var B$=function(Q){if(!V$)return Q;return new Proxy(Q,{get($,J){const N=$,Z=N[J];if(typeof Z==="function")return(...V)=>{const B=Z.apply(N,V);return console.log(`gl.${String(J)}(`,V,") = ",B),B};else return console.log(`gl.${String(J)} = `,Z),Z}})},C$={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},m=2048,V$=!1;class B0 extends g{gl;perspectiveLevel=1;programs;attributeBuffers;uniforms;cameraMatrix;camTurnMatrix;perspectiveMatrix;orthoMatrix;projectionMatrix;canvas;textureManager;constructor(Q,K){super();this.gl=B$(Q.getContext("webgl2",{...C$,...K})),this.canvas=Q,this.textureManager=new V0(this.gl),this.programs=this.own(new t(this.gl)),this.attributeBuffers=this.own(new Q0(this.gl,this.programs)),this.uniforms=this.own(new K0(this.gl,this.programs)),this.cameraMatrix=j.translate(j.create(),j.identity(j.create()),d.fromValues(0,0,-1)),this.camTurnMatrix=j.identity(j.create()),this.perspectiveMatrix=j.identity(j.create()),this.orthoMatrix=j.identity(j.create()),this.projectionMatrix=j.identity(j.create()),window.addEventListener("resize",this.checkCanvasSize.bind(this))}checkCanvasSize(){this.canvas.width=this.canvas.offsetWidth*2,this.canvas.height=this.canvas.offsetHeight*2,this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const Q=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;this.configOrthoMatrix(Q),this.configPerspectiveMatrix(Q)}async initialize(){this.gl.enable(U.DEPTH_TEST),this.gl.depthFunc(U.LEQUAL),this.gl.enable(U.BLEND),this.gl.blendFunc(U.SRC_ALPHA,U.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);{const Q=P0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ELEMENT_ARRAY_BUFFER,K),this.attributeBuffers.bufferData(U.ELEMENT_ARRAY_BUFFER,Q,Uint16Array.from([0,1,2,2,3,0]),0,U.STATIC_DRAW)}{const Q=$0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,K),this.gl.vertexAttribPointer(K.location,3,U.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(K.location),this.attributeBuffers.bufferData(U.ARRAY_BUFFER,Q,Float32Array.from([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),0,U.STATIC_DRAW)}{const Q=W0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,K);for(let $=0;$<4;$++){const J=K.location+$;this.gl.vertexAttribPointer(J,4,U.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,$*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(J),this.gl.vertexAttribDivisor(J,1)}this.attributeBuffers.bufferData(U.ARRAY_BUFFER,Q,Float32Array.from([...j.identity(j.create()),...j.fromYRotation(j.create(),Math.PI/4),...j.fromYRotation(j.create(),Math.PI/2)]),0,U.DYNAMIC_DRAW)}{const Q=H0;this.attributeBuffers.createBuffer(Q);const K=this.attributeBuffers.getAttributeBuffer(Q);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,K),this.gl.vertexAttribPointer(K.location,2,U.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(K.location),this.attributeBuffers.bufferData(U.ARRAY_BUFFER,Q,Float32Array.from([0,1,1,1,1,0,0,0]),0,U.DYNAMIC_DRAW)}{const Q=m;await this.textureManager.drawImage("test",(K)=>{const{canvas:$}=K;$.width=Q,$.height=Q,K.imageSmoothingEnabled=!0,K.fillStyle="#ddd",K.lineWidth=$.width/50,K.fillRect(0,0,$.width,$.height),K.strokeStyle="black",K.fillStyle="gold",K.beginPath(),K.arc($.width/2,$.height/2,$.width/2*0.8,0,2*Math.PI),K.fill(),K.stroke(),K.beginPath(),K.arc($.width/2,$.height/2,$.width/2*0.5,0,Math.PI),K.stroke(),K.beginPath(),K.arc($.width/3,$.height/3,$.width/2*0.1,0,Math.PI,!0),K.stroke(),K.beginPath(),K.arc($.width/3*2,$.height/3,$.width/2*0.1,0,Math.PI,!0),K.stroke()}),this.textureManager.assignImageToTexture("test","TEXTURE0",[0,0,Q,Q],[0,0,m,m]),this.textureManager.generateMipMap("TEXTURE0")}this.checkCanvasSize(),this.refreshCamera()}configPerspectiveMatrix(Q){const K=Math.PI/90;this.perspectiveMatrix=j.perspective(j.create(),45*K,Q,0,1e4),this.setPerspective()}configOrthoMatrix(Q){this.orthoMatrix=j.ortho(j.create(),-1*Q,1*Q,-1,1,-100,100),this.setPerspective()}refreshCamera(){const Q=j.identity(j.create());j.mul(Q,this.cameraMatrix,Q),j.mul(Q,this.camTurnMatrix,Q),j.mul(Q,this.projectionMatrix,Q);const K=this.uniforms.getUniformLocation(X0);if(K)this.gl.uniformMatrix4fv(K,!1,Q)}updateTrianglePosition(Q,K){const $=this.attributeBuffers.getAttributeBuffer($0);this.attributeBuffers.bindBuffer(U.ARRAY_BUFFER,$),this.attributeBuffers.bufferSubData(U.ARRAY_BUFFER,Float32Array.from(K),Q*4*3*Float32Array.BYTES_PER_ELEMENT)}setPerspective(Q){if(Q!==void 0)this.perspectiveLevel=Q;const K=j.create();j.multiplyScalar(K,this.orthoMatrix,1-this.perspectiveLevel);const $=j.create();j.multiplyScalar($,this.perspectiveMatrix,this.perspectiveLevel),j.copy(this.projectionMatrix,K),j.add(this.projectionMatrix,this.projectionMatrix,$),this.refreshCamera()}moveCam(Q,K){const $=c.create();j.getRotation($,this.camTurnMatrix),c.invert($,$);const J=d.fromValues(-Q,0,K);d.transformQuat(J,J,$),j.translate(this.cameraMatrix,this.cameraMatrix,J),this.refreshCamera()}turnCam(Q){j.rotateY(this.camTurnMatrix,this.camTurnMatrix,Q),this.refreshCamera()}drawArrays(Q){this.gl.drawArrays(U.TRIANGLES,0,Q)}drawElementsInstanced(Q,K){this.gl.clear(U.COLOR_BUFFER_BIT|U.DEPTH_BUFFER_BIT),this.gl.drawElementsInstanced(U.TRIANGLES,Q,U.UNSIGNED_SHORT,0,K)}bindVertexArray(){return this.own(new a(this.gl))}}var QQ=`#version 300 es

precision highp float;

const float TEXTURE_SIZE = 4096.;
const float SLOT_SIZE = ~{TEXTURE_SLOT_SIZE}; //  256
const float SLOT_SIDE_COUNT = TEXTURE_SIZE / SLOT_SIZE;

//  IN
//  shape
layout (location=0) in vec4 position;
layout (location=1) in mat4 transform;
//  2, 3, 4
//  animation
layout (location=5) in vec2 tex;

//  UNIFORM
uniform mat4 cam;

//  OUT
out vec2 vTex;
out float textureIndex;
out float opacity;

void main() {
    gl_Position = cam * transform * position;
    float slotTextSize = SLOT_SIZE / TEXTURE_SIZE;
    vTex = tex * slotTextSize;
    textureIndex = 0.;
    opacity = 1.;
}
`;var KQ=`#version 300 es

precision highp float;

//  CONST
const int NUM_TEXTURES = 16;
const float threshold = 0.00001;

//  IN
//  texture
uniform sampler2D uTextures[NUM_TEXTURES];
in float textureIndex;
in vec2 vTex;
in float opacity;

//  OUT
out vec4 fragColor;

//  FUNCTIONS
vec4 getTextureColor(float textureSlot, vec2 vTexturePoint);

void main() {
    vec4 color = getTextureColor(textureIndex, vTex);
    if (color.a <= .01) {
        discard;
    };
    fragColor = vec4(color.rgb, 1.);
}

vec4 getTextureColor(float textureSlot, vec2 vTexturePoint) {
    if (abs(0.0 - textureSlot) < threshold) {
        return texture(uTextures[0], vTexturePoint);
    }
    if (abs(1.0 - textureSlot) < threshold) {
        return texture(uTextures[1], vTexturePoint);
    }
    if (abs(2.0 - textureSlot) < threshold) {
        return texture(uTextures[2], vTexturePoint);
    }
    if (abs(3.0 - textureSlot) < threshold) {
        return texture(uTextures[3], vTexturePoint);
    }
    if (abs(4.0 - textureSlot) < threshold) {
        return texture(uTextures[4], vTexturePoint);
    }
    if (abs(5.0 - textureSlot) < threshold) {
        return texture(uTextures[5], vTexturePoint);
    }
    if (abs(6.0 - textureSlot) < threshold) {
        return texture(uTextures[6], vTexturePoint);
    }
    if (abs(7.0 - textureSlot) < threshold) {
        return texture(uTextures[7], vTexturePoint);
    }
    if (abs(8.0 - textureSlot) < threshold) {
        return texture(uTextures[8], vTexturePoint);
    }
    if (abs(9.0 - textureSlot) < threshold) {
        return texture(uTextures[9], vTexturePoint);
    }
    if (abs(10.0 - textureSlot) < threshold) {
        return texture(uTextures[10], vTexturePoint);
    }
    if (abs(11.0 - textureSlot) < threshold) {
        return texture(uTextures[11], vTexturePoint);
    }
    if (abs(12.0 - textureSlot) < threshold) {
        return texture(uTextures[12], vTexturePoint);
    }
    if (abs(13.0 - textureSlot) < threshold) {
        return texture(uTextures[13], vTexturePoint);
    }
    if (abs(14.0 - textureSlot) < threshold) {
        return texture(uTextures[14], vTexturePoint);
    }
    if (abs(15.0 - textureSlot) < threshold) {
        return texture(uTextures[15], vTexturePoint);
    }
    return texture(uTextures[0], vTexturePoint);
}            
`;function F0(Q,K){return Q.replace(/~\{(\w+)\}/g,($,J)=>{return K?.[J]||$})}async function u$(){console.log("Hello World!")}function o$(Q){Q.style.border=".5px solid silver";const K=new B0(Q),$={TEXTURE_SLOT_SIZE:m.toFixed(1)};K.programs.addProgram("test",F0(QQ,$),F0(KQ,$)),K.programs.useProgram("test"),K.initialize();const J={};document.addEventListener("keydown",(Z)=>{J[Z.code]=!0}),document.addEventListener("keyup",(Z)=>{J[Z.code]=!1});function N(){if(J.KeyW||J.ArrowUp)K.moveCam(0,0.25);if(J.KeyS||J.ArrowDown)K.moveCam(0,-0.25);if(J.KeyA)K.moveCam(-0.25,0);if(J.KeyD)K.moveCam(0.25,0);if(J.KeyQ||J.ArrowLeft)K.turnCam(-0.05);if(J.KeyE||J.ArrowRight)K.turnCam(0.05);const V=6,B=1;K.drawElementsInstanced(V,B),requestAnimationFrame(N)}return N(),K}export{o$ as testCanvas,u$ as hello};

//# debugId=ABB5CA5BD7A6B56464756e2164756e21
