var NK=Object.defineProperty;var Y0=(K,Q)=>{for(var $ in Q)NK(K,$,{get:Q[$],enumerable:!0,configurable:!0,set:(J)=>Q[$]=()=>J})};class g{disposables;own(K){if(!this.disposables)this.disposables=new Set;return this.disposables.add(K),K}addOnDestroy(K){this.disposables?.add({destroy:K})}destroy(){this.disposables?.forEach((K)=>K.destroy())}}var j=globalThis.WebGL2RenderingContext!==void 0?globalThis.WebGL2RenderingContext:{},h0="position_and_tex",S0="index",B0="transform",I0="slotSize_and_number",w0="cam",p0="projection",v0="maxTextureSize",g0="uTextures";var GK=function(K,Q,$){function J(C,X){function W(D){return D===K?.VERTEX_SHADER?"vertex":D===K?.FRAGMENT_SHADER?"fragment":void 0}if(X!==K.VERTEX_SHADER&&X!==K.FRAGMENT_SHADER)throw new Error(`Shader error in ${W(X)}`);const O=K.createShader(X);if(!O)throw new Error(`Unable to generate ${W(X)} shader.`);if(K.shaderSource(O,C),K.compileShader(O),!K.getShaderParameter(O,K.COMPILE_STATUS))console.error(`Shader compile error in ${W(X)}:`+K.getShaderInfoLog(O));return O}const Z=K.createProgram();if(!Z)throw new Error("Unable to create program.");const V=J(Q,K.VERTEX_SHADER),B=J($,K.FRAGMENT_SHADER),Y=K.getShaderInfoLog(V),F=K.getShaderInfoLog(B);if(Y)console.log("VERTEX",Y);if(F)console.log("FRAGMENT",F);K.attachShader(Z,V),K.attachShader(Z,B),K.linkProgram(Z);const P=K.getProgramInfoLog(Z);if(P)console.log("PROGRAM",P);if(K.detachShader(Z,V),K.detachShader(Z,B),K.deleteShader(V),K.deleteShader(B),K.validateProgram(Z),Object.entries(j).forEach(([C,X])=>{if(X&&K.getError()===X)console.log(`gl.${C}`)}),!K.getProgramParameter(Z,K.LINK_STATUS))throw new Error("Unable to initialize the shader program:\n"+K.getProgramInfoLog(Z));return Z},kK=function(K,Q){K.deleteProgram(Q)};class F0 extends g{gl;program;constructor(K,Q,$){super();this.gl=K,this.program=GK(K,Q.trim(),$.trim())}use(){this.gl.useProgram(this.program)}destroy(){super.destroy(),kK(this.gl,this.program)}}class P0 extends g{activeProgramId="";gl;programs={};constructor(K){super();this.gl=K}addProgram(K,Q,$){if(this.programs[K])this.removeProgram(K);this.programs[K]=this.own(new F0(this.gl,Q,$))}useProgram(K){if(this.activeProgramId!==K)this.activeProgramId=K,this.programs[K].use()}removeProgram(K){this.programs[K].destroy(),delete this.programs[K]}getProgram(K){return this.programs[K??this.activeProgramId]?.program}}class C0 extends g{gl;triangleArray;constructor(K){super();this.gl=K,this.triangleArray=K.createVertexArray(),K.bindVertexArray(this.triangleArray)}destroy(){this.gl.deleteVertexArray(this.triangleArray)}}class X0 extends g{bufferRecord={};lastBoundBuffer;gl;programs;constructor(K,Q){super();this.gl=K,this.programs=Q}getAttributeLocation(K,Q){const $=this.programs.getProgram(Q);return $?this.gl.getAttribLocation($,K)??-1:-1}createBuffer(K){this.deleteBuffer(K);const Q=this.gl?.createBuffer();if(!Q)throw new Error(`Unable to create buffer "${K}"`);const $={buffer:Q,location:this.getAttributeLocation(K)};return this.bufferRecord[K]=$,$}deleteBuffer(K){if(this.bufferRecord[K])this.gl.deleteBuffer(this.bufferRecord[K].buffer),delete this.bufferRecord[K]}getAttributeBuffer(K,Q){const $=this.bufferRecord[K];if(!$){if(Q)return this.createBuffer(K);throw new Error(`Attribute "${K}" not created. Make sure "createBuffer" is called.`)}return $}bufferData(K,Q,$,J,Z){const V=this.getAttributeBuffer(Q);if($)this.gl.bufferData(K,$,Z);else this.gl.bufferData(K,J,Z);V.bufferSize=J||$?.length,V.bufferArray=$??new Float32Array(V.bufferSize/Float32Array.BYTES_PER_ELEMENT).fill(0),V.usage=Z,V.target=K}bufferSubData(K,Q,$,J,Z){if(J)this.gl.bufferSubData(K,$,Q,J,Z);else this.gl.bufferSubData(K,$,Q)}bindBuffer(K,Q){if(this.lastBoundBuffer!==Q)this.lastBoundBuffer=Q,this.gl.bindBuffer(K,Q.buffer)}destroy(){Object.keys(this.bufferRecord).forEach((K)=>this.deleteBuffer(K))}}class H0 extends g{gl;programs;constructor(K,Q){super();this.gl=K,this.programs=Q}getUniformLocation(K,Q){const $=this.programs.getProgram(Q);return this.gl.getUniformLocation($,K)}}function f0(K,Q=($)=>$.key){var $=[];return O0(K,"",!0,(J)=>$.push(J),Q),$.join("")}var O0=function(K,Q,$,J,Z){if(K){J(`${Q}${$?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 "}${Z(K)}\n`);const V=Q+($?"    ":"\u2502   ");if(K.left)O0(K.left,V,!1,J,Z);if(K.right)O0(K.right,V,!0,J,Z)}};function b(K){if(K===null)return!0;var Q=e(K.left),$=e(K.right);if(Math.abs(Q-$)<=1&&b(K.left)&&b(K.right))return!0;return!1}var e=function(K){return K?1+Math.max(e(K.left),e(K.right)):0};function u(K,Q,$,J,Z){const V=Z-J;if(V>0){const B=J+Math.floor(V/2),Y=Q[B],F=$[B],P={key:Y,data:F,parent:K};return P.left=u(P,Q,$,J,B),P.right=u(P,Q,$,B+1,Z),P}return null}function o(K){if(K===null)return 0;const Q=o(K.left),$=o(K.right);return K.balanceFactor=Q-$,Math.max(Q,$)+1}function a(K,Q,$,J,Z){if($>=J)return;const V=K[$+J>>1];let B=$-1,Y=J+1;while(!0){do B++;while(Z(K[B],V)<0);do Y--;while(Z(K[Y],V)>0);if(B>=Y)break;let F=K[B];K[B]=K[Y],K[Y]=F,F=Q[B],Q[B]=Q[Y],Q[Y]=F}a(K,Q,$,Y,Z),a(K,Q,Y+1,J,Z)}var TK=function(K,Q){return K>Q?1:K<Q?-1:0},t=function(K){var Q=K.right;if(K.right=Q.left,Q.left)Q.left.parent=K;if(Q.parent=K.parent,Q.parent)if(Q.parent.left===K)Q.parent.left=Q;else Q.parent.right=Q;if(K.parent=Q,Q.left=K,K.balanceFactor+=1,Q.balanceFactor<0)K.balanceFactor-=Q.balanceFactor;if(Q.balanceFactor+=1,K.balanceFactor>0)Q.balanceFactor+=K.balanceFactor;return Q},K0=function(K){var Q=K.left;if(K.left=Q.right,K.left)K.left.parent=K;if(Q.parent=K.parent,Q.parent)if(Q.parent.left===K)Q.parent.left=Q;else Q.parent.right=Q;if(K.parent=Q,Q.right=K,K.balanceFactor-=1,Q.balanceFactor>0)K.balanceFactor-=Q.balanceFactor;if(Q.balanceFactor-=1,K.balanceFactor<0)Q.balanceFactor+=K.balanceFactor;return Q};class c{constructor(K,Q=!1){this._comparator=K||TK,this._root=null,this._size=0,this._noDuplicates=!!Q}destroy(){return this.clear()}clear(){return this._root=null,this._size=0,this}get size(){return this._size}contains(K){if(this._root){var Q=this._root,$=this._comparator;while(Q){var J=$(K,Q.key);if(J===0)return!0;else if(J<0)Q=Q.left;else Q=Q.right}}return!1}next(K){var Q=K;if(Q)if(Q.right){Q=Q.right;while(Q.left)Q=Q.left}else{Q=K.parent;while(Q&&Q.right===K)K=Q,Q=Q.parent}return Q}prev(K){var Q=K;if(Q)if(Q.left){Q=Q.left;while(Q.right)Q=Q.right}else{Q=K.parent;while(Q&&Q.left===K)K=Q,Q=Q.parent}return Q}forEach(K){var Q=this._root,$=[],J=!1,Z=0;while(!J)if(Q)$.push(Q),Q=Q.left;else if($.length>0)Q=$.pop(),K(Q,Z++),Q=Q.right;else J=!0;return this}range(K,Q,$,J){const Z=[],V=this._comparator;let B=this._root,Y;while(Z.length!==0||B)if(B)Z.push(B),B=B.left;else{if(B=Z.pop(),Y=V(B.key,Q),Y>0)break;else if(V(B.key,K)>=0){if($.call(J,B))return this}B=B.right}return this}keys(){var K=this._root,Q=[],$=[],J=!1;while(!J)if(K)Q.push(K),K=K.left;else if(Q.length>0)K=Q.pop(),$.push(K.key),K=K.right;else J=!0;return $}values(){var K=this._root,Q=[],$=[],J=!1;while(!J)if(K)Q.push(K),K=K.left;else if(Q.length>0)K=Q.pop(),$.push(K.data),K=K.right;else J=!0;return $}at(K){var Q=this._root,$=[],J=!1,Z=0;while(!J)if(Q)$.push(Q),Q=Q.left;else if($.length>0){if(Q=$.pop(),Z===K)return Q;Z++,Q=Q.right}else J=!0;return null}minNode(){var K=this._root;if(!K)return null;while(K.left)K=K.left;return K}maxNode(){var K=this._root;if(!K)return null;while(K.right)K=K.right;return K}min(){var K=this._root;if(!K)return null;while(K.left)K=K.left;return K.key}max(){var K=this._root;if(!K)return null;while(K.right)K=K.right;return K.key}isEmpty(){return!this._root}pop(){var K=this._root,Q=null;if(K){while(K.left)K=K.left;Q={key:K.key,data:K.data},this.remove(K.key)}return Q}popMax(){var K=this._root,Q=null;if(K){while(K.right)K=K.right;Q={key:K.key,data:K.data},this.remove(K.key)}return Q}find(K){var Q=this._root,$=Q,J,Z=this._comparator;while($)if(J=Z(K,$.key),J===0)return $;else if(J<0)$=$.left;else $=$.right;return null}insert(K,Q){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:K,data:Q},this._size++,this._root;var $=this._comparator,J=this._root,Z=null,V=0;if(this._noDuplicates)while(J)if(V=$(K,J.key),Z=J,V===0)return null;else if(V<0)J=J.left;else J=J.right;else while(J)if(V=$(K,J.key),Z=J,V<=0)J=J.left;else J=J.right;var B={left:null,right:null,balanceFactor:0,parent:Z,key:K,data:Q},Y;if(V<=0)Z.left=B;else Z.right=B;while(Z){if(V=$(Z.key,K),V<0)Z.balanceFactor-=1;else Z.balanceFactor+=1;if(Z.balanceFactor===0)break;else if(Z.balanceFactor<-1){if(Z.right.balanceFactor===1)K0(Z.right);if(Y=t(Z),Z===this._root)this._root=Y;break}else if(Z.balanceFactor>1){if(Z.left.balanceFactor===-1)t(Z.left);if(Y=K0(Z),Z===this._root)this._root=Y;break}Z=Z.parent}return this._size++,B}remove(K){if(!this._root)return null;var Q=this._root,$=this._comparator,J=0;while(Q)if(J=$(K,Q.key),J===0)break;else if(J<0)Q=Q.left;else Q=Q.right;if(!Q)return null;var Z=Q.key,V,B;if(Q.left){V=Q.left;while(V.left||V.right){while(V.right)V=V.right;if(Q.key=V.key,Q.data=V.data,V.left)Q=V,V=V.left}Q.key=V.key,Q.data=V.data,Q=V}if(Q.right){B=Q.right;while(B.left||B.right){while(B.left)B=B.left;if(Q.key=B.key,Q.data=B.data,B.right)Q=B,B=B.right}Q.key=B.key,Q.data=B.data,Q=B}var Y=Q.parent,F=Q,P;while(Y){if(Y.left===F)Y.balanceFactor-=1;else Y.balanceFactor+=1;if(Y.balanceFactor<-1){if(Y.right.balanceFactor===1)K0(Y.right);if(P=t(Y),Y===this._root)this._root=P;Y=P}else if(Y.balanceFactor>1){if(Y.left.balanceFactor===-1)t(Y.left);if(P=K0(Y),Y===this._root)this._root=P;Y=P}if(Y.balanceFactor===-1||Y.balanceFactor===1)break;F=Y,Y=Y.parent}if(Q.parent)if(Q.parent.left===Q)Q.parent.left=null;else Q.parent.right=null;if(Q===this._root)this._root=null;return this._size--,Z}load(K=[],Q=[],$){if(this._size!==0)throw new Error("bulk-load: tree is not empty");const J=K.length;if($)a(K,Q,0,J-1,this._comparator);return this._root=u(null,K,Q,0,J),o(this._root),this._size=J,this}isBalanced(){return b(this._root)}toString(K){return f0(this._root,K)}}c.default=c;class y{size;slotNumber;x;y;textureIndex;parent;sibbling;textureSizeLimits;constructor(K,Q,$,J){this.textureSizeLimits=$?.textureSizeLimits??J??{min:W0,max:U0},this.size=K,this.slotNumber=Q,this.parent=$,this.sibbling=void 0;const{x:Z,y:V,textureIndex:B}=this.calculatePosition(K,Q);this.x=Z,this.y=V,this.textureIndex=B}calculateTextureIndex(K,Q){const[$,J]=K,Z=this.textureSizeLimits.max/$*(this.textureSizeLimits.max/J);return Math.floor(Q/Z)}calculatePosition(K,Q){const[$,J]=K,Z=this.textureSizeLimits.max/$,V=this.textureSizeLimits.max/J,B=Q%Z*$,Y=Math.floor(Q/Z)%V*J;return{x:B,y:Y,textureIndex:this.calculateTextureIndex(K,Q)}}getTag(){return y.getTag(this)}static getTag(K){return`${K.size[0]}x${K.size[1]}-#${K.slotNumber}`}static positionToTextureSlot(K,Q,$,J,Z){const[V,B]=$,Y=Z.textureSizeLimits.max/V,P=Z.textureSizeLimits.max/V*(Z.textureSizeLimits.max/B)*J+Q/B*Y+K/V;return new y($,P,Z)}getPosition(){return{x:this.x,y:this.y,size:this.size,textureIndex:this.textureIndex}}canSplitHorizontally(){const[,K]=this.size;return K>this.textureSizeLimits.min}canSplitVertically(){const[K]=this.size;return K>this.textureSizeLimits.min}splitHorizontally(){const{x:K,y:Q,size:$,textureIndex:J}=this,[Z,V]=$;if(!this.canSplitHorizontally())throw new Error(`Cannot split texture slot of size ${Z} horizontally`);const B=Z/2,Y=y.positionToTextureSlot(K,Q,[B,V],J,this),F=y.positionToTextureSlot(K+B,Q,[B,V],J,this);return Y.sibbling=F,F.sibbling=Y,[Y,F]}splitVertically(){const{x:K,y:Q,size:$,textureIndex:J}=this,[Z,V]=$;if(!this.canSplitVertically())throw new Error(`Cannot split texture slot of size ${V} vertically`);const B=V/2,Y=y.positionToTextureSlot(K,Q,[Z,B],J,this),F=y.positionToTextureSlot(K,Q+B,[Z,B],J,this);return Y.sibbling=F,F.sibbling=Y,[Y,F]}}function Q0(K,Q){return Math.max(Q,Math.pow(2,Math.ceil(Math.log(K)/Math.log(2))))}function z0(K,Q,$,J){if($<1)throw new Error("Invalid count");const Z=Q0(K,J.min),V=Q0(Q,J.min),B=new Map;let Y=J.min;for(let F=1;F<=$;F++){Y=Q0(Z*F,J.min);const P=Q0(V*Math.ceil($/F),J.min);B.set(Y,P)}for(let F=Y;F<=J.max;F*=2)if(!B.has(F))B.set(F,V);return B}var qK=!1,W0=16,U0=4096,LK=16;class D0{textureSlots=new c((K,Q)=>{const $=K.size[0]*K.size[1]-Q.size[0]*Q.size[1];if($!==0)return $;return K.slotNumber-Q.slotNumber},!1);allocatedTextures={};minTextureSize;maxTextureSize;numTextureSheets;initialSlots=[];constructor({numTextureSheets:K,minTextureSize:Q,maxTextureSize:$}={},J){if(this.numTextureSheets=K??LK,this.minTextureSize=Q??W0,this.maxTextureSize=$??U0,J)this.numTextureSheets=Math.min(this.numTextureSheets,J.getParameter(WebGL2RenderingContext.MAX_TEXTURE_IMAGE_UNITS)),this.maxTextureSize=Math.min(this.maxTextureSize,J.getParameter(WebGL2RenderingContext.MAX_TEXTURE_SIZE)),this.minTextureSize=Math.min(this.minTextureSize,this.maxTextureSize);for(let Z=0;Z<this.numTextureSheets;Z++)this.initialSlots.push(new y([this.maxTextureSize,this.maxTextureSize],Z,void 0,{min:this.minTextureSize,max:this.maxTextureSize}));this.initialSlots.forEach((Z)=>this.textureSlots.insert(Z))}allocate(K,Q,$=1){const{size:J,slotNumber:Z,x:V,y:B,textureIndex:Y}=this.allocateHelper(K,Q,$);return{size:J,slotNumber:Z,x:V,y:B,textureIndex:Y}}deallocate(K){if(!this.isSlotUsed(K))throw new Error("Slot is not allocated");const Q=this.allocatedTextures[y.getTag(K)];this.deallocateHelper(Q)}get countUsedTextureSheets(){return this.initialSlots.filter((K)=>this.isSlotUsed(K)).length}allocateHelper(K,Q,$=1){const J=z0(K,Q,$,{min:this.minTextureSize,max:this.maxTextureSize}),Z=this.findSlot(J);if(!Z)throw new Error(`Could not find a slot for texture to fit ${$} sprites of size ${K}x${Q}`);this.textureSlots.remove(Z);const[V,B]=this.bestFit(J,Z);return this.fitSlot(Z,V,B)}findSlot(K){for(let Q=0;Q<this.textureSlots.size;Q++){const J=this.textureSlots.at(Q).key,[Z,V]=J.size;if(K.get(Z)<=V)return J}return null}calculateRatio(K,Q){return Math.max(K/Q,Q/K)}bestFit(K,Q){const[$,J]=Q.size;let Z=Q.textureSizeLimits.max;return K.forEach((V,B)=>{if(B<=$&&V<=J){const Y=B*V,F=K.get(Z)*Z;if(Y<F)Z=B;else if(Y===F){if(this.calculateRatio(B,V)<this.calculateRatio(Z,K.get(Z)))Z=B}}}),[Z,K.get(Z)]}isSlotUsed(K){return!!this.allocatedTextures[y.getTag(K)]}deallocateHelper(K){if(K.parent&&K.sibbling&&!this.isSlotUsed(K.sibbling)){const Q=K.sibbling;if(this.textureSlots.remove(Q),qK&&this.textureSlots.find(K))throw new Error("Slot is not expected to be in the tree");const $=K.parent;this.deallocateHelper($);return}this.textureSlots.insert(K),delete this.allocatedTextures[K.getTag()]}trySplitHorizontally(K,Q,$){if(K.canSplitHorizontally()){const[J,Z]=K.splitHorizontally();if(J.size[0]>=Q)return this.textureSlots.insert(Z),this.fitSlot(J,Q,$)}return null}trySplitVertically(K,Q,$){if(K.canSplitVertically()){const[J,Z]=K.splitVertically();if(J.size[1]>=$)return this.textureSlots.insert(Z),this.fitSlot(J,Q,$)}return null}fitSlot(K,Q,$){if(this.allocatedTextures[K.getTag()]=K,K.size[0]>K.size[1]){const J=this.trySplitHorizontally(K,Q,$)??this.trySplitVertically(K,Q,$);if(J)return J}else{const J=this.trySplitVertically(K,Q,$)??this.trySplitHorizontally(K,Q,$);if(J)return J}return K}listSlots(){this.textureSlots.forEach((K)=>{console.log(K.key?.getTag())})}}class E0 extends g{gl;uniforms;textureBuffers={};tempCanvas=new OffscreenCanvas(1,1);tempContext=this.tempCanvas.getContext("2d");textureSlotAllocator=new D0;constructor(K,Q){super();this.gl=K,this.uniforms=Q,this.tempContext.imageSmoothingEnabled=!0}initialize(){this.initTextureUniforms(),this.initMaxTexture()}getTexture(K){if(!this.textureBuffers[K]){const Q=this.gl.createTexture();if(!Q)return;this.gl.bindTexture(j.TEXTURE_2D,Q),this.gl.texImage2D(j.TEXTURE_2D,0,j.RGBA,this.textureSlotAllocator.maxTextureSize,this.textureSlotAllocator.maxTextureSize,0,j.RGBA,j.UNSIGNED_BYTE,null),this.textureBuffers[K]=Q,this.addOnDestroy(()=>this.gl.deleteTexture(Q))}return this.textureBuffers[K]}loadTexture(K,Q,$,J,Z){this.gl.activeTexture(j[Q]),this.gl.bindTexture(j.TEXTURE_2D,$),this.applyTexImage2d(K,J,Z),this.gl.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR)}applyTexImage2d(K,[Q,$,J,Z],[V,B,Y,F]){if(J===Y&&Z===F&&!Q&&!$)this.gl.texSubImage2D(j.TEXTURE_2D,0,V,B,J,Z,j.RGBA,j.UNSIGNED_BYTE,K.texImgSrc);else{console.log("Used canvas");const P=this.tempContext.canvas;if(K.texImgSrc instanceof ImageData){if(P.width=Y||K.width,P.height=F||K.height,this.tempContext.putImageData(K.texImgSrc,0,0),Q||$)console.warn("Offset not available when sending imageData")}else{const C=J||K.width,X=Z||K.height;P.width=Y||C,P.height=F||X,this.tempContext.drawImage(K.texImgSrc,Q,$,C,X,0,0,P.width,P.height)}this.gl.texSubImage2D(j.TEXTURE_2D,0,V,B,P.width,P.height,j.RGBA,j.UNSIGNED_BYTE,P)}}allocateSlotForImage(K){const Q=this.textureSlotAllocator.allocate(K.width,K.height),$=`TEXTURE${Q.textureIndex}`,J=this.getTexture($);if(!J)throw new Error(`Invalid texture Id ${$}`);const Z=this.assignImageToTexture(K,$,J,[0,0,K.width,K.height],[Q.x,Q.y,...Q.size]);return{slot:Q,refreshCallback:Z}}assignImageToTexture(K,Q,$,J,Z){if(K){const V=J??[0,0,K.width,K.height],B=Z??[0,0,V[2],V[3]];if(K.active){const Y=()=>{this.gl.bindTexture(j.TEXTURE_2D,$),this.applyTexImage2d(K,V,B)};return Y(),Y}else this.loadTexture(K,Q,$,V,B),K.active=!0}return null}generateMipMap(K){const Q=this.getTexture(K);if(Q)this.gl.activeTexture(j[K]),this.gl.bindTexture(j.TEXTURE_2D,Q),this.gl.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.LINEAR),this.gl.generateMipmap(j.TEXTURE_2D),console.log("GENERATED MIPMAP")}generateMipMaps(){const K=this.textureSlotAllocator.countUsedTextureSheets;for(let Q=0;Q<K;Q++){const $=`TEXTURE${Q}`;this.generateMipMap($)}}initTextureUniforms(){const K=this.gl.getParameter(j.MAX_TEXTURE_IMAGE_UNITS),Q=new Array(K).fill(null).map((J,Z)=>Z),$=this.uniforms.getUniformLocation(g0);this.gl.uniform1iv($,Q)}initMaxTexture(){const K=this.uniforms.getUniformLocation(v0);this.gl.uniform1f(K,this.textureSlotAllocator.maxTextureSize)}}class x extends g{texImgSrc;active=!1;width;height;constructor(K){super();if(this.texImgSrc=K,this.width=K instanceof Image?K.naturalWidth:K instanceof VideoFrame?K.displayWidth:K.width,this.height=K instanceof Image?K.naturalHeight:K instanceof VideoFrame?K.displayHeight:K.height,!this.width||!this.height)throw new Error("Invalid image")}static createFromCanvas(K){return new x(K)}static async loadImage(K){return new Promise((Q,$)=>{const J=new Image,Z=new x(J),V=()=>Q(Z),B=(Y)=>$(Y.error);J.addEventListener("error",B),J.addEventListener("load",V,{once:!0}),Z.addOnDestroy(()=>J.removeEventListener("load",V)),J.src=K})}static async loadVideo(K,Q){return new Promise(($,J)=>{const Z=document.createElement("video"),V=new x(Z);if(Z.loop=!0,Q!==void 0)Z.volume=Q;const B=()=>Z.play(),Y=()=>$(V);Z.addEventListener("loadedmetadata",B),Z.addEventListener("playing",Y,{once:!0}),Z.addEventListener("error",(F)=>J(F.error)),Z.src=K,V.addOnDestroy(()=>{Z.pause(),Z.removeEventListener("playing",Y),Z.removeEventListener("loadmetadata",B)})})}static async loadWebcam(K){return new Promise((Q,$)=>{const J=document.createElement("video"),Z=new x(J);J.loop=!0;const V=()=>J.play(),B=()=>Q(Z);J.addEventListener("loadedmetadata",V),J.addEventListener("playing",B,{once:!0}),J.addEventListener("error",(F)=>$(F.error));let Y=!1;navigator.mediaDevices.getUserMedia({video:{deviceId:K}}).then((F)=>{if(!Y)J.srcObject=F,Z.addOnDestroy(()=>F.getTracks().forEach((P)=>P.stop()))}),Z.addOnDestroy(()=>{Y=!0,J.pause(),J.removeEventListener("playing",B),J.removeEventListener("loadmetadata",V)})})}}class j0 extends g{constructor(){super(...arguments)}images={};hasImageId(K){return!!this.getMedia(K)}getMedia(K){return this.images[K]}setImage(K,Q){this.images[K]=Q}async drawImage(K,Q){const $=new OffscreenCanvas(1,1);Q($.getContext("2d"));const J=x.createFromCanvas($);return this.images[K]=this.own(J),J}async loadCanvas(K,Q){const $=x.createFromCanvas(Q);return Q.getContext("2d"),this.images[K]=this.own($),$}async loadImage(K,Q){const $=await x.loadImage(Q);return this.images[K]=this.own($),$}async loadVideo(K,Q,$){const J=await x.loadVideo(Q,$);return this.images[K]=this.own(J),J}async loadWebCam(K,Q){const $=await x.loadWebcam(Q);return this.images[K]=this.own($),$}}var y0=`#version 300 es
//  ~{AUTHOR}

precision highp float;

//  IN
//  shape
layout(location = 0) in vec4 position_and_tex;
layout(location = 1) in mat4 transform;
//  2, 3, 4
//  animation
layout(location = 5) in vec3 slotSize_and_number;

//  UNIFORM
uniform float maxTextureSize;
uniform mat4 cam;
uniform mat4 projection;

//  OUT
out vec2 vTex;
out float textureIndex;

void main() {
  vec2 position = position_and_tex.xy;
  vec2 tex = position_and_tex.zw;
  vec2 slotSize = slotSize_and_number.xy;
  float slotNumber = slotSize_and_number.z;

  float maxCols = maxTextureSize / slotSize.x;
  float maxRows = maxTextureSize / slotSize.y;
  float slotX = mod(slotNumber, maxCols);
  float slotY = mod(floor(slotNumber / maxCols), maxRows);

  gl_Position = projection * cam * transform * vec4(position, 0.0, 1.0);
  vTex = (vec2(slotX, slotY) + tex) * slotSize / maxTextureSize;
  textureIndex = floor(slotNumber / (maxCols * maxRows));
}
`;var x0=`#version 300 es
//  ~{AUTHOR}
precision highp float;

//  CONST
const int NUM_TEXTURES = 16;
const float threshold = 0.00001;

//  IN
//  texture
uniform sampler2D uTextures[NUM_TEXTURES];
in float textureIndex;
in vec2 vTex;
in float opacity;

//  OUT
out vec4 fragColor;

//  FUNCTIONS
vec4 getTextureColor(float textureSlot, vec2 vTexturePoint);

void main() {
  vec4 color = getTextureColor(textureIndex, vTex);
  if (color.a <= .01) {
    discard;
  };
  fragColor = color;
}

vec4 getTextureColor(float textureSlot, vec2 vTexturePoint) {
  if (abs(0.0 - textureSlot) < threshold) {
    return texture(uTextures[0], vTexturePoint);
  }
  if (abs(1.0 - textureSlot) < threshold) {
    return texture(uTextures[1], vTexturePoint);
  }
  if (abs(2.0 - textureSlot) < threshold) {
    return texture(uTextures[2], vTexturePoint);
  }
  if (abs(3.0 - textureSlot) < threshold) {
    return texture(uTextures[3], vTexturePoint);
  }
  if (abs(4.0 - textureSlot) < threshold) {
    return texture(uTextures[4], vTexturePoint);
  }
  if (abs(5.0 - textureSlot) < threshold) {
    return texture(uTextures[5], vTexturePoint);
  }
  if (abs(6.0 - textureSlot) < threshold) {
    return texture(uTextures[6], vTexturePoint);
  }
  if (abs(7.0 - textureSlot) < threshold) {
    return texture(uTextures[7], vTexturePoint);
  }
  if (abs(8.0 - textureSlot) < threshold) {
    return texture(uTextures[8], vTexturePoint);
  }
  if (abs(9.0 - textureSlot) < threshold) {
    return texture(uTextures[9], vTexturePoint);
  }
  if (abs(10.0 - textureSlot) < threshold) {
    return texture(uTextures[10], vTexturePoint);
  }
  if (abs(11.0 - textureSlot) < threshold) {
    return texture(uTextures[11], vTexturePoint);
  }
  if (abs(12.0 - textureSlot) < threshold) {
    return texture(uTextures[12], vTexturePoint);
  }
  if (abs(13.0 - textureSlot) < threshold) {
    return texture(uTextures[13], vTexturePoint);
  }
  if (abs(14.0 - textureSlot) < threshold) {
    return texture(uTextures[14], vTexturePoint);
  }
  if (abs(15.0 - textureSlot) < threshold) {
    return texture(uTextures[15], vTexturePoint);
  }
  return texture(uTextures[0], vTexturePoint);
}
`;function A0(K,Q){return K.replace(/~\{(\w+)\}/g,($,J)=>{return Q?.[J]||$})}var N=0.000001,q=typeof Float32Array!=="undefined"?Float32Array:Array,m=Math.random,AJ=Math.PI/180;if(!Math.hypot)Math.hypot=function(){var K=0,Q=arguments.length;while(Q--)K+=arguments[Q]*arguments[Q];return Math.sqrt(K)};function m0(){var K=new q(9);if(q!=Float32Array)K[1]=0,K[2]=0,K[3]=0,K[5]=0,K[6]=0,K[7]=0;return K[0]=1,K[4]=1,K[8]=1,K}var T={};Y0(T,{transpose:()=>{{return zK}},translate:()=>{{return cK}},targetTo:()=>{{return HQ}},subtract:()=>{{return r0}},sub:()=>{{return RQ}},str:()=>{{return OQ}},set:()=>{{return fK}},scale:()=>{{return lK}},rotateZ:()=>{{return sK}},rotateY:()=>{{return nK}},rotateX:()=>{{return dK}},rotate:()=>{{return iK}},perspectiveZO:()=>{{return BQ}},perspectiveNO:()=>{{return n0}},perspectiveFromFieldOfView:()=>{{return FQ}},perspective:()=>{{return YQ}},orthoZO:()=>{{return CQ}},orthoNO:()=>{{return s0}},ortho:()=>{{return PQ}},multiplyScalarAndAdd:()=>{{return EQ}},multiplyScalar:()=>{{return DQ}},multiply:()=>{{return l0}},mul:()=>{{return MQ}},lookAt:()=>{{return XQ}},invert:()=>{{return yK}},identity:()=>{{return c0}},getTranslation:()=>{{return KQ}},getScaling:()=>{{return d0}},getRotation:()=>{{return QQ}},frustum:()=>{{return VQ}},fromZRotation:()=>{{return aK}},fromYRotation:()=>{{return oK}},fromXRotation:()=>{{return uK}},fromValues:()=>{{return gK}},fromTranslation:()=>{{return rK}},fromScaling:()=>{{return bK}},fromRotationTranslationScaleOrigin:()=>{{return JQ}},fromRotationTranslationScale:()=>{{return $Q}},fromRotationTranslation:()=>{{return i0}},fromRotation:()=>{{return eK}},fromQuat2:()=>{{return tK}},fromQuat:()=>{{return ZQ}},frob:()=>{{return WQ}},exactEquals:()=>{{return jQ}},equals:()=>{{return AQ}},determinant:()=>{{return mK}},create:()=>{{return wK}},copy:()=>{{return vK}},clone:()=>{{return pK}},adjoint:()=>{{return xK}},add:()=>{{return UQ}}});function wK(){var K=new q(16);if(q!=Float32Array)K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[11]=0,K[12]=0,K[13]=0,K[14]=0;return K[0]=1,K[5]=1,K[10]=1,K[15]=1,K}function pK(K){var Q=new q(16);return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q[4]=K[4],Q[5]=K[5],Q[6]=K[6],Q[7]=K[7],Q[8]=K[8],Q[9]=K[9],Q[10]=K[10],Q[11]=K[11],Q[12]=K[12],Q[13]=K[13],Q[14]=K[14],Q[15]=K[15],Q}function vK(K,Q){return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function gK(K,Q,$,J,Z,V,B,Y,F,P,C,X,W,O,D,U){var H=new q(16);return H[0]=K,H[1]=Q,H[2]=$,H[3]=J,H[4]=Z,H[5]=V,H[6]=B,H[7]=Y,H[8]=F,H[9]=P,H[10]=C,H[11]=X,H[12]=W,H[13]=O,H[14]=D,H[15]=U,H}function fK(K,Q,$,J,Z,V,B,Y,F,P,C,X,W,O,D,U,H){return K[0]=Q,K[1]=$,K[2]=J,K[3]=Z,K[4]=V,K[5]=B,K[6]=Y,K[7]=F,K[8]=P,K[9]=C,K[10]=X,K[11]=W,K[12]=O,K[13]=D,K[14]=U,K[15]=H,K}function c0(K){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function zK(K,Q){if(K===Q){var $=Q[1],J=Q[2],Z=Q[3],V=Q[6],B=Q[7],Y=Q[11];K[1]=Q[4],K[2]=Q[8],K[3]=Q[12],K[4]=$,K[6]=Q[9],K[7]=Q[13],K[8]=J,K[9]=V,K[11]=Q[14],K[12]=Z,K[13]=B,K[14]=Y}else K[0]=Q[0],K[1]=Q[4],K[2]=Q[8],K[3]=Q[12],K[4]=Q[1],K[5]=Q[5],K[6]=Q[9],K[7]=Q[13],K[8]=Q[2],K[9]=Q[6],K[10]=Q[10],K[11]=Q[14],K[12]=Q[3],K[13]=Q[7],K[14]=Q[11],K[15]=Q[15];return K}function yK(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=Q[4],Y=Q[5],F=Q[6],P=Q[7],C=Q[8],X=Q[9],W=Q[10],O=Q[11],D=Q[12],U=Q[13],H=Q[14],E=Q[15],G=$*Y-J*B,_=$*F-Z*B,R=$*P-V*B,A=J*F-Z*Y,M=J*P-V*Y,w=Z*P-V*F,h=C*U-X*D,S=C*H-W*D,I=C*E-O*D,p=X*H-W*U,v=X*E-O*U,f=W*E-O*H,k=G*f-_*v+R*p+A*I-M*S+w*h;if(!k)return null;return k=1/k,K[0]=(Y*f-F*v+P*p)*k,K[1]=(Z*v-J*f-V*p)*k,K[2]=(U*w-H*M+E*A)*k,K[3]=(W*M-X*w-O*A)*k,K[4]=(F*I-B*f-P*S)*k,K[5]=($*f-Z*I+V*S)*k,K[6]=(H*R-D*w-E*_)*k,K[7]=(C*w-W*R+O*_)*k,K[8]=(B*v-Y*I+P*h)*k,K[9]=(J*I-$*v-V*h)*k,K[10]=(D*M-U*R+E*G)*k,K[11]=(X*R-C*M-O*G)*k,K[12]=(Y*S-B*p-F*h)*k,K[13]=($*p-J*S+Z*h)*k,K[14]=(U*_-D*A-H*G)*k,K[15]=(C*A-X*_+W*G)*k,K}function xK(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=Q[4],Y=Q[5],F=Q[6],P=Q[7],C=Q[8],X=Q[9],W=Q[10],O=Q[11],D=Q[12],U=Q[13],H=Q[14],E=Q[15];return K[0]=Y*(W*E-O*H)-X*(F*E-P*H)+U*(F*O-P*W),K[1]=-(J*(W*E-O*H)-X*(Z*E-V*H)+U*(Z*O-V*W)),K[2]=J*(F*E-P*H)-Y*(Z*E-V*H)+U*(Z*P-V*F),K[3]=-(J*(F*O-P*W)-Y*(Z*O-V*W)+X*(Z*P-V*F)),K[4]=-(B*(W*E-O*H)-C*(F*E-P*H)+D*(F*O-P*W)),K[5]=$*(W*E-O*H)-C*(Z*E-V*H)+D*(Z*O-V*W),K[6]=-($*(F*E-P*H)-B*(Z*E-V*H)+D*(Z*P-V*F)),K[7]=$*(F*O-P*W)-B*(Z*O-V*W)+C*(Z*P-V*F),K[8]=B*(X*E-O*U)-C*(Y*E-P*U)+D*(Y*O-P*X),K[9]=-($*(X*E-O*U)-C*(J*E-V*U)+D*(J*O-V*X)),K[10]=$*(Y*E-P*U)-B*(J*E-V*U)+D*(J*P-V*Y),K[11]=-($*(Y*O-P*X)-B*(J*O-V*X)+C*(J*P-V*Y)),K[12]=-(B*(X*H-W*U)-C*(Y*H-F*U)+D*(Y*W-F*X)),K[13]=$*(X*H-W*U)-C*(J*H-Z*U)+D*(J*W-Z*X),K[14]=-($*(Y*H-F*U)-B*(J*H-Z*U)+D*(J*F-Z*Y)),K[15]=$*(Y*W-F*X)-B*(J*W-Z*X)+C*(J*F-Z*Y),K}function mK(K){var Q=K[0],$=K[1],J=K[2],Z=K[3],V=K[4],B=K[5],Y=K[6],F=K[7],P=K[8],C=K[9],X=K[10],W=K[11],O=K[12],D=K[13],U=K[14],H=K[15],E=Q*B-$*V,G=Q*Y-J*V,_=Q*F-Z*V,R=$*Y-J*B,A=$*F-Z*B,M=J*F-Z*Y,w=P*D-C*O,h=P*U-X*O,S=P*H-W*O,I=C*U-X*D,p=C*H-W*D,v=X*H-W*U;return E*v-G*p+_*I+R*S-A*h+M*w}function l0(K,Q,$){var J=Q[0],Z=Q[1],V=Q[2],B=Q[3],Y=Q[4],F=Q[5],P=Q[6],C=Q[7],X=Q[8],W=Q[9],O=Q[10],D=Q[11],U=Q[12],H=Q[13],E=Q[14],G=Q[15],_=$[0],R=$[1],A=$[2],M=$[3];return K[0]=_*J+R*Y+A*X+M*U,K[1]=_*Z+R*F+A*W+M*H,K[2]=_*V+R*P+A*O+M*E,K[3]=_*B+R*C+A*D+M*G,_=$[4],R=$[5],A=$[6],M=$[7],K[4]=_*J+R*Y+A*X+M*U,K[5]=_*Z+R*F+A*W+M*H,K[6]=_*V+R*P+A*O+M*E,K[7]=_*B+R*C+A*D+M*G,_=$[8],R=$[9],A=$[10],M=$[11],K[8]=_*J+R*Y+A*X+M*U,K[9]=_*Z+R*F+A*W+M*H,K[10]=_*V+R*P+A*O+M*E,K[11]=_*B+R*C+A*D+M*G,_=$[12],R=$[13],A=$[14],M=$[15],K[12]=_*J+R*Y+A*X+M*U,K[13]=_*Z+R*F+A*W+M*H,K[14]=_*V+R*P+A*O+M*E,K[15]=_*B+R*C+A*D+M*G,K}function cK(K,Q,$){var J=$[0],Z=$[1],V=$[2],B,Y,F,P,C,X,W,O,D,U,H,E;if(Q===K)K[12]=Q[0]*J+Q[4]*Z+Q[8]*V+Q[12],K[13]=Q[1]*J+Q[5]*Z+Q[9]*V+Q[13],K[14]=Q[2]*J+Q[6]*Z+Q[10]*V+Q[14],K[15]=Q[3]*J+Q[7]*Z+Q[11]*V+Q[15];else B=Q[0],Y=Q[1],F=Q[2],P=Q[3],C=Q[4],X=Q[5],W=Q[6],O=Q[7],D=Q[8],U=Q[9],H=Q[10],E=Q[11],K[0]=B,K[1]=Y,K[2]=F,K[3]=P,K[4]=C,K[5]=X,K[6]=W,K[7]=O,K[8]=D,K[9]=U,K[10]=H,K[11]=E,K[12]=B*J+C*Z+D*V+Q[12],K[13]=Y*J+X*Z+U*V+Q[13],K[14]=F*J+W*Z+H*V+Q[14],K[15]=P*J+O*Z+E*V+Q[15];return K}function lK(K,Q,$){var J=$[0],Z=$[1],V=$[2];return K[0]=Q[0]*J,K[1]=Q[1]*J,K[2]=Q[2]*J,K[3]=Q[3]*J,K[4]=Q[4]*Z,K[5]=Q[5]*Z,K[6]=Q[6]*Z,K[7]=Q[7]*Z,K[8]=Q[8]*V,K[9]=Q[9]*V,K[10]=Q[10]*V,K[11]=Q[11]*V,K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15],K}function iK(K,Q,$,J){var Z=J[0],V=J[1],B=J[2],Y=Math.hypot(Z,V,B),F,P,C,X,W,O,D,U,H,E,G,_,R,A,M,w,h,S,I,p,v,f,k,z;if(Y<N)return null;if(Y=1/Y,Z*=Y,V*=Y,B*=Y,F=Math.sin($),P=Math.cos($),C=1-P,X=Q[0],W=Q[1],O=Q[2],D=Q[3],U=Q[4],H=Q[5],E=Q[6],G=Q[7],_=Q[8],R=Q[9],A=Q[10],M=Q[11],w=Z*Z*C+P,h=V*Z*C+B*F,S=B*Z*C-V*F,I=Z*V*C-B*F,p=V*V*C+P,v=B*V*C+Z*F,f=Z*B*C+V*F,k=V*B*C-Z*F,z=B*B*C+P,K[0]=X*w+U*h+_*S,K[1]=W*w+H*h+R*S,K[2]=O*w+E*h+A*S,K[3]=D*w+G*h+M*S,K[4]=X*I+U*p+_*v,K[5]=W*I+H*p+R*v,K[6]=O*I+E*p+A*v,K[7]=D*I+G*p+M*v,K[8]=X*f+U*k+_*z,K[9]=W*f+H*k+R*z,K[10]=O*f+E*k+A*z,K[11]=D*f+G*k+M*z,Q!==K)K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K}function dK(K,Q,$){var J=Math.sin($),Z=Math.cos($),V=Q[4],B=Q[5],Y=Q[6],F=Q[7],P=Q[8],C=Q[9],X=Q[10],W=Q[11];if(Q!==K)K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K[4]=V*Z+P*J,K[5]=B*Z+C*J,K[6]=Y*Z+X*J,K[7]=F*Z+W*J,K[8]=P*Z-V*J,K[9]=C*Z-B*J,K[10]=X*Z-Y*J,K[11]=W*Z-F*J,K}function nK(K,Q,$){var J=Math.sin($),Z=Math.cos($),V=Q[0],B=Q[1],Y=Q[2],F=Q[3],P=Q[8],C=Q[9],X=Q[10],W=Q[11];if(Q!==K)K[4]=Q[4],K[5]=Q[5],K[6]=Q[6],K[7]=Q[7],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K[0]=V*Z-P*J,K[1]=B*Z-C*J,K[2]=Y*Z-X*J,K[3]=F*Z-W*J,K[8]=V*J+P*Z,K[9]=B*J+C*Z,K[10]=Y*J+X*Z,K[11]=F*J+W*Z,K}function sK(K,Q,$){var J=Math.sin($),Z=Math.cos($),V=Q[0],B=Q[1],Y=Q[2],F=Q[3],P=Q[4],C=Q[5],X=Q[6],W=Q[7];if(Q!==K)K[8]=Q[8],K[9]=Q[9],K[10]=Q[10],K[11]=Q[11],K[12]=Q[12],K[13]=Q[13],K[14]=Q[14],K[15]=Q[15];return K[0]=V*Z+P*J,K[1]=B*Z+C*J,K[2]=Y*Z+X*J,K[3]=F*Z+W*J,K[4]=P*Z-V*J,K[5]=C*Z-B*J,K[6]=X*Z-Y*J,K[7]=W*Z-F*J,K}function rK(K,Q){return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=Q[0],K[13]=Q[1],K[14]=Q[2],K[15]=1,K}function bK(K,Q){return K[0]=Q[0],K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=Q[1],K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=Q[2],K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function eK(K,Q,$){var J=$[0],Z=$[1],V=$[2],B=Math.hypot(J,Z,V),Y,F,P;if(B<N)return null;return B=1/B,J*=B,Z*=B,V*=B,Y=Math.sin(Q),F=Math.cos(Q),P=1-F,K[0]=J*J*P+F,K[1]=Z*J*P+V*Y,K[2]=V*J*P-Z*Y,K[3]=0,K[4]=J*Z*P-V*Y,K[5]=Z*Z*P+F,K[6]=V*Z*P+J*Y,K[7]=0,K[8]=J*V*P+Z*Y,K[9]=Z*V*P-J*Y,K[10]=V*V*P+F,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function uK(K,Q){var $=Math.sin(Q),J=Math.cos(Q);return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=J,K[6]=$,K[7]=0,K[8]=0,K[9]=-$,K[10]=J,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function oK(K,Q){var $=Math.sin(Q),J=Math.cos(Q);return K[0]=J,K[1]=0,K[2]=-$,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=$,K[9]=0,K[10]=J,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function aK(K,Q){var $=Math.sin(Q),J=Math.cos(Q);return K[0]=J,K[1]=$,K[2]=0,K[3]=0,K[4]=-$,K[5]=J,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function i0(K,Q,$){var J=Q[0],Z=Q[1],V=Q[2],B=Q[3],Y=J+J,F=Z+Z,P=V+V,C=J*Y,X=J*F,W=J*P,O=Z*F,D=Z*P,U=V*P,H=B*Y,E=B*F,G=B*P;return K[0]=1-(O+U),K[1]=X+G,K[2]=W-E,K[3]=0,K[4]=X-G,K[5]=1-(C+U),K[6]=D+H,K[7]=0,K[8]=W+E,K[9]=D-H,K[10]=1-(C+O),K[11]=0,K[12]=$[0],K[13]=$[1],K[14]=$[2],K[15]=1,K}function tK(K,Q){var $=new q(3),J=-Q[0],Z=-Q[1],V=-Q[2],B=Q[3],Y=Q[4],F=Q[5],P=Q[6],C=Q[7],X=J*J+Z*Z+V*V+B*B;if(X>0)$[0]=(Y*B+C*J+F*V-P*Z)*2/X,$[1]=(F*B+C*Z+P*J-Y*V)*2/X,$[2]=(P*B+C*V+Y*Z-F*J)*2/X;else $[0]=(Y*B+C*J+F*V-P*Z)*2,$[1]=(F*B+C*Z+P*J-Y*V)*2,$[2]=(P*B+C*V+Y*Z-F*J)*2;return i0(K,Q,$),K}function KQ(K,Q){return K[0]=Q[12],K[1]=Q[13],K[2]=Q[14],K}function d0(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[4],B=Q[5],Y=Q[6],F=Q[8],P=Q[9],C=Q[10];return K[0]=Math.hypot($,J,Z),K[1]=Math.hypot(V,B,Y),K[2]=Math.hypot(F,P,C),K}function QQ(K,Q){var $=new q(3);d0($,Q);var J=1/$[0],Z=1/$[1],V=1/$[2],B=Q[0]*J,Y=Q[1]*Z,F=Q[2]*V,P=Q[4]*J,C=Q[5]*Z,X=Q[6]*V,W=Q[8]*J,O=Q[9]*Z,D=Q[10]*V,U=B+C+D,H=0;if(U>0)H=Math.sqrt(U+1)*2,K[3]=0.25*H,K[0]=(X-O)/H,K[1]=(W-F)/H,K[2]=(Y-P)/H;else if(B>C&&B>D)H=Math.sqrt(1+B-C-D)*2,K[3]=(X-O)/H,K[0]=0.25*H,K[1]=(Y+P)/H,K[2]=(W+F)/H;else if(C>D)H=Math.sqrt(1+C-B-D)*2,K[3]=(W-F)/H,K[0]=(Y+P)/H,K[1]=0.25*H,K[2]=(X+O)/H;else H=Math.sqrt(1+D-B-C)*2,K[3]=(Y-P)/H,K[0]=(W+F)/H,K[1]=(X+O)/H,K[2]=0.25*H;return K}function $Q(K,Q,$,J){var Z=Q[0],V=Q[1],B=Q[2],Y=Q[3],F=Z+Z,P=V+V,C=B+B,X=Z*F,W=Z*P,O=Z*C,D=V*P,U=V*C,H=B*C,E=Y*F,G=Y*P,_=Y*C,R=J[0],A=J[1],M=J[2];return K[0]=(1-(D+H))*R,K[1]=(W+_)*R,K[2]=(O-G)*R,K[3]=0,K[4]=(W-_)*A,K[5]=(1-(X+H))*A,K[6]=(U+E)*A,K[7]=0,K[8]=(O+G)*M,K[9]=(U-E)*M,K[10]=(1-(X+D))*M,K[11]=0,K[12]=$[0],K[13]=$[1],K[14]=$[2],K[15]=1,K}function JQ(K,Q,$,J,Z){var V=Q[0],B=Q[1],Y=Q[2],F=Q[3],P=V+V,C=B+B,X=Y+Y,W=V*P,O=V*C,D=V*X,U=B*C,H=B*X,E=Y*X,G=F*P,_=F*C,R=F*X,A=J[0],M=J[1],w=J[2],h=Z[0],S=Z[1],I=Z[2],p=(1-(U+E))*A,v=(O+R)*A,f=(D-_)*A,k=(O-R)*M,z=(1-(W+E))*M,i=(H+G)*M,d=(D+_)*w,q0=(H-G)*w,L0=(1-(W+U))*w;return K[0]=p,K[1]=v,K[2]=f,K[3]=0,K[4]=k,K[5]=z,K[6]=i,K[7]=0,K[8]=d,K[9]=q0,K[10]=L0,K[11]=0,K[12]=$[0]+h-(p*h+k*S+d*I),K[13]=$[1]+S-(v*h+z*S+q0*I),K[14]=$[2]+I-(f*h+i*S+L0*I),K[15]=1,K}function ZQ(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=$+$,Y=J+J,F=Z+Z,P=$*B,C=J*B,X=J*Y,W=Z*B,O=Z*Y,D=Z*F,U=V*B,H=V*Y,E=V*F;return K[0]=1-X-D,K[1]=C+E,K[2]=W-H,K[3]=0,K[4]=C-E,K[5]=1-P-D,K[6]=O+U,K[7]=0,K[8]=W+H,K[9]=O-U,K[10]=1-P-X,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K}function VQ(K,Q,$,J,Z,V,B){var Y=1/($-Q),F=1/(Z-J),P=1/(V-B);return K[0]=V*2*Y,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=V*2*F,K[6]=0,K[7]=0,K[8]=($+Q)*Y,K[9]=(Z+J)*F,K[10]=(B+V)*P,K[11]=-1,K[12]=0,K[13]=0,K[14]=B*V*2*P,K[15]=0,K}function n0(K,Q,$,J,Z){var V=1/Math.tan(Q/2),B;if(K[0]=V/$,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=V,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[11]=-1,K[12]=0,K[13]=0,K[15]=0,Z!=null&&Z!==Infinity)B=1/(J-Z),K[10]=(Z+J)*B,K[14]=2*Z*J*B;else K[10]=-1,K[14]=-2*J;return K}function BQ(K,Q,$,J,Z){var V=1/Math.tan(Q/2),B;if(K[0]=V/$,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=V,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[11]=-1,K[12]=0,K[13]=0,K[15]=0,Z!=null&&Z!==Infinity)B=1/(J-Z),K[10]=Z*B,K[14]=Z*J*B;else K[10]=-1,K[14]=-J;return K}function FQ(K,Q,$,J){var Z=Math.tan(Q.upDegrees*Math.PI/180),V=Math.tan(Q.downDegrees*Math.PI/180),B=Math.tan(Q.leftDegrees*Math.PI/180),Y=Math.tan(Q.rightDegrees*Math.PI/180),F=2/(B+Y),P=2/(Z+V);return K[0]=F,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=P,K[6]=0,K[7]=0,K[8]=-((B-Y)*F*0.5),K[9]=(Z-V)*P*0.5,K[10]=J/($-J),K[11]=-1,K[12]=0,K[13]=0,K[14]=J*$/($-J),K[15]=0,K}function s0(K,Q,$,J,Z,V,B){var Y=1/(Q-$),F=1/(J-Z),P=1/(V-B);return K[0]=-2*Y,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=-2*F,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=2*P,K[11]=0,K[12]=(Q+$)*Y,K[13]=(Z+J)*F,K[14]=(B+V)*P,K[15]=1,K}function CQ(K,Q,$,J,Z,V,B){var Y=1/(Q-$),F=1/(J-Z),P=1/(V-B);return K[0]=-2*Y,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=-2*F,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=P,K[11]=0,K[12]=(Q+$)*Y,K[13]=(Z+J)*F,K[14]=V*P,K[15]=1,K}function XQ(K,Q,$,J){var Z,V,B,Y,F,P,C,X,W,O,D=Q[0],U=Q[1],H=Q[2],E=J[0],G=J[1],_=J[2],R=$[0],A=$[1],M=$[2];if(Math.abs(D-R)<N&&Math.abs(U-A)<N&&Math.abs(H-M)<N)return c0(K);if(C=D-R,X=U-A,W=H-M,O=1/Math.hypot(C,X,W),C*=O,X*=O,W*=O,Z=G*W-_*X,V=_*C-E*W,B=E*X-G*C,O=Math.hypot(Z,V,B),!O)Z=0,V=0,B=0;else O=1/O,Z*=O,V*=O,B*=O;if(Y=X*B-W*V,F=W*Z-C*B,P=C*V-X*Z,O=Math.hypot(Y,F,P),!O)Y=0,F=0,P=0;else O=1/O,Y*=O,F*=O,P*=O;return K[0]=Z,K[1]=Y,K[2]=C,K[3]=0,K[4]=V,K[5]=F,K[6]=X,K[7]=0,K[8]=B,K[9]=P,K[10]=W,K[11]=0,K[12]=-(Z*D+V*U+B*H),K[13]=-(Y*D+F*U+P*H),K[14]=-(C*D+X*U+W*H),K[15]=1,K}function HQ(K,Q,$,J){var Z=Q[0],V=Q[1],B=Q[2],Y=J[0],F=J[1],P=J[2],C=Z-$[0],X=V-$[1],W=B-$[2],O=C*C+X*X+W*W;if(O>0)O=1/Math.sqrt(O),C*=O,X*=O,W*=O;var D=F*W-P*X,U=P*C-Y*W,H=Y*X-F*C;if(O=D*D+U*U+H*H,O>0)O=1/Math.sqrt(O),D*=O,U*=O,H*=O;return K[0]=D,K[1]=U,K[2]=H,K[3]=0,K[4]=X*H-W*U,K[5]=W*D-C*H,K[6]=C*U-X*D,K[7]=0,K[8]=C,K[9]=X,K[10]=W,K[11]=0,K[12]=Z,K[13]=V,K[14]=B,K[15]=1,K}function OQ(K){return"mat4("+K[0]+", "+K[1]+", "+K[2]+", "+K[3]+", "+K[4]+", "+K[5]+", "+K[6]+", "+K[7]+", "+K[8]+", "+K[9]+", "+K[10]+", "+K[11]+", "+K[12]+", "+K[13]+", "+K[14]+", "+K[15]+")"}function WQ(K){return Math.hypot(K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],K[8],K[9],K[10],K[11],K[12],K[13],K[14],K[15])}function UQ(K,Q,$){return K[0]=Q[0]+$[0],K[1]=Q[1]+$[1],K[2]=Q[2]+$[2],K[3]=Q[3]+$[3],K[4]=Q[4]+$[4],K[5]=Q[5]+$[5],K[6]=Q[6]+$[6],K[7]=Q[7]+$[7],K[8]=Q[8]+$[8],K[9]=Q[9]+$[9],K[10]=Q[10]+$[10],K[11]=Q[11]+$[11],K[12]=Q[12]+$[12],K[13]=Q[13]+$[13],K[14]=Q[14]+$[14],K[15]=Q[15]+$[15],K}function r0(K,Q,$){return K[0]=Q[0]-$[0],K[1]=Q[1]-$[1],K[2]=Q[2]-$[2],K[3]=Q[3]-$[3],K[4]=Q[4]-$[4],K[5]=Q[5]-$[5],K[6]=Q[6]-$[6],K[7]=Q[7]-$[7],K[8]=Q[8]-$[8],K[9]=Q[9]-$[9],K[10]=Q[10]-$[10],K[11]=Q[11]-$[11],K[12]=Q[12]-$[12],K[13]=Q[13]-$[13],K[14]=Q[14]-$[14],K[15]=Q[15]-$[15],K}function DQ(K,Q,$){return K[0]=Q[0]*$,K[1]=Q[1]*$,K[2]=Q[2]*$,K[3]=Q[3]*$,K[4]=Q[4]*$,K[5]=Q[5]*$,K[6]=Q[6]*$,K[7]=Q[7]*$,K[8]=Q[8]*$,K[9]=Q[9]*$,K[10]=Q[10]*$,K[11]=Q[11]*$,K[12]=Q[12]*$,K[13]=Q[13]*$,K[14]=Q[14]*$,K[15]=Q[15]*$,K}function EQ(K,Q,$,J){return K[0]=Q[0]+$[0]*J,K[1]=Q[1]+$[1]*J,K[2]=Q[2]+$[2]*J,K[3]=Q[3]+$[3]*J,K[4]=Q[4]+$[4]*J,K[5]=Q[5]+$[5]*J,K[6]=Q[6]+$[6]*J,K[7]=Q[7]+$[7]*J,K[8]=Q[8]+$[8]*J,K[9]=Q[9]+$[9]*J,K[10]=Q[10]+$[10]*J,K[11]=Q[11]+$[11]*J,K[12]=Q[12]+$[12]*J,K[13]=Q[13]+$[13]*J,K[14]=Q[14]+$[14]*J,K[15]=Q[15]+$[15]*J,K}function jQ(K,Q){return K[0]===Q[0]&&K[1]===Q[1]&&K[2]===Q[2]&&K[3]===Q[3]&&K[4]===Q[4]&&K[5]===Q[5]&&K[6]===Q[6]&&K[7]===Q[7]&&K[8]===Q[8]&&K[9]===Q[9]&&K[10]===Q[10]&&K[11]===Q[11]&&K[12]===Q[12]&&K[13]===Q[13]&&K[14]===Q[14]&&K[15]===Q[15]}function AQ(K,Q){var $=K[0],J=K[1],Z=K[2],V=K[3],B=K[4],Y=K[5],F=K[6],P=K[7],C=K[8],X=K[9],W=K[10],O=K[11],D=K[12],U=K[13],H=K[14],E=K[15],G=Q[0],_=Q[1],R=Q[2],A=Q[3],M=Q[4],w=Q[5],h=Q[6],S=Q[7],I=Q[8],p=Q[9],v=Q[10],f=Q[11],k=Q[12],z=Q[13],i=Q[14],d=Q[15];return Math.abs($-G)<=N*Math.max(1,Math.abs($),Math.abs(G))&&Math.abs(J-_)<=N*Math.max(1,Math.abs(J),Math.abs(_))&&Math.abs(Z-R)<=N*Math.max(1,Math.abs(Z),Math.abs(R))&&Math.abs(V-A)<=N*Math.max(1,Math.abs(V),Math.abs(A))&&Math.abs(B-M)<=N*Math.max(1,Math.abs(B),Math.abs(M))&&Math.abs(Y-w)<=N*Math.max(1,Math.abs(Y),Math.abs(w))&&Math.abs(F-h)<=N*Math.max(1,Math.abs(F),Math.abs(h))&&Math.abs(P-S)<=N*Math.max(1,Math.abs(P),Math.abs(S))&&Math.abs(C-I)<=N*Math.max(1,Math.abs(C),Math.abs(I))&&Math.abs(X-p)<=N*Math.max(1,Math.abs(X),Math.abs(p))&&Math.abs(W-v)<=N*Math.max(1,Math.abs(W),Math.abs(v))&&Math.abs(O-f)<=N*Math.max(1,Math.abs(O),Math.abs(f))&&Math.abs(D-k)<=N*Math.max(1,Math.abs(D),Math.abs(k))&&Math.abs(U-z)<=N*Math.max(1,Math.abs(U),Math.abs(z))&&Math.abs(H-i)<=N*Math.max(1,Math.abs(H),Math.abs(i))&&Math.abs(E-d)<=N*Math.max(1,Math.abs(E),Math.abs(d))}var YQ=n0,PQ=s0,MQ=l0,RQ=r0;var r={};Y0(r,{str:()=>{{return E$}},squaredLength:()=>{{return _K}},sqrLen:()=>{{return T$}},sqlerp:()=>{{return S$}},slerp:()=>{{return V0}},setAxisAngle:()=>{{return WK}},setAxes:()=>{{return I$}},set:()=>{{return R$}},scale:()=>{{return AK}},rotationTo:()=>{{return h$}},rotateZ:()=>{{return C$}},rotateY:()=>{{return P$}},rotateX:()=>{{return F$}},random:()=>{{return O$}},pow:()=>{{return H$}},normalize:()=>{{return N0}},multiply:()=>{{return UK}},mul:()=>{{return N$}},ln:()=>{{return EK}},lerp:()=>{{return G$}},length:()=>{{return RK}},len:()=>{{return k$}},invert:()=>{{return W$}},identity:()=>{{return V$}},getAxisAngle:()=>{{return Y$}},getAngle:()=>{{return B$}},fromValues:()=>{{return A$}},fromMat3:()=>{{return jK}},fromEuler:()=>{{return D$}},exp:()=>{{return DK}},exactEquals:()=>{{return q$}},equals:()=>{{return L$}},dot:()=>{{return MK}},create:()=>{{return _0}},copy:()=>{{return M$}},conjugate:()=>{{return U$}},clone:()=>{{return j$}},calculateW:()=>{{return X$}},add:()=>{{return _$}}});var l={};Y0(l,{zero:()=>{{return sQ}},transformQuat:()=>{{return cQ}},transformMat4:()=>{{return xQ}},transformMat3:()=>{{return mQ}},subtract:()=>{{return e0}},sub:()=>{{return uQ}},str:()=>{{return rQ}},squaredLength:()=>{{return KK}},squaredDistance:()=>{{return t0}},sqrLen:()=>{{return Q$}},sqrDist:()=>{{return K$}},set:()=>{{return GQ}},scaleAndAdd:()=>{{return wQ}},scale:()=>{{return IQ}},round:()=>{{return SQ}},rotateZ:()=>{{return dQ}},rotateY:()=>{{return iQ}},rotateX:()=>{{return lQ}},random:()=>{{return yQ}},normalize:()=>{{return M0}},negate:()=>{{return pQ}},multiply:()=>{{return u0}},mul:()=>{{return oQ}},min:()=>{{return LQ}},max:()=>{{return hQ}},lerp:()=>{{return gQ}},length:()=>{{return b0}},len:()=>{{return R0}},inverse:()=>{{return vQ}},hermite:()=>{{return fQ}},fromValues:()=>{{return J0}},forEach:()=>{{return $$}},floor:()=>{{return qQ}},exactEquals:()=>{{return bQ}},equals:()=>{{return eQ}},dot:()=>{{return Z0}},divide:()=>{{return o0}},div:()=>{{return aQ}},distance:()=>{{return a0}},dist:()=>{{return tQ}},cross:()=>{{return s}},create:()=>{{return $0}},copy:()=>{{return NQ}},clone:()=>{{return _Q}},ceil:()=>{{return TQ}},bezier:()=>{{return zQ}},angle:()=>{{return nQ}},add:()=>{{return kQ}}});function $0(){var K=new q(3);if(q!=Float32Array)K[0]=0,K[1]=0,K[2]=0;return K}function _Q(K){var Q=new q(3);return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q}function b0(K){var Q=K[0],$=K[1],J=K[2];return Math.hypot(Q,$,J)}function J0(K,Q,$){var J=new q(3);return J[0]=K,J[1]=Q,J[2]=$,J}function NQ(K,Q){return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K}function GQ(K,Q,$,J){return K[0]=Q,K[1]=$,K[2]=J,K}function kQ(K,Q,$){return K[0]=Q[0]+$[0],K[1]=Q[1]+$[1],K[2]=Q[2]+$[2],K}function e0(K,Q,$){return K[0]=Q[0]-$[0],K[1]=Q[1]-$[1],K[2]=Q[2]-$[2],K}function u0(K,Q,$){return K[0]=Q[0]*$[0],K[1]=Q[1]*$[1],K[2]=Q[2]*$[2],K}function o0(K,Q,$){return K[0]=Q[0]/$[0],K[1]=Q[1]/$[1],K[2]=Q[2]/$[2],K}function TQ(K,Q){return K[0]=Math.ceil(Q[0]),K[1]=Math.ceil(Q[1]),K[2]=Math.ceil(Q[2]),K}function qQ(K,Q){return K[0]=Math.floor(Q[0]),K[1]=Math.floor(Q[1]),K[2]=Math.floor(Q[2]),K}function LQ(K,Q,$){return K[0]=Math.min(Q[0],$[0]),K[1]=Math.min(Q[1],$[1]),K[2]=Math.min(Q[2],$[2]),K}function hQ(K,Q,$){return K[0]=Math.max(Q[0],$[0]),K[1]=Math.max(Q[1],$[1]),K[2]=Math.max(Q[2],$[2]),K}function SQ(K,Q){return K[0]=Math.round(Q[0]),K[1]=Math.round(Q[1]),K[2]=Math.round(Q[2]),K}function IQ(K,Q,$){return K[0]=Q[0]*$,K[1]=Q[1]*$,K[2]=Q[2]*$,K}function wQ(K,Q,$,J){return K[0]=Q[0]+$[0]*J,K[1]=Q[1]+$[1]*J,K[2]=Q[2]+$[2]*J,K}function a0(K,Q){var $=Q[0]-K[0],J=Q[1]-K[1],Z=Q[2]-K[2];return Math.hypot($,J,Z)}function t0(K,Q){var $=Q[0]-K[0],J=Q[1]-K[1],Z=Q[2]-K[2];return $*$+J*J+Z*Z}function KK(K){var Q=K[0],$=K[1],J=K[2];return Q*Q+$*$+J*J}function pQ(K,Q){return K[0]=-Q[0],K[1]=-Q[1],K[2]=-Q[2],K}function vQ(K,Q){return K[0]=1/Q[0],K[1]=1/Q[1],K[2]=1/Q[2],K}function M0(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=$*$+J*J+Z*Z;if(V>0)V=1/Math.sqrt(V);return K[0]=Q[0]*V,K[1]=Q[1]*V,K[2]=Q[2]*V,K}function Z0(K,Q){return K[0]*Q[0]+K[1]*Q[1]+K[2]*Q[2]}function s(K,Q,$){var J=Q[0],Z=Q[1],V=Q[2],B=$[0],Y=$[1],F=$[2];return K[0]=Z*F-V*Y,K[1]=V*B-J*F,K[2]=J*Y-Z*B,K}function gQ(K,Q,$,J){var Z=Q[0],V=Q[1],B=Q[2];return K[0]=Z+J*($[0]-Z),K[1]=V+J*($[1]-V),K[2]=B+J*($[2]-B),K}function fQ(K,Q,$,J,Z,V){var B=V*V,Y=B*(2*V-3)+1,F=B*(V-2)+V,P=B*(V-1),C=B*(3-2*V);return K[0]=Q[0]*Y+$[0]*F+J[0]*P+Z[0]*C,K[1]=Q[1]*Y+$[1]*F+J[1]*P+Z[1]*C,K[2]=Q[2]*Y+$[2]*F+J[2]*P+Z[2]*C,K}function zQ(K,Q,$,J,Z,V){var B=1-V,Y=B*B,F=V*V,P=Y*B,C=3*V*Y,X=3*F*B,W=F*V;return K[0]=Q[0]*P+$[0]*C+J[0]*X+Z[0]*W,K[1]=Q[1]*P+$[1]*C+J[1]*X+Z[1]*W,K[2]=Q[2]*P+$[2]*C+J[2]*X+Z[2]*W,K}function yQ(K,Q){Q=Q||1;var $=m()*2*Math.PI,J=m()*2-1,Z=Math.sqrt(1-J*J)*Q;return K[0]=Math.cos($)*Z,K[1]=Math.sin($)*Z,K[2]=J*Q,K}function xQ(K,Q,$){var J=Q[0],Z=Q[1],V=Q[2],B=$[3]*J+$[7]*Z+$[11]*V+$[15];return B=B||1,K[0]=($[0]*J+$[4]*Z+$[8]*V+$[12])/B,K[1]=($[1]*J+$[5]*Z+$[9]*V+$[13])/B,K[2]=($[2]*J+$[6]*Z+$[10]*V+$[14])/B,K}function mQ(K,Q,$){var J=Q[0],Z=Q[1],V=Q[2];return K[0]=J*$[0]+Z*$[3]+V*$[6],K[1]=J*$[1]+Z*$[4]+V*$[7],K[2]=J*$[2]+Z*$[5]+V*$[8],K}function cQ(K,Q,$){var J=$[0],Z=$[1],V=$[2],B=$[3],Y=Q[0],F=Q[1],P=Q[2],C=Z*P-V*F,X=V*Y-J*P,W=J*F-Z*Y,O=Z*W-V*X,D=V*C-J*W,U=J*X-Z*C,H=B*2;return C*=H,X*=H,W*=H,O*=2,D*=2,U*=2,K[0]=Y+C+O,K[1]=F+X+D,K[2]=P+W+U,K}function lQ(K,Q,$,J){var Z=[],V=[];return Z[0]=Q[0]-$[0],Z[1]=Q[1]-$[1],Z[2]=Q[2]-$[2],V[0]=Z[0],V[1]=Z[1]*Math.cos(J)-Z[2]*Math.sin(J),V[2]=Z[1]*Math.sin(J)+Z[2]*Math.cos(J),K[0]=V[0]+$[0],K[1]=V[1]+$[1],K[2]=V[2]+$[2],K}function iQ(K,Q,$,J){var Z=[],V=[];return Z[0]=Q[0]-$[0],Z[1]=Q[1]-$[1],Z[2]=Q[2]-$[2],V[0]=Z[2]*Math.sin(J)+Z[0]*Math.cos(J),V[1]=Z[1],V[2]=Z[2]*Math.cos(J)-Z[0]*Math.sin(J),K[0]=V[0]+$[0],K[1]=V[1]+$[1],K[2]=V[2]+$[2],K}function dQ(K,Q,$,J){var Z=[],V=[];return Z[0]=Q[0]-$[0],Z[1]=Q[1]-$[1],Z[2]=Q[2]-$[2],V[0]=Z[0]*Math.cos(J)-Z[1]*Math.sin(J),V[1]=Z[0]*Math.sin(J)+Z[1]*Math.cos(J),V[2]=Z[2],K[0]=V[0]+$[0],K[1]=V[1]+$[1],K[2]=V[2]+$[2],K}function nQ(K,Q){var $=K[0],J=K[1],Z=K[2],V=Q[0],B=Q[1],Y=Q[2],F=Math.sqrt($*$+J*J+Z*Z),P=Math.sqrt(V*V+B*B+Y*Y),C=F*P,X=C&&Z0(K,Q)/C;return Math.acos(Math.min(Math.max(X,-1),1))}function sQ(K){return K[0]=0,K[1]=0,K[2]=0,K}function rQ(K){return"vec3("+K[0]+", "+K[1]+", "+K[2]+")"}function bQ(K,Q){return K[0]===Q[0]&&K[1]===Q[1]&&K[2]===Q[2]}function eQ(K,Q){var $=K[0],J=K[1],Z=K[2],V=Q[0],B=Q[1],Y=Q[2];return Math.abs($-V)<=N*Math.max(1,Math.abs($),Math.abs(V))&&Math.abs(J-B)<=N*Math.max(1,Math.abs(J),Math.abs(B))&&Math.abs(Z-Y)<=N*Math.max(1,Math.abs(Z),Math.abs(Y))}var uQ=e0,oQ=u0,aQ=o0,tQ=a0,K$=t0,R0=b0,Q$=KK,$$=function(){var K=$0();return function(Q,$,J,Z,V,B){var Y,F;if(!$)$=3;if(!J)J=0;if(Z)F=Math.min(Z*$+J,Q.length);else F=Q.length;for(Y=J;Y<F;Y+=$)K[0]=Q[Y],K[1]=Q[Y+1],K[2]=Q[Y+2],V(K,K,B),Q[Y]=K[0],Q[Y+1]=K[1],Q[Y+2]=K[2];return Q}}();function J$(){var K=new q(4);if(q!=Float32Array)K[0]=0,K[1]=0,K[2]=0,K[3]=0;return K}function QK(K){var Q=new q(4);return Q[0]=K[0],Q[1]=K[1],Q[2]=K[2],Q[3]=K[3],Q}function $K(K,Q,$,J){var Z=new q(4);return Z[0]=K,Z[1]=Q,Z[2]=$,Z[3]=J,Z}function JK(K,Q){return K[0]=Q[0],K[1]=Q[1],K[2]=Q[2],K[3]=Q[3],K}function ZK(K,Q,$,J,Z){return K[0]=Q,K[1]=$,K[2]=J,K[3]=Z,K}function VK(K,Q,$){return K[0]=Q[0]+$[0],K[1]=Q[1]+$[1],K[2]=Q[2]+$[2],K[3]=Q[3]+$[3],K}function YK(K,Q,$){return K[0]=Q[0]*$,K[1]=Q[1]*$,K[2]=Q[2]*$,K[3]=Q[3]*$,K}function BK(K){var Q=K[0],$=K[1],J=K[2],Z=K[3];return Math.hypot(Q,$,J,Z)}function FK(K){var Q=K[0],$=K[1],J=K[2],Z=K[3];return Q*Q+$*$+J*J+Z*Z}function PK(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=$*$+J*J+Z*Z+V*V;if(B>0)B=1/Math.sqrt(B);return K[0]=$*B,K[1]=J*B,K[2]=Z*B,K[3]=V*B,K}function CK(K,Q){return K[0]*Q[0]+K[1]*Q[1]+K[2]*Q[2]+K[3]*Q[3]}function XK(K,Q,$,J){var Z=Q[0],V=Q[1],B=Q[2],Y=Q[3];return K[0]=Z+J*($[0]-Z),K[1]=V+J*($[1]-V),K[2]=B+J*($[2]-B),K[3]=Y+J*($[3]-Y),K}function HK(K,Q){return K[0]===Q[0]&&K[1]===Q[1]&&K[2]===Q[2]&&K[3]===Q[3]}function OK(K,Q){var $=K[0],J=K[1],Z=K[2],V=K[3],B=Q[0],Y=Q[1],F=Q[2],P=Q[3];return Math.abs($-B)<=N*Math.max(1,Math.abs($),Math.abs(B))&&Math.abs(J-Y)<=N*Math.max(1,Math.abs(J),Math.abs(Y))&&Math.abs(Z-F)<=N*Math.max(1,Math.abs(Z),Math.abs(F))&&Math.abs(V-P)<=N*Math.max(1,Math.abs(V),Math.abs(P))}var MJ=function(){var K=J$();return function(Q,$,J,Z,V,B){var Y,F;if(!$)$=4;if(!J)J=0;if(Z)F=Math.min(Z*$+J,Q.length);else F=Q.length;for(Y=J;Y<F;Y+=$)K[0]=Q[Y],K[1]=Q[Y+1],K[2]=Q[Y+2],K[3]=Q[Y+3],V(K,K,B),Q[Y]=K[0],Q[Y+1]=K[1],Q[Y+2]=K[2],Q[Y+3]=K[3];return Q}}();function _0(){var K=new q(4);if(q!=Float32Array)K[0]=0,K[1]=0,K[2]=0;return K[3]=1,K}function V$(K){return K[0]=0,K[1]=0,K[2]=0,K[3]=1,K}function WK(K,Q,$){$=$*0.5;var J=Math.sin($);return K[0]=J*Q[0],K[1]=J*Q[1],K[2]=J*Q[2],K[3]=Math.cos($),K}function Y$(K,Q){var $=Math.acos(Q[3])*2,J=Math.sin($/2);if(J>N)K[0]=Q[0]/J,K[1]=Q[1]/J,K[2]=Q[2]/J;else K[0]=1,K[1]=0,K[2]=0;return $}function B$(K,Q){var $=MK(K,Q);return Math.acos(2*$*$-1)}function UK(K,Q,$){var J=Q[0],Z=Q[1],V=Q[2],B=Q[3],Y=$[0],F=$[1],P=$[2],C=$[3];return K[0]=J*C+B*Y+Z*P-V*F,K[1]=Z*C+B*F+V*Y-J*P,K[2]=V*C+B*P+J*F-Z*Y,K[3]=B*C-J*Y-Z*F-V*P,K}function F$(K,Q,$){$*=0.5;var J=Q[0],Z=Q[1],V=Q[2],B=Q[3],Y=Math.sin($),F=Math.cos($);return K[0]=J*F+B*Y,K[1]=Z*F+V*Y,K[2]=V*F-Z*Y,K[3]=B*F-J*Y,K}function P$(K,Q,$){$*=0.5;var J=Q[0],Z=Q[1],V=Q[2],B=Q[3],Y=Math.sin($),F=Math.cos($);return K[0]=J*F-V*Y,K[1]=Z*F+B*Y,K[2]=V*F+J*Y,K[3]=B*F-Z*Y,K}function C$(K,Q,$){$*=0.5;var J=Q[0],Z=Q[1],V=Q[2],B=Q[3],Y=Math.sin($),F=Math.cos($);return K[0]=J*F+Z*Y,K[1]=Z*F-J*Y,K[2]=V*F+B*Y,K[3]=B*F-V*Y,K}function X$(K,Q){var $=Q[0],J=Q[1],Z=Q[2];return K[0]=$,K[1]=J,K[2]=Z,K[3]=Math.sqrt(Math.abs(1-$*$-J*J-Z*Z)),K}function DK(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=Math.sqrt($*$+J*J+Z*Z),Y=Math.exp(V),F=B>0?Y*Math.sin(B)/B:0;return K[0]=$*F,K[1]=J*F,K[2]=Z*F,K[3]=Y*Math.cos(B),K}function EK(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=Math.sqrt($*$+J*J+Z*Z),Y=B>0?Math.atan2(B,V)/B:0;return K[0]=$*Y,K[1]=J*Y,K[2]=Z*Y,K[3]=0.5*Math.log($*$+J*J+Z*Z+V*V),K}function H$(K,Q,$){return EK(K,Q),AK(K,K,$),DK(K,K),K}function V0(K,Q,$,J){var Z=Q[0],V=Q[1],B=Q[2],Y=Q[3],F=$[0],P=$[1],C=$[2],X=$[3],W,O,D,U,H;if(O=Z*F+V*P+B*C+Y*X,O<0)O=-O,F=-F,P=-P,C=-C,X=-X;if(1-O>N)W=Math.acos(O),D=Math.sin(W),U=Math.sin((1-J)*W)/D,H=Math.sin(J*W)/D;else U=1-J,H=J;return K[0]=U*Z+H*F,K[1]=U*V+H*P,K[2]=U*B+H*C,K[3]=U*Y+H*X,K}function O$(K){var Q=m(),$=m(),J=m(),Z=Math.sqrt(1-Q),V=Math.sqrt(Q);return K[0]=Z*Math.sin(2*Math.PI*$),K[1]=Z*Math.cos(2*Math.PI*$),K[2]=V*Math.sin(2*Math.PI*J),K[3]=V*Math.cos(2*Math.PI*J),K}function W$(K,Q){var $=Q[0],J=Q[1],Z=Q[2],V=Q[3],B=$*$+J*J+Z*Z+V*V,Y=B?1/B:0;return K[0]=-$*Y,K[1]=-J*Y,K[2]=-Z*Y,K[3]=V*Y,K}function U$(K,Q){return K[0]=-Q[0],K[1]=-Q[1],K[2]=-Q[2],K[3]=Q[3],K}function jK(K,Q){var $=Q[0]+Q[4]+Q[8],J;if($>0)J=Math.sqrt($+1),K[3]=0.5*J,J=0.5/J,K[0]=(Q[5]-Q[7])*J,K[1]=(Q[6]-Q[2])*J,K[2]=(Q[1]-Q[3])*J;else{var Z=0;if(Q[4]>Q[0])Z=1;if(Q[8]>Q[Z*3+Z])Z=2;var V=(Z+1)%3,B=(Z+2)%3;J=Math.sqrt(Q[Z*3+Z]-Q[V*3+V]-Q[B*3+B]+1),K[Z]=0.5*J,J=0.5/J,K[3]=(Q[V*3+B]-Q[B*3+V])*J,K[V]=(Q[V*3+Z]+Q[Z*3+V])*J,K[B]=(Q[B*3+Z]+Q[Z*3+B])*J}return K}function D$(K,Q,$,J){var Z=0.5*Math.PI/180;Q*=Z,$*=Z,J*=Z;var V=Math.sin(Q),B=Math.cos(Q),Y=Math.sin($),F=Math.cos($),P=Math.sin(J),C=Math.cos(J);return K[0]=V*F*C-B*Y*P,K[1]=B*Y*C+V*F*P,K[2]=B*F*P-V*Y*C,K[3]=B*F*C+V*Y*P,K}function E$(K){return"quat("+K[0]+", "+K[1]+", "+K[2]+", "+K[3]+")"}var j$=QK,A$=$K,M$=JK,R$=ZK,_$=VK,N$=UK,AK=YK,MK=CK,G$=XK,RK=BK,k$=RK,_K=FK,T$=_K,N0=PK,q$=HK,L$=OK,h$=function(){var K=$0(),Q=J0(1,0,0),$=J0(0,1,0);return function(J,Z,V){var B=Z0(Z,V);if(B<-0.999999){if(s(K,Q,Z),R0(K)<0.000001)s(K,$,Z);return M0(K,K),WK(J,K,Math.PI),J}else if(B>0.999999)return J[0]=0,J[1]=0,J[2]=0,J[3]=1,J;else return s(K,Z,V),J[0]=K[0],J[1]=K[1],J[2]=K[2],J[3]=1+B,N0(J,J)}}(),S$=function(){var K=_0(),Q=_0();return function($,J,Z,V,B,Y){return V0(K,J,B,Y),V0(Q,Z,V,Y),V0($,K,Q,2*Y*(1-Y)),$}}(),I$=function(){var K=m0();return function(Q,$,J,Z){return K[0]=J[0],K[3]=J[1],K[6]=J[2],K[1]=Z[0],K[4]=Z[1],K[7]=Z[2],K[2]=-$[0],K[5]=-$[1],K[8]=-$[2],N0(Q,jK(Q,K))}}();var w$=Math.PI/90;class G0{matrix;constructor(){this.matrix=T.create()}static create(){return new G0}copy(K){return T.copy(this.matrix,K),this}invert(){return T.invert(this.matrix,this.matrix),this}multiply(K){return T.multiply(this.matrix,this.matrix,K),this}translate(K,Q,$){return T.translate(this.matrix,this.matrix,[K,Q,$]),this}rotateX(K){return T.rotateX(this.matrix,this.matrix,K),this}rotateY(K){return T.rotateY(this.matrix,this.matrix,K),this}rotateZ(K){return T.rotateZ(this.matrix,this.matrix,K),this}scale(K,Q,$){return T.scale(this.matrix,this.matrix,[K,Q,$]),this}perspective(K,Q,$,J){return T.perspective(this.matrix,K*w$,Q,$,J),this}ortho(K,Q,$,J,Z,V){return T.ortho(this.matrix,K,Q,$,J,Z,V),this}static aTemp=T.create();static bTemp=T.create();static combineMat4(K,Q,$,J=0.5){T.multiplyScalar(this.aTemp,Q,1-J),T.multiplyScalar(this.bTemp,$,J),T.add(K,this.aTemp,this.bTemp)}static tempQuat=r.create();static moveMatrix(K,Q,$,J,Z=null){const V=l.fromValues(-Q,$,J);if(Z)T.getRotation(this.tempQuat,Z),r.invert(this.tempQuat,this.tempQuat),l.transformQuat(V,V,this.tempQuat);T.translate(K,K,V)}getMatrix(){return this.matrix}}var L=G0;class k0{gl;uniforms;cameraMatrix=L.create().translate(0,0,-1).getMatrix();perspectiveMatrix=L.create().getMatrix();orthoMatrix=L.create().getMatrix();projectionMatrix=L.create().getMatrix();perspectiveLevel=1;constructor(K,Q){this.gl=K,this.uniforms=Q}configPerspectiveMatrix(K){this.perspectiveMatrix=L.create().perspective(45,K,0.01,1000).getMatrix(),this.updatePerspective()}configOrthoMatrix(K){this.orthoMatrix=L.create().ortho(-K,K,-1,1,-1000,1000).getMatrix(),this.updatePerspective()}camTiltMatrix=L.create().getMatrix();camTurnMatrix=L.create().getMatrix();camMatrix=T.create();refresh(){T.mul(this.camMatrix,this.camTiltMatrix,this.camTurnMatrix),T.mul(this.camMatrix,this.camMatrix,this.cameraMatrix);const K=this.uniforms.getUniformLocation(w0);this.gl.uniformMatrix4fv(K,!1,this.camMatrix)}orthoTemp=T.create();perspectiveTemp=T.create();updatePerspective(K){if(K!==void 0)this.perspectiveLevel=K;L.combineMat4(this.projectionMatrix,this.orthoMatrix,this.perspectiveMatrix,this.perspectiveLevel);const Q=this.uniforms.getUniformLocation(p0);this.gl.uniformMatrix4fv(Q,!1,this.projectionMatrix),this.refresh()}moveCam(K,Q,$){L.moveMatrix(this.cameraMatrix,K,Q,$,this.camTurnMatrix),this.refresh()}turnCam(K){T.rotateY(this.camTurnMatrix,this.camTurnMatrix,K),this.refresh()}tilt(K){T.rotateX(this.camTiltMatrix,this.camTiltMatrix,K),this.refresh()}}var g$=function(K){if(!v$)return K;return new Proxy(K,{get($,J){const Z=$,V=Z[J];if(typeof V==="function")return(...Y)=>{const F=V.apply(Z,Y);return console.log(`gl.${String(J)}(`,Y,") = ",F),F};else return console.log(`gl.${String(J)} = `,V),V}})},p$={alpha:!0,antialias:!1,depth:!0,desynchronized:!0,failIfMajorPerformanceCaveat:void 0,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},v$=!1;class T0 extends g{gl;programs;attributeBuffers;uniforms;canvas;textureManager;imageManager;camera;constructor(K,Q){super();this.gl=g$(K.getContext("webgl2",{...p$,...Q})),this.canvas=K,this.programs=this.own(new P0(this.gl)),this.uniforms=this.own(new H0(this.gl,this.programs)),this.attributeBuffers=this.own(new X0(this.gl,this.programs)),this.textureManager=new E0(this.gl,this.uniforms),this.imageManager=new j0,this.camera=new k0(this.gl,this.uniforms),window.addEventListener("resize",this.checkCanvasSize.bind(this))}checkCanvasSize(){this.canvas.width=this.canvas.offsetWidth*2,this.canvas.height=this.canvas.offsetHeight*2,this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const K=this.gl.drawingBufferWidth/this.gl.drawingBufferHeight;this.camera.configOrthoMatrix(K),this.camera.configPerspectiveMatrix(K)}async initialize(){const Q={AUTHOR:"Jack le hamster"};this.programs.addProgram("main",A0(y0,Q),A0(x0,Q)),this.programs.useProgram("main"),this.gl.enable(j.DEPTH_TEST),this.gl.depthFunc(j.LESS),this.gl.clearDepth(1),this.gl.enable(j.BLEND),this.gl.blendFunc(j.SRC_ALPHA,j.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);{const $=S0;this.attributeBuffers.createBuffer($);const J=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(j.ELEMENT_ARRAY_BUFFER,J),this.attributeBuffers.bufferData(j.ELEMENT_ARRAY_BUFFER,$,Uint16Array.from([0,1,2,2,3,0]),0,j.STATIC_DRAW)}{const $=h0;this.attributeBuffers.createBuffer($);const J=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(j.ARRAY_BUFFER,J),this.gl.vertexAttribPointer(J.location,4,j.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(J.location),this.attributeBuffers.bufferData(j.ARRAY_BUFFER,$,Float32Array.from([-1,-1,0,1,1,-1,1,1,1,1,1,0,-1,1,0,0]),0,j.STATIC_DRAW)}{const $=B0;this.attributeBuffers.createBuffer($);const J=this.attributeBuffers.getAttributeBuffer($);this.attributeBuffers.bindBuffer(j.ARRAY_BUFFER,J);for(let Z=0;Z<4;Z++){const V=J.location+Z;this.gl.vertexAttribPointer(V,4,j.FLOAT,!1,16*Float32Array.BYTES_PER_ELEMENT,Z*4*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(V),this.gl.vertexAttribDivisor(V,1)}this.attributeBuffers.bufferData(j.ARRAY_BUFFER,$,Float32Array.from([...L.create().translate(0,0,0).getMatrix(),...L.create().translate(-1,0,1).rotateY(Math.PI/2).scale(1,1,1).getMatrix(),...L.create().translate(1,0,1).rotateY(-Math.PI/2).scale(1,1,1).getMatrix(),...L.create().translate(0,-1,1).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...L.create().translate(0,-1,3).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...L.create().translate(-2,-1,3).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...L.create().translate(2,-1,3).rotateX(-Math.PI/2).scale(1,1,1).getMatrix(),...L.create().getMatrix()]),0,j.DYNAMIC_DRAW),this.textureManager.initialize()}await this.loadLogoTexture(),this.checkCanvasSize(),this.camera.refresh()}syncHud(){this.attributeBuffers.bindBuffer(j.ARRAY_BUFFER,this.attributeBuffers.getAttributeBuffer(B0));const K=[-this.camera.cameraMatrix[12],-this.camera.cameraMatrix[13],-this.camera.cameraMatrix[14]],Q=L.create().copy(this.camera.camTurnMatrix).invert().getMatrix(),$=L.create().copy(this.camera.camTiltMatrix).invert().getMatrix();this.attributeBuffers.bufferSubData(j.ARRAY_BUFFER,Float32Array.from([...L.create().translate(K[0],K[1],K[2]).multiply(Q).multiply($).translate(0,0,-0.9).getMatrix()]),16*Float32Array.BYTES_PER_ELEMENT*7)}async loadLogoTexture(){await this.imageManager.drawImage("logo",(Y)=>{const{canvas:F}=Y;F.width=512,F.height=512;const P=F.width/2,C=F.height/2,X=F.width/2;Y.imageSmoothingEnabled=!0,Y.fillStyle="#ddd",Y.lineWidth=F.width/50,Y.fillRect(0,0,F.width,F.height),Y.strokeStyle="black",Y.fillStyle="gold",Y.beginPath(),Y.arc(P,C,X*0.8,0,2*Math.PI),Y.fill(),Y.stroke(),Y.beginPath(),Y.arc(P,C,X*0.5,0,Math.PI),Y.stroke(),Y.beginPath(),Y.arc(F.width/3,F.height/3,X*0.1,0,Math.PI,!0),Y.stroke(),Y.beginPath(),Y.arc(F.width/3*2,F.height/3,X*0.1,0,Math.PI*2,!0),Y.stroke()}),await this.imageManager.drawImage("ground",(Y)=>{const{canvas:F}=Y;F.width=512,F.height=512,Y.imageSmoothingEnabled=!0,Y.fillStyle="#ddd",Y.lineWidth=F.width/50,Y.fillRect(0,0,F.width,F.height),Y.strokeStyle="black",Y.fillStyle="silver",Y.beginPath(),Y.rect(F.width*0.2,F.height*0.2,F.width*0.6,F.height*0.6),Y.fill(),Y.stroke()}),await this.imageManager.drawImage("hud",(Y)=>{const{canvas:F}=Y;F.width=512,F.height=512,Y.imageSmoothingEnabled=!0,Y.fillStyle="#ddd",Y.lineWidth=F.width/50,Y.strokeStyle="black",Y.fillStyle="silver",Y.beginPath(),Y.rect(30,30,F.width-60,F.height-60),Y.stroke()});const Q=this.imageManager.getMedia("logo"),{slot:$}=this.textureManager.allocateSlotForImage(Q),J=this.imageManager.getMedia("ground"),{slot:Z}=this.textureManager.allocateSlotForImage(J),V=this.imageManager.getMedia("hud"),{slot:B}=this.textureManager.allocateSlotForImage(V);this.textureManager.generateMipMaps();{const Y=I0;this.attributeBuffers.createBuffer(Y);const F=this.attributeBuffers.getAttributeBuffer(Y);this.attributeBuffers.bindBuffer(j.ARRAY_BUFFER,F);const P=F.location;this.gl.vertexAttribPointer(P,3,j.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),this.gl.enableVertexAttribArray(P),this.gl.vertexAttribDivisor(P,1),this.attributeBuffers.bufferData(j.ARRAY_BUFFER,Y,Float32Array.from([...$.size,$.slotNumber,...$.size,$.slotNumber,...$.size,$.slotNumber,...Z.size,Z.slotNumber,...Z.size,Z.slotNumber,...Z.size,Z.slotNumber,...Z.size,Z.slotNumber,...B.size,B.slotNumber]),0,j.DYNAMIC_DRAW)}}drawElementsInstanced(K,Q){this.gl.drawElementsInstanced(j.TRIANGLES,K,j.UNSIGNED_SHORT,0,Q)}refresh(){this.gl.clear(j.COLOR_BUFFER_BIT|j.DEPTH_BUFFER_BIT);const K=6,Q=8;this.syncHud(),this.drawElementsInstanced(K,Q)}bindVertexArray(){return this.own(new C0(this.gl))}}async function dJ(){console.log("Hello World!")}function nJ(K){K.style.border="2px solid silver",K.style.cursor="grab",K.addEventListener("mouseenter",()=>{K.style.borderColor="black"}),K.addEventListener("mouseleave",()=>{K.style.borderColor="silver"});const Q=new T0(K);Q.initialize();const $={};document.addEventListener("keydown",(Z)=>{$[Z.code]=!0}),document.addEventListener("keyup",(Z)=>{$[Z.code]=!1});function J(){Q.gl.enable(Q.gl.DEPTH_TEST);const Z=0.25,V=0.05;if($.KeyW)Q.camera.moveCam(0,0,Z);if($.KeyS)Q.camera.moveCam(0,0,-Z);if($.ArrowUp&&!$.ShiftRight)Q.camera.moveCam(0,-Z,0);if($.ArrowDown&&!$.ShiftRight)Q.camera.moveCam(0,Z,0);if($.KeyA||$.ArrowLeft&&!$.ShiftRight)Q.camera.moveCam(-Z,0,0);if($.KeyD||$.ArrowRight&&!$.ShiftRight)Q.camera.moveCam(Z,0,0);if($.KeyQ||$.ArrowLeft&&$.ShiftRight)Q.camera.turnCam(-V);if($.KeyE||$.ArrowRight&&$.ShiftRight)Q.camera.turnCam(V);if($.ArrowUp&&$.ShiftRight)Q.camera.tilt(-V);if($.ArrowDown&&$.ShiftRight)Q.camera.tilt(V);Q.refresh(),requestAnimationFrame(J)}return Q.refresh(),J(),Q}export{nJ as testCanvas,dJ as hello};

//# debugId=77B024C536C1977B64756e2164756e21
